{"version":3,"sources":["../../../node_modules/tslib/tslib.es6.mjs","../../../node_modules/localforage/dist/localforage.js","../../../node_modules/data-transport/src/constant.ts","../../../node_modules/data-transport/node_modules/tslib/tslib.es6.js","../../../node_modules/data-transport/node_modules/uuid/dist/esm-browser/rng.js","../../../node_modules/data-transport/node_modules/uuid/dist/esm-browser/stringify.js","../../../node_modules/data-transport/node_modules/uuid/dist/esm-browser/native.js","../../../node_modules/data-transport/node_modules/uuid/dist/esm-browser/v4.js","../../../node_modules/data-transport/src/utils.ts","../../../node_modules/data-transport/src/transport.ts","../../../node_modules/data-transport/src/transports/iframeTransport.ts","../../../node_modules/data-transport/src/transports/workerTransport.ts","../../../node_modules/data-transport/src/transports/sharedWorkerTransport.ts","../../../node_modules/data-transport/src/transports/serviceWorkerTransport.ts","../../../node_modules/data-transport/src/transports/broadcastTransport.ts","../../../node_modules/data-transport/src/transports/electronTransport.ts","../../../node_modules/data-transport/src/global.ts","../../../node_modules/data-transport/src/transports/browserExtensionsTransport.ts","../../../node_modules/data-transport/src/transports/webRTCTransport.ts","../../../node_modules/data-transport/src/transports/messageTransport.ts","../../../node_modules/data-transport/src/transports/processTransport.ts","../../../node_modules/data-transport/src/createTransport.ts","../../../node_modules/data-transport/src/decorators/listen.ts","../../../node_modules/data-transport/src/merge.ts","../../../node_modules/data-transport/src/mockPorts.ts","../../../node_modules/data-transport/dist/index.js","../../core/src/originStorageClient.ts","../../../node_modules/broadcast-channel/dist/lib/util.js","../../../node_modules/@babel/runtime/helpers/typeof.js","../../../node_modules/broadcast-channel/dist/lib/methods/native.js","../../../node_modules/oblivious-set/src/index.ts","../../../node_modules/broadcast-channel/dist/lib/options.js","../../../node_modules/broadcast-channel/dist/lib/methods/indexed-db.js","../../../node_modules/broadcast-channel/dist/lib/methods/localstorage.js","../../../node_modules/broadcast-channel/dist/lib/methods/simulate.js","../../../node_modules/broadcast-channel/dist/lib/method-chooser.js","../../../node_modules/broadcast-channel/dist/lib/broadcast-channel.js","../../../node_modules/unload/dist/es/browser.js","../../../node_modules/unload/dist/es/node.js","../../../node_modules/unload/dist/es/index.js","../../../node_modules/broadcast-channel/dist/lib/leader-election-util.js","../../../node_modules/broadcast-channel/dist/lib/leader-election-web-lock.js","../../../node_modules/broadcast-channel/dist/lib/leader-election.js","../../../node_modules/broadcast-channel/dist/lib/index.js","../../../node_modules/broadcast-channel/dist/lib/index.es5.js","../../core/src/constant.ts","../../core/src/originStorage.ts","../../core/dist/src/interface.js","../../core/index.ts","../src/client.ts","../src/index.ts"],"sourcesContent":["/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n","/*!\n    localForage -- Offline Storage, Improved\n    Version 1.10.0\n    https://localforage.github.io/localForage\n    (c) 2013-2017 Mozilla, Apache License 2.0\n*/\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.localforage = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw (f.code=\"MODULE_NOT_FOUND\", f)}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (global){\n'use strict';\nvar Mutation = global.MutationObserver || global.WebKitMutationObserver;\n\nvar scheduleDrain;\n\n{\n  if (Mutation) {\n    var called = 0;\n    var observer = new Mutation(nextTick);\n    var element = global.document.createTextNode('');\n    observer.observe(element, {\n      characterData: true\n    });\n    scheduleDrain = function () {\n      element.data = (called = ++called % 2);\n    };\n  } else if (!global.setImmediate && typeof global.MessageChannel !== 'undefined') {\n    var channel = new global.MessageChannel();\n    channel.port1.onmessage = nextTick;\n    scheduleDrain = function () {\n      channel.port2.postMessage(0);\n    };\n  } else if ('document' in global && 'onreadystatechange' in global.document.createElement('script')) {\n    scheduleDrain = function () {\n\n      // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n      // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n      var scriptEl = global.document.createElement('script');\n      scriptEl.onreadystatechange = function () {\n        nextTick();\n\n        scriptEl.onreadystatechange = null;\n        scriptEl.parentNode.removeChild(scriptEl);\n        scriptEl = null;\n      };\n      global.document.documentElement.appendChild(scriptEl);\n    };\n  } else {\n    scheduleDrain = function () {\n      setTimeout(nextTick, 0);\n    };\n  }\n}\n\nvar draining;\nvar queue = [];\n//named nextTick for less confusing stack traces\nfunction nextTick() {\n  draining = true;\n  var i, oldQueue;\n  var len = queue.length;\n  while (len) {\n    oldQueue = queue;\n    queue = [];\n    i = -1;\n    while (++i < len) {\n      oldQueue[i]();\n    }\n    len = queue.length;\n  }\n  draining = false;\n}\n\nmodule.exports = immediate;\nfunction immediate(task) {\n  if (queue.push(task) === 1 && !draining) {\n    scheduleDrain();\n  }\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],2:[function(_dereq_,module,exports){\n'use strict';\nvar immediate = _dereq_(1);\n\n/* istanbul ignore next */\nfunction INTERNAL() {}\n\nvar handlers = {};\n\nvar REJECTED = ['REJECTED'];\nvar FULFILLED = ['FULFILLED'];\nvar PENDING = ['PENDING'];\n\nmodule.exports = Promise;\n\nfunction Promise(resolver) {\n  if (typeof resolver !== 'function') {\n    throw new TypeError('resolver must be a function');\n  }\n  this.state = PENDING;\n  this.queue = [];\n  this.outcome = void 0;\n  if (resolver !== INTERNAL) {\n    safelyResolveThenable(this, resolver);\n  }\n}\n\nPromise.prototype[\"catch\"] = function (onRejected) {\n  return this.then(null, onRejected);\n};\nPromise.prototype.then = function (onFulfilled, onRejected) {\n  if (typeof onFulfilled !== 'function' && this.state === FULFILLED ||\n    typeof onRejected !== 'function' && this.state === REJECTED) {\n    return this;\n  }\n  var promise = new this.constructor(INTERNAL);\n  if (this.state !== PENDING) {\n    var resolver = this.state === FULFILLED ? onFulfilled : onRejected;\n    unwrap(promise, resolver, this.outcome);\n  } else {\n    this.queue.push(new QueueItem(promise, onFulfilled, onRejected));\n  }\n\n  return promise;\n};\nfunction QueueItem(promise, onFulfilled, onRejected) {\n  this.promise = promise;\n  if (typeof onFulfilled === 'function') {\n    this.onFulfilled = onFulfilled;\n    this.callFulfilled = this.otherCallFulfilled;\n  }\n  if (typeof onRejected === 'function') {\n    this.onRejected = onRejected;\n    this.callRejected = this.otherCallRejected;\n  }\n}\nQueueItem.prototype.callFulfilled = function (value) {\n  handlers.resolve(this.promise, value);\n};\nQueueItem.prototype.otherCallFulfilled = function (value) {\n  unwrap(this.promise, this.onFulfilled, value);\n};\nQueueItem.prototype.callRejected = function (value) {\n  handlers.reject(this.promise, value);\n};\nQueueItem.prototype.otherCallRejected = function (value) {\n  unwrap(this.promise, this.onRejected, value);\n};\n\nfunction unwrap(promise, func, value) {\n  immediate(function () {\n    var returnValue;\n    try {\n      returnValue = func(value);\n    } catch (e) {\n      return handlers.reject(promise, e);\n    }\n    if (returnValue === promise) {\n      handlers.reject(promise, new TypeError('Cannot resolve promise with itself'));\n    } else {\n      handlers.resolve(promise, returnValue);\n    }\n  });\n}\n\nhandlers.resolve = function (self, value) {\n  var result = tryCatch(getThen, value);\n  if (result.status === 'error') {\n    return handlers.reject(self, result.value);\n  }\n  var thenable = result.value;\n\n  if (thenable) {\n    safelyResolveThenable(self, thenable);\n  } else {\n    self.state = FULFILLED;\n    self.outcome = value;\n    var i = -1;\n    var len = self.queue.length;\n    while (++i < len) {\n      self.queue[i].callFulfilled(value);\n    }\n  }\n  return self;\n};\nhandlers.reject = function (self, error) {\n  self.state = REJECTED;\n  self.outcome = error;\n  var i = -1;\n  var len = self.queue.length;\n  while (++i < len) {\n    self.queue[i].callRejected(error);\n  }\n  return self;\n};\n\nfunction getThen(obj) {\n  // Make sure we only access the accessor once as required by the spec\n  var then = obj && obj.then;\n  if (obj && (typeof obj === 'object' || typeof obj === 'function') && typeof then === 'function') {\n    return function appyThen() {\n      then.apply(obj, arguments);\n    };\n  }\n}\n\nfunction safelyResolveThenable(self, thenable) {\n  // Either fulfill, reject or reject with error\n  var called = false;\n  function onError(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.reject(self, value);\n  }\n\n  function onSuccess(value) {\n    if (called) {\n      return;\n    }\n    called = true;\n    handlers.resolve(self, value);\n  }\n\n  function tryToUnwrap() {\n    thenable(onSuccess, onError);\n  }\n\n  var result = tryCatch(tryToUnwrap);\n  if (result.status === 'error') {\n    onError(result.value);\n  }\n}\n\nfunction tryCatch(func, value) {\n  var out = {};\n  try {\n    out.value = func(value);\n    out.status = 'success';\n  } catch (e) {\n    out.status = 'error';\n    out.value = e;\n  }\n  return out;\n}\n\nPromise.resolve = resolve;\nfunction resolve(value) {\n  if (value instanceof this) {\n    return value;\n  }\n  return handlers.resolve(new this(INTERNAL), value);\n}\n\nPromise.reject = reject;\nfunction reject(reason) {\n  var promise = new this(INTERNAL);\n  return handlers.reject(promise, reason);\n}\n\nPromise.all = all;\nfunction all(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var values = new Array(len);\n  var resolved = 0;\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    allResolver(iterable[i], i);\n  }\n  return promise;\n  function allResolver(value, i) {\n    self.resolve(value).then(resolveFromAll, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n    function resolveFromAll(outValue) {\n      values[i] = outValue;\n      if (++resolved === len && !called) {\n        called = true;\n        handlers.resolve(promise, values);\n      }\n    }\n  }\n}\n\nPromise.race = race;\nfunction race(iterable) {\n  var self = this;\n  if (Object.prototype.toString.call(iterable) !== '[object Array]') {\n    return this.reject(new TypeError('must be an array'));\n  }\n\n  var len = iterable.length;\n  var called = false;\n  if (!len) {\n    return this.resolve([]);\n  }\n\n  var i = -1;\n  var promise = new this(INTERNAL);\n\n  while (++i < len) {\n    resolver(iterable[i]);\n  }\n  return promise;\n  function resolver(value) {\n    self.resolve(value).then(function (response) {\n      if (!called) {\n        called = true;\n        handlers.resolve(promise, response);\n      }\n    }, function (error) {\n      if (!called) {\n        called = true;\n        handlers.reject(promise, error);\n      }\n    });\n  }\n}\n\n},{\"1\":1}],3:[function(_dereq_,module,exports){\n(function (global){\n'use strict';\nif (typeof global.Promise !== 'function') {\n  global.Promise = _dereq_(2);\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"2\":2}],4:[function(_dereq_,module,exports){\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction getIDB() {\n    /* global indexedDB,webkitIndexedDB,mozIndexedDB,OIndexedDB,msIndexedDB */\n    try {\n        if (typeof indexedDB !== 'undefined') {\n            return indexedDB;\n        }\n        if (typeof webkitIndexedDB !== 'undefined') {\n            return webkitIndexedDB;\n        }\n        if (typeof mozIndexedDB !== 'undefined') {\n            return mozIndexedDB;\n        }\n        if (typeof OIndexedDB !== 'undefined') {\n            return OIndexedDB;\n        }\n        if (typeof msIndexedDB !== 'undefined') {\n            return msIndexedDB;\n        }\n    } catch (e) {\n        return;\n    }\n}\n\nvar idb = getIDB();\n\nfunction isIndexedDBValid() {\n    try {\n        // Initialize IndexedDB; fall back to vendor-prefixed versions\n        // if needed.\n        if (!idb || !idb.open) {\n            return false;\n        }\n        // We mimic PouchDB here;\n        //\n        // We test for openDatabase because IE Mobile identifies itself\n        // as Safari. Oh the lulz...\n        var isSafari = typeof openDatabase !== 'undefined' && /(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent) && !/BlackBerry/.test(navigator.platform);\n\n        var hasFetch = typeof fetch === 'function' && fetch.toString().indexOf('[native code') !== -1;\n\n        // Safari <10.1 does not meet our requirements for IDB support\n        // (see: https://github.com/pouchdb/pouchdb/issues/5572).\n        // Safari 10.1 shipped with fetch, we can use that to detect it.\n        // Note: this creates issues with `window.fetch` polyfills and\n        // overrides; see:\n        // https://github.com/localForage/localForage/issues/856\n        return (!isSafari || hasFetch) && typeof indexedDB !== 'undefined' &&\n        // some outdated implementations of IDB that appear on Samsung\n        // and HTC Android devices <4.4 are missing IDBKeyRange\n        // See: https://github.com/mozilla/localForage/issues/128\n        // See: https://github.com/mozilla/localForage/issues/272\n        typeof IDBKeyRange !== 'undefined';\n    } catch (e) {\n        return false;\n    }\n}\n\n// Abstracts constructing a Blob object, so it also works in older\n// browsers that don't support the native Blob constructor. (i.e.\n// old QtWebKit versions, at least).\n// Abstracts constructing a Blob object, so it also works in older\n// browsers that don't support the native Blob constructor. (i.e.\n// old QtWebKit versions, at least).\nfunction createBlob(parts, properties) {\n    /* global BlobBuilder,MSBlobBuilder,MozBlobBuilder,WebKitBlobBuilder */\n    parts = parts || [];\n    properties = properties || {};\n    try {\n        return new Blob(parts, properties);\n    } catch (e) {\n        if (e.name !== 'TypeError') {\n            throw e;\n        }\n        var Builder = typeof BlobBuilder !== 'undefined' ? BlobBuilder : typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder : typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : WebKitBlobBuilder;\n        var builder = new Builder();\n        for (var i = 0; i < parts.length; i += 1) {\n            builder.append(parts[i]);\n        }\n        return builder.getBlob(properties.type);\n    }\n}\n\n// This is CommonJS because lie is an external dependency, so Rollup\n// can just ignore it.\nif (typeof Promise === 'undefined') {\n    // In the \"nopromises\" build this will just throw if you don't have\n    // a global promise object, but it would throw anyway later.\n    _dereq_(3);\n}\nvar Promise$1 = Promise;\n\nfunction executeCallback(promise, callback) {\n    if (callback) {\n        promise.then(function (result) {\n            callback(null, result);\n        }, function (error) {\n            callback(error);\n        });\n    }\n}\n\nfunction executeTwoCallbacks(promise, callback, errorCallback) {\n    if (typeof callback === 'function') {\n        promise.then(callback);\n    }\n\n    if (typeof errorCallback === 'function') {\n        promise[\"catch\"](errorCallback);\n    }\n}\n\nfunction normalizeKey(key) {\n    // Cast the key to a string, as that's all we can set as a key.\n    if (typeof key !== 'string') {\n        console.warn(key + ' used as a key, but it is not a string.');\n        key = String(key);\n    }\n\n    return key;\n}\n\nfunction getCallback() {\n    if (arguments.length && typeof arguments[arguments.length - 1] === 'function') {\n        return arguments[arguments.length - 1];\n    }\n}\n\n// Some code originally from async_storage.js in\n// [Gaia](https://github.com/mozilla-b2g/gaia).\n\nvar DETECT_BLOB_SUPPORT_STORE = 'local-forage-detect-blob-support';\nvar supportsBlobs = void 0;\nvar dbContexts = {};\nvar toString = Object.prototype.toString;\n\n// Transaction Modes\nvar READ_ONLY = 'readonly';\nvar READ_WRITE = 'readwrite';\n\n// Transform a binary string to an array buffer, because otherwise\n// weird stuff happens when you try to work with the binary string directly.\n// It is known.\n// From http://stackoverflow.com/questions/14967647/ (continues on next line)\n// encode-decode-image-with-base64-breaks-image (2013-04-21)\nfunction _binStringToArrayBuffer(bin) {\n    var length = bin.length;\n    var buf = new ArrayBuffer(length);\n    var arr = new Uint8Array(buf);\n    for (var i = 0; i < length; i++) {\n        arr[i] = bin.charCodeAt(i);\n    }\n    return buf;\n}\n\n//\n// Blobs are not supported in all versions of IndexedDB, notably\n// Chrome <37 and Android <5. In those versions, storing a blob will throw.\n//\n// Various other blob bugs exist in Chrome v37-42 (inclusive).\n// Detecting them is expensive and confusing to users, and Chrome 37-42\n// is at very low usage worldwide, so we do a hacky userAgent check instead.\n//\n// content-type bug: https://code.google.com/p/chromium/issues/detail?id=408120\n// 404 bug: https://code.google.com/p/chromium/issues/detail?id=447916\n// FileReader bug: https://code.google.com/p/chromium/issues/detail?id=447836\n//\n// Code borrowed from PouchDB. See:\n// https://github.com/pouchdb/pouchdb/blob/master/packages/node_modules/pouchdb-adapter-idb/src/blobSupport.js\n//\nfunction _checkBlobSupportWithoutCaching(idb) {\n    return new Promise$1(function (resolve) {\n        var txn = idb.transaction(DETECT_BLOB_SUPPORT_STORE, READ_WRITE);\n        var blob = createBlob(['']);\n        txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob, 'key');\n\n        txn.onabort = function (e) {\n            // If the transaction aborts now its due to not being able to\n            // write to the database, likely due to the disk being full\n            e.preventDefault();\n            e.stopPropagation();\n            resolve(false);\n        };\n\n        txn.oncomplete = function () {\n            var matchedChrome = navigator.userAgent.match(/Chrome\\/(\\d+)/);\n            var matchedEdge = navigator.userAgent.match(/Edge\\//);\n            // MS Edge pretends to be Chrome 42:\n            // https://msdn.microsoft.com/en-us/library/hh869301%28v=vs.85%29.aspx\n            resolve(matchedEdge || !matchedChrome || parseInt(matchedChrome[1], 10) >= 43);\n        };\n    })[\"catch\"](function () {\n        return false; // error, so assume unsupported\n    });\n}\n\nfunction _checkBlobSupport(idb) {\n    if (typeof supportsBlobs === 'boolean') {\n        return Promise$1.resolve(supportsBlobs);\n    }\n    return _checkBlobSupportWithoutCaching(idb).then(function (value) {\n        supportsBlobs = value;\n        return supportsBlobs;\n    });\n}\n\nfunction _deferReadiness(dbInfo) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Create a deferred object representing the current database operation.\n    var deferredOperation = {};\n\n    deferredOperation.promise = new Promise$1(function (resolve, reject) {\n        deferredOperation.resolve = resolve;\n        deferredOperation.reject = reject;\n    });\n\n    // Enqueue the deferred operation.\n    dbContext.deferredOperations.push(deferredOperation);\n\n    // Chain its promise to the database readiness.\n    if (!dbContext.dbReady) {\n        dbContext.dbReady = deferredOperation.promise;\n    } else {\n        dbContext.dbReady = dbContext.dbReady.then(function () {\n            return deferredOperation.promise;\n        });\n    }\n}\n\nfunction _advanceReadiness(dbInfo) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Dequeue a deferred operation.\n    var deferredOperation = dbContext.deferredOperations.pop();\n\n    // Resolve its promise (which is part of the database readiness\n    // chain of promises).\n    if (deferredOperation) {\n        deferredOperation.resolve();\n        return deferredOperation.promise;\n    }\n}\n\nfunction _rejectReadiness(dbInfo, err) {\n    var dbContext = dbContexts[dbInfo.name];\n\n    // Dequeue a deferred operation.\n    var deferredOperation = dbContext.deferredOperations.pop();\n\n    // Reject its promise (which is part of the database readiness\n    // chain of promises).\n    if (deferredOperation) {\n        deferredOperation.reject(err);\n        return deferredOperation.promise;\n    }\n}\n\nfunction _getConnection(dbInfo, upgradeNeeded) {\n    return new Promise$1(function (resolve, reject) {\n        dbContexts[dbInfo.name] = dbContexts[dbInfo.name] || createDbContext();\n\n        if (dbInfo.db) {\n            if (upgradeNeeded) {\n                _deferReadiness(dbInfo);\n                dbInfo.db.close();\n            } else {\n                return resolve(dbInfo.db);\n            }\n        }\n\n        var dbArgs = [dbInfo.name];\n\n        if (upgradeNeeded) {\n            dbArgs.push(dbInfo.version);\n        }\n\n        var openreq = idb.open.apply(idb, dbArgs);\n\n        if (upgradeNeeded) {\n            openreq.onupgradeneeded = function (e) {\n                var db = openreq.result;\n                try {\n                    db.createObjectStore(dbInfo.storeName);\n                    if (e.oldVersion <= 1) {\n                        // Added when support for blob shims was added\n                        db.createObjectStore(DETECT_BLOB_SUPPORT_STORE);\n                    }\n                } catch (ex) {\n                    if (ex.name === 'ConstraintError') {\n                        console.warn('The database \"' + dbInfo.name + '\"' + ' has been upgraded from version ' + e.oldVersion + ' to version ' + e.newVersion + ', but the storage \"' + dbInfo.storeName + '\" already exists.');\n                    } else {\n                        throw ex;\n                    }\n                }\n            };\n        }\n\n        openreq.onerror = function (e) {\n            e.preventDefault();\n            reject(openreq.error);\n        };\n\n        openreq.onsuccess = function () {\n            var db = openreq.result;\n            db.onversionchange = function (e) {\n                // Triggered when the database is modified (e.g. adding an objectStore) or\n                // deleted (even when initiated by other sessions in different tabs).\n                // Closing the connection here prevents those operations from being blocked.\n                // If the database is accessed again later by this instance, the connection\n                // will be reopened or the database recreated as needed.\n                e.target.close();\n            };\n            resolve(db);\n            _advanceReadiness(dbInfo);\n        };\n    });\n}\n\nfunction _getOriginalConnection(dbInfo) {\n    return _getConnection(dbInfo, false);\n}\n\nfunction _getUpgradedConnection(dbInfo) {\n    return _getConnection(dbInfo, true);\n}\n\nfunction _isUpgradeNeeded(dbInfo, defaultVersion) {\n    if (!dbInfo.db) {\n        return true;\n    }\n\n    var isNewStore = !dbInfo.db.objectStoreNames.contains(dbInfo.storeName);\n    var isDowngrade = dbInfo.version < dbInfo.db.version;\n    var isUpgrade = dbInfo.version > dbInfo.db.version;\n\n    if (isDowngrade) {\n        // If the version is not the default one\n        // then warn for impossible downgrade.\n        if (dbInfo.version !== defaultVersion) {\n            console.warn('The database \"' + dbInfo.name + '\"' + \" can't be downgraded from version \" + dbInfo.db.version + ' to version ' + dbInfo.version + '.');\n        }\n        // Align the versions to prevent errors.\n        dbInfo.version = dbInfo.db.version;\n    }\n\n    if (isUpgrade || isNewStore) {\n        // If the store is new then increment the version (if needed).\n        // This will trigger an \"upgradeneeded\" event which is required\n        // for creating a store.\n        if (isNewStore) {\n            var incVersion = dbInfo.db.version + 1;\n            if (incVersion > dbInfo.version) {\n                dbInfo.version = incVersion;\n            }\n        }\n\n        return true;\n    }\n\n    return false;\n}\n\n// encode a blob for indexeddb engines that don't support blobs\nfunction _encodeBlob(blob) {\n    return new Promise$1(function (resolve, reject) {\n        var reader = new FileReader();\n        reader.onerror = reject;\n        reader.onloadend = function (e) {\n            var base64 = btoa(e.target.result || '');\n            resolve({\n                __local_forage_encoded_blob: true,\n                data: base64,\n                type: blob.type\n            });\n        };\n        reader.readAsBinaryString(blob);\n    });\n}\n\n// decode an encoded blob\nfunction _decodeBlob(encodedBlob) {\n    var arrayBuff = _binStringToArrayBuffer(atob(encodedBlob.data));\n    return createBlob([arrayBuff], { type: encodedBlob.type });\n}\n\n// is this one of our fancy encoded blobs?\nfunction _isEncodedBlob(value) {\n    return value && value.__local_forage_encoded_blob;\n}\n\n// Specialize the default `ready()` function by making it dependent\n// on the current database operations. Thus, the driver will be actually\n// ready when it's been initialized (default) *and* there are no pending\n// operations on the database (initiated by some other instances).\nfunction _fullyReady(callback) {\n    var self = this;\n\n    var promise = self._initReady().then(function () {\n        var dbContext = dbContexts[self._dbInfo.name];\n\n        if (dbContext && dbContext.dbReady) {\n            return dbContext.dbReady;\n        }\n    });\n\n    executeTwoCallbacks(promise, callback, callback);\n    return promise;\n}\n\n// Try to establish a new db connection to replace the\n// current one which is broken (i.e. experiencing\n// InvalidStateError while creating a transaction).\nfunction _tryReconnect(dbInfo) {\n    _deferReadiness(dbInfo);\n\n    var dbContext = dbContexts[dbInfo.name];\n    var forages = dbContext.forages;\n\n    for (var i = 0; i < forages.length; i++) {\n        var forage = forages[i];\n        if (forage._dbInfo.db) {\n            forage._dbInfo.db.close();\n            forage._dbInfo.db = null;\n        }\n    }\n    dbInfo.db = null;\n\n    return _getOriginalConnection(dbInfo).then(function (db) {\n        dbInfo.db = db;\n        if (_isUpgradeNeeded(dbInfo)) {\n            // Reopen the database for upgrading.\n            return _getUpgradedConnection(dbInfo);\n        }\n        return db;\n    }).then(function (db) {\n        // store the latest db reference\n        // in case the db was upgraded\n        dbInfo.db = dbContext.db = db;\n        for (var i = 0; i < forages.length; i++) {\n            forages[i]._dbInfo.db = db;\n        }\n    })[\"catch\"](function (err) {\n        _rejectReadiness(dbInfo, err);\n        throw err;\n    });\n}\n\n// FF doesn't like Promises (micro-tasks) and IDDB store operations,\n// so we have to do it with callbacks\nfunction createTransaction(dbInfo, mode, callback, retries) {\n    if (retries === undefined) {\n        retries = 1;\n    }\n\n    try {\n        var tx = dbInfo.db.transaction(dbInfo.storeName, mode);\n        callback(null, tx);\n    } catch (err) {\n        if (retries > 0 && (!dbInfo.db || err.name === 'InvalidStateError' || err.name === 'NotFoundError')) {\n            return Promise$1.resolve().then(function () {\n                if (!dbInfo.db || err.name === 'NotFoundError' && !dbInfo.db.objectStoreNames.contains(dbInfo.storeName) && dbInfo.version <= dbInfo.db.version) {\n                    // increase the db version, to create the new ObjectStore\n                    if (dbInfo.db) {\n                        dbInfo.version = dbInfo.db.version + 1;\n                    }\n                    // Reopen the database for upgrading.\n                    return _getUpgradedConnection(dbInfo);\n                }\n            }).then(function () {\n                return _tryReconnect(dbInfo).then(function () {\n                    createTransaction(dbInfo, mode, callback, retries - 1);\n                });\n            })[\"catch\"](callback);\n        }\n\n        callback(err);\n    }\n}\n\nfunction createDbContext() {\n    return {\n        // Running localForages sharing a database.\n        forages: [],\n        // Shared database.\n        db: null,\n        // Database readiness (promise).\n        dbReady: null,\n        // Deferred operations on the database.\n        deferredOperations: []\n    };\n}\n\n// Open the IndexedDB database (automatically creates one if one didn't\n// previously exist), using any options set in the config.\nfunction _initStorage(options) {\n    var self = this;\n    var dbInfo = {\n        db: null\n    };\n\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = options[i];\n        }\n    }\n\n    // Get the current context of the database;\n    var dbContext = dbContexts[dbInfo.name];\n\n    // ...or create a new context.\n    if (!dbContext) {\n        dbContext = createDbContext();\n        // Register the new context in the global container.\n        dbContexts[dbInfo.name] = dbContext;\n    }\n\n    // Register itself as a running localForage in the current context.\n    dbContext.forages.push(self);\n\n    // Replace the default `ready()` function with the specialized one.\n    if (!self._initReady) {\n        self._initReady = self.ready;\n        self.ready = _fullyReady;\n    }\n\n    // Create an array of initialization states of the related localForages.\n    var initPromises = [];\n\n    function ignoreErrors() {\n        // Don't handle errors here,\n        // just makes sure related localForages aren't pending.\n        return Promise$1.resolve();\n    }\n\n    for (var j = 0; j < dbContext.forages.length; j++) {\n        var forage = dbContext.forages[j];\n        if (forage !== self) {\n            // Don't wait for itself...\n            initPromises.push(forage._initReady()[\"catch\"](ignoreErrors));\n        }\n    }\n\n    // Take a snapshot of the related localForages.\n    var forages = dbContext.forages.slice(0);\n\n    // Initialize the connection process only when\n    // all the related localForages aren't pending.\n    return Promise$1.all(initPromises).then(function () {\n        dbInfo.db = dbContext.db;\n        // Get the connection or open a new one without upgrade.\n        return _getOriginalConnection(dbInfo);\n    }).then(function (db) {\n        dbInfo.db = db;\n        if (_isUpgradeNeeded(dbInfo, self._defaultConfig.version)) {\n            // Reopen the database for upgrading.\n            return _getUpgradedConnection(dbInfo);\n        }\n        return db;\n    }).then(function (db) {\n        dbInfo.db = dbContext.db = db;\n        self._dbInfo = dbInfo;\n        // Share the final connection amongst related localForages.\n        for (var k = 0; k < forages.length; k++) {\n            var forage = forages[k];\n            if (forage !== self) {\n                // Self is already up-to-date.\n                forage._dbInfo.db = dbInfo.db;\n                forage._dbInfo.version = dbInfo.version;\n            }\n        }\n    });\n}\n\nfunction getItem(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.get(key);\n\n                    req.onsuccess = function () {\n                        var value = req.result;\n                        if (value === undefined) {\n                            value = null;\n                        }\n                        if (_isEncodedBlob(value)) {\n                            value = _decodeBlob(value);\n                        }\n                        resolve(value);\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Iterate over all items stored in database.\nfunction iterate(iterator, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.openCursor();\n                    var iterationNumber = 1;\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n\n                        if (cursor) {\n                            var value = cursor.value;\n                            if (_isEncodedBlob(value)) {\n                                value = _decodeBlob(value);\n                            }\n                            var result = iterator(value, cursor.key, iterationNumber++);\n\n                            // when the iterator callback returns any\n                            // (non-`undefined`) value, then we stop\n                            // the iteration immediately\n                            if (result !== void 0) {\n                                resolve(result);\n                            } else {\n                                cursor[\"continue\"]();\n                            }\n                        } else {\n                            resolve();\n                        }\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n\n    return promise;\n}\n\nfunction setItem(key, value, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        var dbInfo;\n        self.ready().then(function () {\n            dbInfo = self._dbInfo;\n            if (toString.call(value) === '[object Blob]') {\n                return _checkBlobSupport(dbInfo.db).then(function (blobSupport) {\n                    if (blobSupport) {\n                        return value;\n                    }\n                    return _encodeBlob(value);\n                });\n            }\n            return value;\n        }).then(function (value) {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n\n                    // The reason we don't _save_ null is because IE 10 does\n                    // not support saving the `null` type in IndexedDB. How\n                    // ironic, given the bug below!\n                    // See: https://github.com/mozilla/localForage/issues/161\n                    if (value === null) {\n                        value = undefined;\n                    }\n\n                    var req = store.put(value, key);\n\n                    transaction.oncomplete = function () {\n                        // Cast to undefined so the value passed to\n                        // callback/promise is the same as what one would get out\n                        // of `getItem()` later. This leads to some weirdness\n                        // (setItem('foo', undefined) will return `null`), but\n                        // it's not my fault localStorage is our baseline and that\n                        // it's weird.\n                        if (value === undefined) {\n                            value = null;\n                        }\n\n                        resolve(value);\n                    };\n                    transaction.onabort = transaction.onerror = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction removeItem(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    // We use a Grunt task to make this safe for IE and some\n                    // versions of Android (including those used by Cordova).\n                    // Normally IE won't like `.delete()` and will insist on\n                    // using `['delete']()`, but we have a build step that\n                    // fixes this for us now.\n                    var req = store[\"delete\"](key);\n                    transaction.oncomplete = function () {\n                        resolve();\n                    };\n\n                    transaction.onerror = function () {\n                        reject(req.error);\n                    };\n\n                    // The request will be also be aborted if we've exceeded our storage\n                    // space.\n                    transaction.onabort = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction clear(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_WRITE, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.clear();\n\n                    transaction.oncomplete = function () {\n                        resolve();\n                    };\n\n                    transaction.onabort = transaction.onerror = function () {\n                        var err = req.error ? req.error : req.transaction.error;\n                        reject(err);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction length(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.count();\n\n                    req.onsuccess = function () {\n                        resolve(req.result);\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction key(n, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        if (n < 0) {\n            resolve(null);\n\n            return;\n        }\n\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var advanced = false;\n                    var req = store.openKeyCursor();\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n                        if (!cursor) {\n                            // this means there weren't enough keys\n                            resolve(null);\n\n                            return;\n                        }\n\n                        if (n === 0) {\n                            // We have the first key, return it if that's what they\n                            // wanted.\n                            resolve(cursor.key);\n                        } else {\n                            if (!advanced) {\n                                // Otherwise, ask the cursor to skip ahead n\n                                // records.\n                                advanced = true;\n                                cursor.advance(n);\n                            } else {\n                                // When we get here, we've got the nth key.\n                                resolve(cursor.key);\n                            }\n                        }\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            createTransaction(self._dbInfo, READ_ONLY, function (err, transaction) {\n                if (err) {\n                    return reject(err);\n                }\n\n                try {\n                    var store = transaction.objectStore(self._dbInfo.storeName);\n                    var req = store.openKeyCursor();\n                    var keys = [];\n\n                    req.onsuccess = function () {\n                        var cursor = req.result;\n\n                        if (!cursor) {\n                            resolve(keys);\n                            return;\n                        }\n\n                        keys.push(cursor.key);\n                        cursor[\"continue\"]();\n                    };\n\n                    req.onerror = function () {\n                        reject(req.error);\n                    };\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction dropInstance(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    var currentConfig = this.config();\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        var isCurrentDb = options.name === currentConfig.name && self._dbInfo.db;\n\n        var dbPromise = isCurrentDb ? Promise$1.resolve(self._dbInfo.db) : _getOriginalConnection(options).then(function (db) {\n            var dbContext = dbContexts[options.name];\n            var forages = dbContext.forages;\n            dbContext.db = db;\n            for (var i = 0; i < forages.length; i++) {\n                forages[i]._dbInfo.db = db;\n            }\n            return db;\n        });\n\n        if (!options.storeName) {\n            promise = dbPromise.then(function (db) {\n                _deferReadiness(options);\n\n                var dbContext = dbContexts[options.name];\n                var forages = dbContext.forages;\n\n                db.close();\n                for (var i = 0; i < forages.length; i++) {\n                    var forage = forages[i];\n                    forage._dbInfo.db = null;\n                }\n\n                var dropDBPromise = new Promise$1(function (resolve, reject) {\n                    var req = idb.deleteDatabase(options.name);\n\n                    req.onerror = function () {\n                        var db = req.result;\n                        if (db) {\n                            db.close();\n                        }\n                        reject(req.error);\n                    };\n\n                    req.onblocked = function () {\n                        // Closing all open connections in onversionchange handler should prevent this situation, but if\n                        // we do get here, it just means the request remains pending - eventually it will succeed or error\n                        console.warn('dropInstance blocked for database \"' + options.name + '\" until all open connections are closed');\n                    };\n\n                    req.onsuccess = function () {\n                        var db = req.result;\n                        if (db) {\n                            db.close();\n                        }\n                        resolve(db);\n                    };\n                });\n\n                return dropDBPromise.then(function (db) {\n                    dbContext.db = db;\n                    for (var i = 0; i < forages.length; i++) {\n                        var _forage = forages[i];\n                        _advanceReadiness(_forage._dbInfo);\n                    }\n                })[\"catch\"](function (err) {\n                    (_rejectReadiness(options, err) || Promise$1.resolve())[\"catch\"](function () {});\n                    throw err;\n                });\n            });\n        } else {\n            promise = dbPromise.then(function (db) {\n                if (!db.objectStoreNames.contains(options.storeName)) {\n                    return;\n                }\n\n                var newVersion = db.version + 1;\n\n                _deferReadiness(options);\n\n                var dbContext = dbContexts[options.name];\n                var forages = dbContext.forages;\n\n                db.close();\n                for (var i = 0; i < forages.length; i++) {\n                    var forage = forages[i];\n                    forage._dbInfo.db = null;\n                    forage._dbInfo.version = newVersion;\n                }\n\n                var dropObjectPromise = new Promise$1(function (resolve, reject) {\n                    var req = idb.open(options.name, newVersion);\n\n                    req.onerror = function (err) {\n                        var db = req.result;\n                        db.close();\n                        reject(err);\n                    };\n\n                    req.onupgradeneeded = function () {\n                        var db = req.result;\n                        db.deleteObjectStore(options.storeName);\n                    };\n\n                    req.onsuccess = function () {\n                        var db = req.result;\n                        db.close();\n                        resolve(db);\n                    };\n                });\n\n                return dropObjectPromise.then(function (db) {\n                    dbContext.db = db;\n                    for (var j = 0; j < forages.length; j++) {\n                        var _forage2 = forages[j];\n                        _forage2._dbInfo.db = db;\n                        _advanceReadiness(_forage2._dbInfo);\n                    }\n                })[\"catch\"](function (err) {\n                    (_rejectReadiness(options, err) || Promise$1.resolve())[\"catch\"](function () {});\n                    throw err;\n                });\n            });\n        }\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar asyncStorage = {\n    _driver: 'asyncStorage',\n    _initStorage: _initStorage,\n    _support: isIndexedDBValid(),\n    iterate: iterate,\n    getItem: getItem,\n    setItem: setItem,\n    removeItem: removeItem,\n    clear: clear,\n    length: length,\n    key: key,\n    keys: keys,\n    dropInstance: dropInstance\n};\n\nfunction isWebSQLValid() {\n    return typeof openDatabase === 'function';\n}\n\n// Sadly, the best way to save binary data in WebSQL/localStorage is serializing\n// it to Base64, so this is how we store it to prevent very strange errors with less\n// verbose ways of binary <-> string data storage.\nvar BASE_CHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\nvar BLOB_TYPE_PREFIX = '~~local_forage_type~';\nvar BLOB_TYPE_PREFIX_REGEX = /^~~local_forage_type~([^~]+)~/;\n\nvar SERIALIZED_MARKER = '__lfsc__:';\nvar SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER.length;\n\n// OMG the serializations!\nvar TYPE_ARRAYBUFFER = 'arbf';\nvar TYPE_BLOB = 'blob';\nvar TYPE_INT8ARRAY = 'si08';\nvar TYPE_UINT8ARRAY = 'ui08';\nvar TYPE_UINT8CLAMPEDARRAY = 'uic8';\nvar TYPE_INT16ARRAY = 'si16';\nvar TYPE_INT32ARRAY = 'si32';\nvar TYPE_UINT16ARRAY = 'ur16';\nvar TYPE_UINT32ARRAY = 'ui32';\nvar TYPE_FLOAT32ARRAY = 'fl32';\nvar TYPE_FLOAT64ARRAY = 'fl64';\nvar TYPE_SERIALIZED_MARKER_LENGTH = SERIALIZED_MARKER_LENGTH + TYPE_ARRAYBUFFER.length;\n\nvar toString$1 = Object.prototype.toString;\n\nfunction stringToBuffer(serializedString) {\n    // Fill the string into a ArrayBuffer.\n    var bufferLength = serializedString.length * 0.75;\n    var len = serializedString.length;\n    var i;\n    var p = 0;\n    var encoded1, encoded2, encoded3, encoded4;\n\n    if (serializedString[serializedString.length - 1] === '=') {\n        bufferLength--;\n        if (serializedString[serializedString.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n\n    var buffer = new ArrayBuffer(bufferLength);\n    var bytes = new Uint8Array(buffer);\n\n    for (i = 0; i < len; i += 4) {\n        encoded1 = BASE_CHARS.indexOf(serializedString[i]);\n        encoded2 = BASE_CHARS.indexOf(serializedString[i + 1]);\n        encoded3 = BASE_CHARS.indexOf(serializedString[i + 2]);\n        encoded4 = BASE_CHARS.indexOf(serializedString[i + 3]);\n\n        /*jslint bitwise: true */\n        bytes[p++] = encoded1 << 2 | encoded2 >> 4;\n        bytes[p++] = (encoded2 & 15) << 4 | encoded3 >> 2;\n        bytes[p++] = (encoded3 & 3) << 6 | encoded4 & 63;\n    }\n    return buffer;\n}\n\n// Converts a buffer to a string to store, serialized, in the backend\n// storage library.\nfunction bufferToString(buffer) {\n    // base64-arraybuffer\n    var bytes = new Uint8Array(buffer);\n    var base64String = '';\n    var i;\n\n    for (i = 0; i < bytes.length; i += 3) {\n        /*jslint bitwise: true */\n        base64String += BASE_CHARS[bytes[i] >> 2];\n        base64String += BASE_CHARS[(bytes[i] & 3) << 4 | bytes[i + 1] >> 4];\n        base64String += BASE_CHARS[(bytes[i + 1] & 15) << 2 | bytes[i + 2] >> 6];\n        base64String += BASE_CHARS[bytes[i + 2] & 63];\n    }\n\n    if (bytes.length % 3 === 2) {\n        base64String = base64String.substring(0, base64String.length - 1) + '=';\n    } else if (bytes.length % 3 === 1) {\n        base64String = base64String.substring(0, base64String.length - 2) + '==';\n    }\n\n    return base64String;\n}\n\n// Serialize a value, afterwards executing a callback (which usually\n// instructs the `setItem()` callback/promise to be executed). This is how\n// we store binary data with localStorage.\nfunction serialize(value, callback) {\n    var valueType = '';\n    if (value) {\n        valueType = toString$1.call(value);\n    }\n\n    // Cannot use `value instanceof ArrayBuffer` or such here, as these\n    // checks fail when running the tests using casper.js...\n    //\n    // TODO: See why those tests fail and use a better solution.\n    if (value && (valueType === '[object ArrayBuffer]' || value.buffer && toString$1.call(value.buffer) === '[object ArrayBuffer]')) {\n        // Convert binary arrays to a string and prefix the string with\n        // a special marker.\n        var buffer;\n        var marker = SERIALIZED_MARKER;\n\n        if (value instanceof ArrayBuffer) {\n            buffer = value;\n            marker += TYPE_ARRAYBUFFER;\n        } else {\n            buffer = value.buffer;\n\n            if (valueType === '[object Int8Array]') {\n                marker += TYPE_INT8ARRAY;\n            } else if (valueType === '[object Uint8Array]') {\n                marker += TYPE_UINT8ARRAY;\n            } else if (valueType === '[object Uint8ClampedArray]') {\n                marker += TYPE_UINT8CLAMPEDARRAY;\n            } else if (valueType === '[object Int16Array]') {\n                marker += TYPE_INT16ARRAY;\n            } else if (valueType === '[object Uint16Array]') {\n                marker += TYPE_UINT16ARRAY;\n            } else if (valueType === '[object Int32Array]') {\n                marker += TYPE_INT32ARRAY;\n            } else if (valueType === '[object Uint32Array]') {\n                marker += TYPE_UINT32ARRAY;\n            } else if (valueType === '[object Float32Array]') {\n                marker += TYPE_FLOAT32ARRAY;\n            } else if (valueType === '[object Float64Array]') {\n                marker += TYPE_FLOAT64ARRAY;\n            } else {\n                callback(new Error('Failed to get type for BinaryArray'));\n            }\n        }\n\n        callback(marker + bufferToString(buffer));\n    } else if (valueType === '[object Blob]') {\n        // Conver the blob to a binaryArray and then to a string.\n        var fileReader = new FileReader();\n\n        fileReader.onload = function () {\n            // Backwards-compatible prefix for the blob type.\n            var str = BLOB_TYPE_PREFIX + value.type + '~' + bufferToString(this.result);\n\n            callback(SERIALIZED_MARKER + TYPE_BLOB + str);\n        };\n\n        fileReader.readAsArrayBuffer(value);\n    } else {\n        try {\n            callback(JSON.stringify(value));\n        } catch (e) {\n            console.error(\"Couldn't convert value into a JSON string: \", value);\n\n            callback(null, e);\n        }\n    }\n}\n\n// Deserialize data we've inserted into a value column/field. We place\n// special markers into our strings to mark them as encoded; this isn't\n// as nice as a meta field, but it's the only sane thing we can do whilst\n// keeping localStorage support intact.\n//\n// Oftentimes this will just deserialize JSON content, but if we have a\n// special marker (SERIALIZED_MARKER, defined above), we will extract\n// some kind of arraybuffer/binary data/typed array out of the string.\nfunction deserialize(value) {\n    // If we haven't marked this string as being specially serialized (i.e.\n    // something other than serialized JSON), we can just return it and be\n    // done with it.\n    if (value.substring(0, SERIALIZED_MARKER_LENGTH) !== SERIALIZED_MARKER) {\n        return JSON.parse(value);\n    }\n\n    // The following code deals with deserializing some kind of Blob or\n    // TypedArray. First we separate out the type of data we're dealing\n    // with from the data itself.\n    var serializedString = value.substring(TYPE_SERIALIZED_MARKER_LENGTH);\n    var type = value.substring(SERIALIZED_MARKER_LENGTH, TYPE_SERIALIZED_MARKER_LENGTH);\n\n    var blobType;\n    // Backwards-compatible blob type serialization strategy.\n    // DBs created with older versions of localForage will simply not have the blob type.\n    if (type === TYPE_BLOB && BLOB_TYPE_PREFIX_REGEX.test(serializedString)) {\n        var matcher = serializedString.match(BLOB_TYPE_PREFIX_REGEX);\n        blobType = matcher[1];\n        serializedString = serializedString.substring(matcher[0].length);\n    }\n    var buffer = stringToBuffer(serializedString);\n\n    // Return the right type based on the code/type set during\n    // serialization.\n    switch (type) {\n        case TYPE_ARRAYBUFFER:\n            return buffer;\n        case TYPE_BLOB:\n            return createBlob([buffer], { type: blobType });\n        case TYPE_INT8ARRAY:\n            return new Int8Array(buffer);\n        case TYPE_UINT8ARRAY:\n            return new Uint8Array(buffer);\n        case TYPE_UINT8CLAMPEDARRAY:\n            return new Uint8ClampedArray(buffer);\n        case TYPE_INT16ARRAY:\n            return new Int16Array(buffer);\n        case TYPE_UINT16ARRAY:\n            return new Uint16Array(buffer);\n        case TYPE_INT32ARRAY:\n            return new Int32Array(buffer);\n        case TYPE_UINT32ARRAY:\n            return new Uint32Array(buffer);\n        case TYPE_FLOAT32ARRAY:\n            return new Float32Array(buffer);\n        case TYPE_FLOAT64ARRAY:\n            return new Float64Array(buffer);\n        default:\n            throw new Error('Unkown type: ' + type);\n    }\n}\n\nvar localforageSerializer = {\n    serialize: serialize,\n    deserialize: deserialize,\n    stringToBuffer: stringToBuffer,\n    bufferToString: bufferToString\n};\n\n/*\n * Includes code from:\n *\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n\nfunction createDbTable(t, dbInfo, callback, errorCallback) {\n    t.executeSql('CREATE TABLE IF NOT EXISTS ' + dbInfo.storeName + ' ' + '(id INTEGER PRIMARY KEY, key unique, value)', [], callback, errorCallback);\n}\n\n// Open the WebSQL database (automatically creates one if one didn't\n// previously exist), using any options set in the config.\nfunction _initStorage$1(options) {\n    var self = this;\n    var dbInfo = {\n        db: null\n    };\n\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = typeof options[i] !== 'string' ? options[i].toString() : options[i];\n        }\n    }\n\n    var dbInfoPromise = new Promise$1(function (resolve, reject) {\n        // Open the database; the openDatabase API will automatically\n        // create it for us if it doesn't exist.\n        try {\n            dbInfo.db = openDatabase(dbInfo.name, String(dbInfo.version), dbInfo.description, dbInfo.size);\n        } catch (e) {\n            return reject(e);\n        }\n\n        // Create our key/value table if it doesn't exist.\n        dbInfo.db.transaction(function (t) {\n            createDbTable(t, dbInfo, function () {\n                self._dbInfo = dbInfo;\n                resolve();\n            }, function (t, error) {\n                reject(error);\n            });\n        }, reject);\n    });\n\n    dbInfo.serializer = localforageSerializer;\n    return dbInfoPromise;\n}\n\nfunction tryExecuteSql(t, dbInfo, sqlStatement, args, callback, errorCallback) {\n    t.executeSql(sqlStatement, args, callback, function (t, error) {\n        if (error.code === error.SYNTAX_ERR) {\n            t.executeSql('SELECT name FROM sqlite_master ' + \"WHERE type='table' AND name = ?\", [dbInfo.storeName], function (t, results) {\n                if (!results.rows.length) {\n                    // if the table is missing (was deleted)\n                    // re-create it table and retry\n                    createDbTable(t, dbInfo, function () {\n                        t.executeSql(sqlStatement, args, callback, errorCallback);\n                    }, errorCallback);\n                } else {\n                    errorCallback(t, error);\n                }\n            }, errorCallback);\n        } else {\n            errorCallback(t, error);\n        }\n    }, errorCallback);\n}\n\nfunction getItem$1(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT * FROM ' + dbInfo.storeName + ' WHERE key = ? LIMIT 1', [key], function (t, results) {\n                    var result = results.rows.length ? results.rows.item(0).value : null;\n\n                    // Check to see if this is serialized content we need to\n                    // unpack.\n                    if (result) {\n                        result = dbInfo.serializer.deserialize(result);\n                    }\n\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction iterate$1(iterator, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT * FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var rows = results.rows;\n                    var length = rows.length;\n\n                    for (var i = 0; i < length; i++) {\n                        var item = rows.item(i);\n                        var result = item.value;\n\n                        // Check to see if this is serialized content\n                        // we need to unpack.\n                        if (result) {\n                            result = dbInfo.serializer.deserialize(result);\n                        }\n\n                        result = iterator(result, item.key, i + 1);\n\n                        // void(0) prevents problems with redefinition\n                        // of `undefined`.\n                        if (result !== void 0) {\n                            resolve(result);\n                            return;\n                        }\n                    }\n\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction _setItem(key, value, callback, retriesLeft) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            // The localStorage API doesn't return undefined values in an\n            // \"expected\" way, so undefined is always cast to null in all\n            // drivers. See: https://github.com/mozilla/localForage/pull/42\n            if (value === undefined) {\n                value = null;\n            }\n\n            // Save the original value to pass to the callback.\n            var originalValue = value;\n\n            var dbInfo = self._dbInfo;\n            dbInfo.serializer.serialize(value, function (value, error) {\n                if (error) {\n                    reject(error);\n                } else {\n                    dbInfo.db.transaction(function (t) {\n                        tryExecuteSql(t, dbInfo, 'INSERT OR REPLACE INTO ' + dbInfo.storeName + ' ' + '(key, value) VALUES (?, ?)', [key, value], function () {\n                            resolve(originalValue);\n                        }, function (t, error) {\n                            reject(error);\n                        });\n                    }, function (sqlError) {\n                        // The transaction failed; check\n                        // to see if it's a quota error.\n                        if (sqlError.code === sqlError.QUOTA_ERR) {\n                            // We reject the callback outright for now, but\n                            // it's worth trying to re-run the transaction.\n                            // Even if the user accepts the prompt to use\n                            // more storage on Safari, this error will\n                            // be called.\n                            //\n                            // Try to re-run the transaction.\n                            if (retriesLeft > 0) {\n                                resolve(_setItem.apply(self, [key, originalValue, callback, retriesLeft - 1]));\n                                return;\n                            }\n                            reject(sqlError);\n                        }\n                    });\n                }\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction setItem$1(key, value, callback) {\n    return _setItem.apply(this, [key, value, callback, 1]);\n}\n\nfunction removeItem$1(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'DELETE FROM ' + dbInfo.storeName + ' WHERE key = ?', [key], function () {\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Deletes every item in the table.\n// TODO: Find out if this resets the AUTO_INCREMENT number.\nfunction clear$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'DELETE FROM ' + dbInfo.storeName, [], function () {\n                    resolve();\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Does a simple `COUNT(key)` to get the number of items stored in\n// localForage.\nfunction length$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                // Ahhh, SQL makes this one soooooo easy.\n                tryExecuteSql(t, dbInfo, 'SELECT COUNT(key) as c FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var result = results.rows.item(0).c;\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Return the key located at key index X; essentially gets the key from a\n// `WHERE id = ?`. This is the most efficient way I can think to implement\n// this rarely-used (in my experience) part of the API, but it can seem\n// inconsistent, because we do `INSERT OR REPLACE INTO` on `setItem()`, so\n// the ID of each key will change every time it's updated. Perhaps a stored\n// procedure for the `setItem()` SQL would solve this problem?\n// TODO: Don't change ID on `setItem()`.\nfunction key$1(n, callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT key FROM ' + dbInfo.storeName + ' WHERE id = ? LIMIT 1', [n + 1], function (t, results) {\n                    var result = results.rows.length ? results.rows.item(0).key : null;\n                    resolve(result);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys$1(callback) {\n    var self = this;\n\n    var promise = new Promise$1(function (resolve, reject) {\n        self.ready().then(function () {\n            var dbInfo = self._dbInfo;\n            dbInfo.db.transaction(function (t) {\n                tryExecuteSql(t, dbInfo, 'SELECT key FROM ' + dbInfo.storeName, [], function (t, results) {\n                    var keys = [];\n\n                    for (var i = 0; i < results.rows.length; i++) {\n                        keys.push(results.rows.item(i).key);\n                    }\n\n                    resolve(keys);\n                }, function (t, error) {\n                    reject(error);\n                });\n            });\n        })[\"catch\"](reject);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// https://www.w3.org/TR/webdatabase/#databases\n// > There is no way to enumerate or delete the databases available for an origin from this API.\nfunction getAllStoreNames(db) {\n    return new Promise$1(function (resolve, reject) {\n        db.transaction(function (t) {\n            t.executeSql('SELECT name FROM sqlite_master ' + \"WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'\", [], function (t, results) {\n                var storeNames = [];\n\n                for (var i = 0; i < results.rows.length; i++) {\n                    storeNames.push(results.rows.item(i).name);\n                }\n\n                resolve({\n                    db: db,\n                    storeNames: storeNames\n                });\n            }, function (t, error) {\n                reject(error);\n            });\n        }, function (sqlError) {\n            reject(sqlError);\n        });\n    });\n}\n\nfunction dropInstance$1(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    var currentConfig = this.config();\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        promise = new Promise$1(function (resolve) {\n            var db;\n            if (options.name === currentConfig.name) {\n                // use the db reference of the current instance\n                db = self._dbInfo.db;\n            } else {\n                db = openDatabase(options.name, '', '', 0);\n            }\n\n            if (!options.storeName) {\n                // drop all database tables\n                resolve(getAllStoreNames(db));\n            } else {\n                resolve({\n                    db: db,\n                    storeNames: [options.storeName]\n                });\n            }\n        }).then(function (operationInfo) {\n            return new Promise$1(function (resolve, reject) {\n                operationInfo.db.transaction(function (t) {\n                    function dropTable(storeName) {\n                        return new Promise$1(function (resolve, reject) {\n                            t.executeSql('DROP TABLE IF EXISTS ' + storeName, [], function () {\n                                resolve();\n                            }, function (t, error) {\n                                reject(error);\n                            });\n                        });\n                    }\n\n                    var operations = [];\n                    for (var i = 0, len = operationInfo.storeNames.length; i < len; i++) {\n                        operations.push(dropTable(operationInfo.storeNames[i]));\n                    }\n\n                    Promise$1.all(operations).then(function () {\n                        resolve();\n                    })[\"catch\"](function (e) {\n                        reject(e);\n                    });\n                }, function (sqlError) {\n                    reject(sqlError);\n                });\n            });\n        });\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar webSQLStorage = {\n    _driver: 'webSQLStorage',\n    _initStorage: _initStorage$1,\n    _support: isWebSQLValid(),\n    iterate: iterate$1,\n    getItem: getItem$1,\n    setItem: setItem$1,\n    removeItem: removeItem$1,\n    clear: clear$1,\n    length: length$1,\n    key: key$1,\n    keys: keys$1,\n    dropInstance: dropInstance$1\n};\n\nfunction isLocalStorageValid() {\n    try {\n        return typeof localStorage !== 'undefined' && 'setItem' in localStorage &&\n        // in IE8 typeof localStorage.setItem === 'object'\n        !!localStorage.setItem;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction _getKeyPrefix(options, defaultConfig) {\n    var keyPrefix = options.name + '/';\n\n    if (options.storeName !== defaultConfig.storeName) {\n        keyPrefix += options.storeName + '/';\n    }\n    return keyPrefix;\n}\n\n// Check if localStorage throws when saving an item\nfunction checkIfLocalStorageThrows() {\n    var localStorageTestKey = '_localforage_support_test';\n\n    try {\n        localStorage.setItem(localStorageTestKey, true);\n        localStorage.removeItem(localStorageTestKey);\n\n        return false;\n    } catch (e) {\n        return true;\n    }\n}\n\n// Check if localStorage is usable and allows to save an item\n// This method checks if localStorage is usable in Safari Private Browsing\n// mode, or in any other case where the available quota for localStorage\n// is 0 and there wasn't any saved items yet.\nfunction _isLocalStorageUsable() {\n    return !checkIfLocalStorageThrows() || localStorage.length > 0;\n}\n\n// Config the localStorage backend, using options set in the config.\nfunction _initStorage$2(options) {\n    var self = this;\n    var dbInfo = {};\n    if (options) {\n        for (var i in options) {\n            dbInfo[i] = options[i];\n        }\n    }\n\n    dbInfo.keyPrefix = _getKeyPrefix(options, self._defaultConfig);\n\n    if (!_isLocalStorageUsable()) {\n        return Promise$1.reject();\n    }\n\n    self._dbInfo = dbInfo;\n    dbInfo.serializer = localforageSerializer;\n\n    return Promise$1.resolve();\n}\n\n// Remove all keys from the datastore, effectively destroying all data in\n// the app's key/value store!\nfunction clear$2(callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var keyPrefix = self._dbInfo.keyPrefix;\n\n        for (var i = localStorage.length - 1; i >= 0; i--) {\n            var key = localStorage.key(i);\n\n            if (key.indexOf(keyPrefix) === 0) {\n                localStorage.removeItem(key);\n            }\n        }\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Retrieve an item from the store. Unlike the original async_storage\n// library in Gaia, we don't modify return values at all. If a key's value\n// is `undefined`, we pass that value to the callback function.\nfunction getItem$2(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var result = localStorage.getItem(dbInfo.keyPrefix + key);\n\n        // If a result was found, parse it from the serialized\n        // string into a JS object. If result isn't truthy, the key\n        // is likely undefined and we'll pass it straight to the\n        // callback.\n        if (result) {\n            result = dbInfo.serializer.deserialize(result);\n        }\n\n        return result;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Iterate over all items in the store.\nfunction iterate$2(iterator, callback) {\n    var self = this;\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var keyPrefix = dbInfo.keyPrefix;\n        var keyPrefixLength = keyPrefix.length;\n        var length = localStorage.length;\n\n        // We use a dedicated iterator instead of the `i` variable below\n        // so other keys we fetch in localStorage aren't counted in\n        // the `iterationNumber` argument passed to the `iterate()`\n        // callback.\n        //\n        // See: github.com/mozilla/localForage/pull/435#discussion_r38061530\n        var iterationNumber = 1;\n\n        for (var i = 0; i < length; i++) {\n            var key = localStorage.key(i);\n            if (key.indexOf(keyPrefix) !== 0) {\n                continue;\n            }\n            var value = localStorage.getItem(key);\n\n            // If a result was found, parse it from the serialized\n            // string into a JS object. If result isn't truthy, the\n            // key is likely undefined and we'll pass it straight\n            // to the iterator.\n            if (value) {\n                value = dbInfo.serializer.deserialize(value);\n            }\n\n            value = iterator(value, key.substring(keyPrefixLength), iterationNumber++);\n\n            if (value !== void 0) {\n                return value;\n            }\n        }\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Same as localStorage's key() method, except takes a callback.\nfunction key$2(n, callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var result;\n        try {\n            result = localStorage.key(n);\n        } catch (error) {\n            result = null;\n        }\n\n        // Remove the prefix from the key, if a key is found.\n        if (result) {\n            result = result.substring(dbInfo.keyPrefix.length);\n        }\n\n        return result;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction keys$2(callback) {\n    var self = this;\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        var length = localStorage.length;\n        var keys = [];\n\n        for (var i = 0; i < length; i++) {\n            var itemKey = localStorage.key(i);\n            if (itemKey.indexOf(dbInfo.keyPrefix) === 0) {\n                keys.push(itemKey.substring(dbInfo.keyPrefix.length));\n            }\n        }\n\n        return keys;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Supply the number of keys in the datastore to the callback function.\nfunction length$2(callback) {\n    var self = this;\n    var promise = self.keys().then(function (keys) {\n        return keys.length;\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Remove an item from the store, nice and simple.\nfunction removeItem$2(key, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        var dbInfo = self._dbInfo;\n        localStorage.removeItem(dbInfo.keyPrefix + key);\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\n// Set a key's value and run an optional callback once the value is set.\n// Unlike Gaia's implementation, the callback function is passed the value,\n// in case you want to operate on that value only after you're sure it\n// saved, or something like that.\nfunction setItem$2(key, value, callback) {\n    var self = this;\n\n    key = normalizeKey(key);\n\n    var promise = self.ready().then(function () {\n        // Convert undefined values to null.\n        // https://github.com/mozilla/localForage/pull/42\n        if (value === undefined) {\n            value = null;\n        }\n\n        // Save the original value to pass to the callback.\n        var originalValue = value;\n\n        return new Promise$1(function (resolve, reject) {\n            var dbInfo = self._dbInfo;\n            dbInfo.serializer.serialize(value, function (value, error) {\n                if (error) {\n                    reject(error);\n                } else {\n                    try {\n                        localStorage.setItem(dbInfo.keyPrefix + key, value);\n                        resolve(originalValue);\n                    } catch (e) {\n                        // localStorage capacity exceeded.\n                        // TODO: Make this a specific error/event.\n                        if (e.name === 'QuotaExceededError' || e.name === 'NS_ERROR_DOM_QUOTA_REACHED') {\n                            reject(e);\n                        }\n                        reject(e);\n                    }\n                }\n            });\n        });\n    });\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nfunction dropInstance$2(options, callback) {\n    callback = getCallback.apply(this, arguments);\n\n    options = typeof options !== 'function' && options || {};\n    if (!options.name) {\n        var currentConfig = this.config();\n        options.name = options.name || currentConfig.name;\n        options.storeName = options.storeName || currentConfig.storeName;\n    }\n\n    var self = this;\n    var promise;\n    if (!options.name) {\n        promise = Promise$1.reject('Invalid arguments');\n    } else {\n        promise = new Promise$1(function (resolve) {\n            if (!options.storeName) {\n                resolve(options.name + '/');\n            } else {\n                resolve(_getKeyPrefix(options, self._defaultConfig));\n            }\n        }).then(function (keyPrefix) {\n            for (var i = localStorage.length - 1; i >= 0; i--) {\n                var key = localStorage.key(i);\n\n                if (key.indexOf(keyPrefix) === 0) {\n                    localStorage.removeItem(key);\n                }\n            }\n        });\n    }\n\n    executeCallback(promise, callback);\n    return promise;\n}\n\nvar localStorageWrapper = {\n    _driver: 'localStorageWrapper',\n    _initStorage: _initStorage$2,\n    _support: isLocalStorageValid(),\n    iterate: iterate$2,\n    getItem: getItem$2,\n    setItem: setItem$2,\n    removeItem: removeItem$2,\n    clear: clear$2,\n    length: length$2,\n    key: key$2,\n    keys: keys$2,\n    dropInstance: dropInstance$2\n};\n\nvar sameValue = function sameValue(x, y) {\n    return x === y || typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y);\n};\n\nvar includes = function includes(array, searchElement) {\n    var len = array.length;\n    var i = 0;\n    while (i < len) {\n        if (sameValue(array[i], searchElement)) {\n            return true;\n        }\n        i++;\n    }\n\n    return false;\n};\n\nvar isArray = Array.isArray || function (arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]';\n};\n\n// Drivers are stored here when `defineDriver()` is called.\n// They are shared across all instances of localForage.\nvar DefinedDrivers = {};\n\nvar DriverSupport = {};\n\nvar DefaultDrivers = {\n    INDEXEDDB: asyncStorage,\n    WEBSQL: webSQLStorage,\n    LOCALSTORAGE: localStorageWrapper\n};\n\nvar DefaultDriverOrder = [DefaultDrivers.INDEXEDDB._driver, DefaultDrivers.WEBSQL._driver, DefaultDrivers.LOCALSTORAGE._driver];\n\nvar OptionalDriverMethods = ['dropInstance'];\n\nvar LibraryMethods = ['clear', 'getItem', 'iterate', 'key', 'keys', 'length', 'removeItem', 'setItem'].concat(OptionalDriverMethods);\n\nvar DefaultConfig = {\n    description: '',\n    driver: DefaultDriverOrder.slice(),\n    name: 'localforage',\n    // Default DB size is _JUST UNDER_ 5MB, as it's the highest size\n    // we can use without a prompt.\n    size: 4980736,\n    storeName: 'keyvaluepairs',\n    version: 1.0\n};\n\nfunction callWhenReady(localForageInstance, libraryMethod) {\n    localForageInstance[libraryMethod] = function () {\n        var _args = arguments;\n        return localForageInstance.ready().then(function () {\n            return localForageInstance[libraryMethod].apply(localForageInstance, _args);\n        });\n    };\n}\n\nfunction extend() {\n    for (var i = 1; i < arguments.length; i++) {\n        var arg = arguments[i];\n\n        if (arg) {\n            for (var _key in arg) {\n                if (arg.hasOwnProperty(_key)) {\n                    if (isArray(arg[_key])) {\n                        arguments[0][_key] = arg[_key].slice();\n                    } else {\n                        arguments[0][_key] = arg[_key];\n                    }\n                }\n            }\n        }\n    }\n\n    return arguments[0];\n}\n\nvar LocalForage = function () {\n    function LocalForage(options) {\n        _classCallCheck(this, LocalForage);\n\n        for (var driverTypeKey in DefaultDrivers) {\n            if (DefaultDrivers.hasOwnProperty(driverTypeKey)) {\n                var driver = DefaultDrivers[driverTypeKey];\n                var driverName = driver._driver;\n                this[driverTypeKey] = driverName;\n\n                if (!DefinedDrivers[driverName]) {\n                    // we don't need to wait for the promise,\n                    // since the default drivers can be defined\n                    // in a blocking manner\n                    this.defineDriver(driver);\n                }\n            }\n        }\n\n        this._defaultConfig = extend({}, DefaultConfig);\n        this._config = extend({}, this._defaultConfig, options);\n        this._driverSet = null;\n        this._initDriver = null;\n        this._ready = false;\n        this._dbInfo = null;\n\n        this._wrapLibraryMethodsWithReady();\n        this.setDriver(this._config.driver)[\"catch\"](function () {});\n    }\n\n    // Set any config values for localForage; can be called anytime before\n    // the first API call (e.g. `getItem`, `setItem`).\n    // We loop through options so we don't overwrite existing config\n    // values.\n\n\n    LocalForage.prototype.config = function config(options) {\n        // If the options argument is an object, we use it to set values.\n        // Otherwise, we return either a specified config value or all\n        // config values.\n        if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object') {\n            // If localforage is ready and fully initialized, we can't set\n            // any new configuration values. Instead, we return an error.\n            if (this._ready) {\n                return new Error(\"Can't call config() after localforage \" + 'has been used.');\n            }\n\n            for (var i in options) {\n                if (i === 'storeName') {\n                    options[i] = options[i].replace(/\\W/g, '_');\n                }\n\n                if (i === 'version' && typeof options[i] !== 'number') {\n                    return new Error('Database version must be a number.');\n                }\n\n                this._config[i] = options[i];\n            }\n\n            // after all config options are set and\n            // the driver option is used, try setting it\n            if ('driver' in options && options.driver) {\n                return this.setDriver(this._config.driver);\n            }\n\n            return true;\n        } else if (typeof options === 'string') {\n            return this._config[options];\n        } else {\n            return this._config;\n        }\n    };\n\n    // Used to define a custom driver, shared across all instances of\n    // localForage.\n\n\n    LocalForage.prototype.defineDriver = function defineDriver(driverObject, callback, errorCallback) {\n        var promise = new Promise$1(function (resolve, reject) {\n            try {\n                var driverName = driverObject._driver;\n                var complianceError = new Error('Custom driver not compliant; see ' + 'https://mozilla.github.io/localForage/#definedriver');\n\n                // A driver name should be defined and not overlap with the\n                // library-defined, default drivers.\n                if (!driverObject._driver) {\n                    reject(complianceError);\n                    return;\n                }\n\n                var driverMethods = LibraryMethods.concat('_initStorage');\n                for (var i = 0, len = driverMethods.length; i < len; i++) {\n                    var driverMethodName = driverMethods[i];\n\n                    // when the property is there,\n                    // it should be a method even when optional\n                    var isRequired = !includes(OptionalDriverMethods, driverMethodName);\n                    if ((isRequired || driverObject[driverMethodName]) && typeof driverObject[driverMethodName] !== 'function') {\n                        reject(complianceError);\n                        return;\n                    }\n                }\n\n                var configureMissingMethods = function configureMissingMethods() {\n                    var methodNotImplementedFactory = function methodNotImplementedFactory(methodName) {\n                        return function () {\n                            var error = new Error('Method ' + methodName + ' is not implemented by the current driver');\n                            var promise = Promise$1.reject(error);\n                            executeCallback(promise, arguments[arguments.length - 1]);\n                            return promise;\n                        };\n                    };\n\n                    for (var _i = 0, _len = OptionalDriverMethods.length; _i < _len; _i++) {\n                        var optionalDriverMethod = OptionalDriverMethods[_i];\n                        if (!driverObject[optionalDriverMethod]) {\n                            driverObject[optionalDriverMethod] = methodNotImplementedFactory(optionalDriverMethod);\n                        }\n                    }\n                };\n\n                configureMissingMethods();\n\n                var setDriverSupport = function setDriverSupport(support) {\n                    if (DefinedDrivers[driverName]) {\n                        console.info('Redefining LocalForage driver: ' + driverName);\n                    }\n                    DefinedDrivers[driverName] = driverObject;\n                    DriverSupport[driverName] = support;\n                    // don't use a then, so that we can define\n                    // drivers that have simple _support methods\n                    // in a blocking manner\n                    resolve();\n                };\n\n                if ('_support' in driverObject) {\n                    if (driverObject._support && typeof driverObject._support === 'function') {\n                        driverObject._support().then(setDriverSupport, reject);\n                    } else {\n                        setDriverSupport(!!driverObject._support);\n                    }\n                } else {\n                    setDriverSupport(true);\n                }\n            } catch (e) {\n                reject(e);\n            }\n        });\n\n        executeTwoCallbacks(promise, callback, errorCallback);\n        return promise;\n    };\n\n    LocalForage.prototype.driver = function driver() {\n        return this._driver || null;\n    };\n\n    LocalForage.prototype.getDriver = function getDriver(driverName, callback, errorCallback) {\n        var getDriverPromise = DefinedDrivers[driverName] ? Promise$1.resolve(DefinedDrivers[driverName]) : Promise$1.reject(new Error('Driver not found.'));\n\n        executeTwoCallbacks(getDriverPromise, callback, errorCallback);\n        return getDriverPromise;\n    };\n\n    LocalForage.prototype.getSerializer = function getSerializer(callback) {\n        var serializerPromise = Promise$1.resolve(localforageSerializer);\n        executeTwoCallbacks(serializerPromise, callback);\n        return serializerPromise;\n    };\n\n    LocalForage.prototype.ready = function ready(callback) {\n        var self = this;\n\n        var promise = self._driverSet.then(function () {\n            if (self._ready === null) {\n                self._ready = self._initDriver();\n            }\n\n            return self._ready;\n        });\n\n        executeTwoCallbacks(promise, callback, callback);\n        return promise;\n    };\n\n    LocalForage.prototype.setDriver = function setDriver(drivers, callback, errorCallback) {\n        var self = this;\n\n        if (!isArray(drivers)) {\n            drivers = [drivers];\n        }\n\n        var supportedDrivers = this._getSupportedDrivers(drivers);\n\n        function setDriverToConfig() {\n            self._config.driver = self.driver();\n        }\n\n        function extendSelfWithDriver(driver) {\n            self._extend(driver);\n            setDriverToConfig();\n\n            self._ready = self._initStorage(self._config);\n            return self._ready;\n        }\n\n        function initDriver(supportedDrivers) {\n            return function () {\n                var currentDriverIndex = 0;\n\n                function driverPromiseLoop() {\n                    while (currentDriverIndex < supportedDrivers.length) {\n                        var driverName = supportedDrivers[currentDriverIndex];\n                        currentDriverIndex++;\n\n                        self._dbInfo = null;\n                        self._ready = null;\n\n                        return self.getDriver(driverName).then(extendSelfWithDriver)[\"catch\"](driverPromiseLoop);\n                    }\n\n                    setDriverToConfig();\n                    var error = new Error('No available storage method found.');\n                    self._driverSet = Promise$1.reject(error);\n                    return self._driverSet;\n                }\n\n                return driverPromiseLoop();\n            };\n        }\n\n        // There might be a driver initialization in progress\n        // so wait for it to finish in order to avoid a possible\n        // race condition to set _dbInfo\n        var oldDriverSetDone = this._driverSet !== null ? this._driverSet[\"catch\"](function () {\n            return Promise$1.resolve();\n        }) : Promise$1.resolve();\n\n        this._driverSet = oldDriverSetDone.then(function () {\n            var driverName = supportedDrivers[0];\n            self._dbInfo = null;\n            self._ready = null;\n\n            return self.getDriver(driverName).then(function (driver) {\n                self._driver = driver._driver;\n                setDriverToConfig();\n                self._wrapLibraryMethodsWithReady();\n                self._initDriver = initDriver(supportedDrivers);\n            });\n        })[\"catch\"](function () {\n            setDriverToConfig();\n            var error = new Error('No available storage method found.');\n            self._driverSet = Promise$1.reject(error);\n            return self._driverSet;\n        });\n\n        executeTwoCallbacks(this._driverSet, callback, errorCallback);\n        return this._driverSet;\n    };\n\n    LocalForage.prototype.supports = function supports(driverName) {\n        return !!DriverSupport[driverName];\n    };\n\n    LocalForage.prototype._extend = function _extend(libraryMethodsAndProperties) {\n        extend(this, libraryMethodsAndProperties);\n    };\n\n    LocalForage.prototype._getSupportedDrivers = function _getSupportedDrivers(drivers) {\n        var supportedDrivers = [];\n        for (var i = 0, len = drivers.length; i < len; i++) {\n            var driverName = drivers[i];\n            if (this.supports(driverName)) {\n                supportedDrivers.push(driverName);\n            }\n        }\n        return supportedDrivers;\n    };\n\n    LocalForage.prototype._wrapLibraryMethodsWithReady = function _wrapLibraryMethodsWithReady() {\n        // Add a stub for each driver API method that delays the call to the\n        // corresponding driver method until localForage is ready. These stubs\n        // will be replaced by the driver methods as soon as the driver is\n        // loaded, so there is no performance impact.\n        for (var i = 0, len = LibraryMethods.length; i < len; i++) {\n            callWhenReady(this, LibraryMethods[i]);\n        }\n    };\n\n    LocalForage.prototype.createInstance = function createInstance(options) {\n        return new LocalForage(options);\n    };\n\n    return LocalForage;\n}();\n\n// The actual localForage object that we expose as a module or via a\n// global. It's extended by pulling in one of our other libraries.\n\n\nvar localforage_js = new LocalForage();\n\nmodule.exports = localforage_js;\n\n},{\"3\":3}]},{},[4])(4)\n});\n","export const listenerKey: unique symbol = Symbol('listener');\nexport const listenKey: unique symbol = Symbol('listen');\nexport const senderKey: unique symbol = Symbol('sender');\nexport const requestsMapKey: unique symbol = Symbol('requestsMap');\nexport const listensMapKey: unique symbol = Symbol('listensMap');\nexport const serializerKey: unique symbol = Symbol('serializer');\nexport const logKey: unique symbol = Symbol('log');\nexport const verboseKey: unique symbol = Symbol('verbose');\nexport const originalListensMapKey: unique symbol =\n  Symbol('originalListensMap');\nexport const callbackKey: unique symbol = Symbol('callback');\nexport const timeoutKey: unique symbol = Symbol('timeout');\nexport const prefixKey: unique symbol = Symbol('prefix');\nexport const produceKey: unique symbol = Symbol('produce');\nexport const beforeEmitKey: unique symbol = Symbol('beforeEmit');\nexport const beforeEmitResolveKey: unique symbol = Symbol('beforeEmitResolve');\nexport const transportKey = '__DATA_TRANSPORT_UUID__';\nexport const transportType = {\n  request: 'request',\n  response: 'response',\n} as const;\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { v4 as uuid } from 'uuid';\n\nexport const detectSafari = () =>\n  /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\nexport const generateId = () =>\n  uuid({\n    // In nodejs, crypto.getRandomValues() not supported.\n    // workaround: https://github.com/uuidjs/uuid/issues/375\n    rng() {\n      const randomNumbers: number[] = new Array(16);\n      let r;\n      for (let i = 0; i < 16; i++) {\n        if ((i & 0x03) === 0) r = Math.random() * 0x100000000;\n        randomNumbers[i] = ((r as number) >>> ((i & 0x03) << 3)) & 0xff;\n      }\n      return randomNumbers;\n    },\n  });\n","import {\n  listenerKey,\n  originalListensMapKey,\n  requestsMapKey,\n  listensMapKey,\n  senderKey,\n  timeoutKey,\n  transportKey,\n  prefixKey,\n  transportType,\n  produceKey,\n  listenKey,\n  serializerKey,\n  logKey,\n  verboseKey,\n  beforeEmitKey,\n  beforeEmitResolveKey,\n} from './constant';\nimport type {\n  EmitOptions,\n  IRequest,\n  IResponse,\n  ListenerOptions,\n  Request,\n  ListensMap,\n  Response,\n  TransportOptions,\n  EmitParameter,\n  BaseInteraction,\n} from './interface';\nimport { generateId } from './utils';\n\nconst DEFAULT_TIMEOUT = 60 * 1000;\nconst DEFAULT_RESPOND = true;\nconst DEFAULT_SILENT = false;\nconst DEFAULT_PREFIX = 'DataTransport';\n\nexport const getAction = (prefix: string, name: string) =>\n  `${prefix}-${name.toString()}`;\nconst getListenName = (prefix: string, action: string) =>\n  action.replace(new RegExp(`^${prefix}-`), '');\n\n/**\n * Create a base transport\n */\nexport abstract class Transport<T extends BaseInteraction = any> {\n  private [listenerKey]: TransportOptions['listener'];\n  private [listenKey]: (options?: ListenerOptions) => void;\n  private [senderKey]: TransportOptions['sender'];\n  private [timeoutKey]: TransportOptions['timeout'];\n  private [prefixKey]: TransportOptions['prefix'];\n  private [serializerKey]: TransportOptions['serializer'];\n  private [requestsMapKey]: Map<string, (value: unknown) => void> = new Map();\n  private [listensMapKey]!: ListensMap;\n  private [originalListensMapKey]!: Map<string, Function>;\n  private [logKey]?: (listenOptions: ListenerOptions<any>) => void;\n  private [verboseKey]: boolean;\n  protected [beforeEmitKey]?: Promise<void>;\n  protected [beforeEmitResolveKey]?: () => void;\n  /**\n   * dispose transport\n   */\n  public dispose: () => any;\n\n  constructor({\n    listener,\n    sender,\n    timeout = DEFAULT_TIMEOUT,\n    verbose = false,\n    prefix = DEFAULT_PREFIX,\n    listenKeys = [],\n    checkListen = true,\n    serializer,\n    logger,\n  }: TransportOptions) {\n    this[listensMapKey] = this[listensMapKey] ?? new Map();\n    this[originalListensMapKey] = this[originalListensMapKey] ?? new Map();\n    this[listenerKey] = listener.bind(this);\n    this[senderKey] = sender.bind(this);\n    this[timeoutKey] = timeout;\n    this[prefixKey] = prefix;\n    this[serializerKey] = serializer;\n    this[verboseKey] = verbose;\n    this[logKey] = logger;\n\n    new Set(listenKeys).forEach((key) => {\n      const fn = (this as any as Record<string, Function>)[key];\n      if (__DEV__) {\n        if (typeof fn !== 'function') {\n          console.warn(`'${key}' is NOT a methods or function.`);\n        }\n      }\n      this[originalListensMapKey].set(key, fn);\n      Object.assign(this, {\n        [key]() {\n          if (__DEV__) {\n            throw new Error(\n              `The method '${key}' is a listen function that can NOT be actively called.`\n            );\n          }\n        },\n      });\n    });\n\n    this[originalListensMapKey].forEach((value, name) => {\n      this[produceKey](name, value);\n    });\n\n    this[listenKey] = (options?: ListenerOptions) => {\n      if (this[verboseKey]) {\n        if (typeof this[logKey] === 'function' && options) {\n          this[logKey]!(options);\n        } else {\n          console.info('DataTransport Receive: ', options);\n        }\n      }\n      if (options?.[transportKey]) {\n        const listenName = getListenName(this[prefixKey]!, options.action);\n        const hasListen = typeof (this as any)[listenName] === 'function';\n        if ((options as IResponse).type === transportType.response) {\n          const resolve = this[requestsMapKey].get(options[transportKey]);\n          if (resolve) {\n            const { response } = options as IResponse;\n            resolve(\n              typeof response === 'string' && this[serializerKey]?.parse\n                ? this[serializerKey]!.parse!(response)\n                : response\n            );\n          } else if (hasListen) {\n            if (__DEV__ && checkListen) {\n              console.warn(\n                `The type '${options.action}' event '${options[transportKey]}' has been resolved. Please check for a duplicate response.`\n              );\n            }\n          }\n        } else if ((options as IRequest).type === transportType.request) {\n          const respond = this[listensMapKey].get(options.action);\n          if (typeof respond === 'function') {\n            const { request } = options as IRequest;\n            respond(\n              typeof request === 'string' && this[serializerKey]?.parse\n                ? this[serializerKey]!.parse!(request)\n                : request,\n              {\n                ...options,\n                transportId: options[transportKey],\n                hasRespond: (options as IRequest).hasRespond,\n              }\n            );\n          } else if (hasListen) {\n            if (__DEV__ && checkListen) {\n              console.error(\n                `The listen method or function '${listenName}' is NOT decorated by decorator '@listen' or be added 'listenKeys' list.`\n              );\n            }\n          }\n        }\n      }\n    };\n\n    const dispose = this[listenerKey](this[listenKey]);\n\n    this.dispose = () => {\n      if (typeof dispose === 'function') {\n        this[requestsMapKey].clear();\n        this[listensMapKey].clear();\n        this[originalListensMapKey].clear();\n        return dispose();\n      } else if (__DEV__) {\n        console.warn(\n          `The return value of the the '${this.constructor.name}' transport's listener should be a 'dispose' function for removing the listener`\n        );\n      }\n    };\n  }\n\n  private [produceKey]<K extends string, P extends Record<string, Function>>(\n    name: K,\n    fn: P[K]\n  ) {\n    // https://github.com/microsoft/TypeScript/issues/40465\n    const action = getAction(this[prefixKey]!, name);\n    this[listensMapKey].set(\n      action,\n      async (request, { hasRespond, transportId, request: _, ...args }) => {\n        if (typeof fn === 'function') {\n          const response: Response<P[K]> = await fn.apply(this, request);\n          if (!hasRespond) return;\n          const data: IResponse = {\n            ...args,\n            action,\n            response: (typeof response !== 'undefined' &&\n            this[serializerKey]?.stringify\n              ? this[serializerKey]!.stringify!(response)\n              : response) as string | undefined,\n            hasRespond,\n            [transportKey]: transportId,\n            type: transportType.response,\n            responseId: this.id,\n          };\n          this[senderKey](data);\n        } else {\n          throw new Error(\n            `The listener for event ${name} should be a function.`\n          );\n        }\n      }\n    );\n  }\n\n  /**\n   * Listen an event that transport data.\n   *\n   * @param name A transport action as listen message data action type\n   * @param fn A transport listener\n   */\n  public listen<K extends keyof T['listen']>(name: K, fn: T['listen'][K]) {\n    if (typeof name === 'string') {\n      if (this[originalListensMapKey].get(name)) {\n        throw new Error(\n          `Failed to listen to the event \"${name}\", the event \"${name}\" is already listened to.`\n        );\n      }\n      if (typeof fn === 'function') {\n        this[originalListensMapKey].set(name, fn);\n        this[produceKey](name, fn);\n      } else {\n        throw new Error(`The listener for event ${name} should be a function.`);\n      }\n    } else {\n      throw new Error(\n        `The event name \"${name.toString()}\" is not a string, it should be a string.`\n      );\n    }\n    return () => {\n      this[originalListensMapKey].delete(name);\n      const action = getAction(this[prefixKey]!, name);\n      this[listensMapKey].delete(action);\n    };\n  }\n\n  public id = generateId();\n\n  /**\n   * Emit an event that transport data.\n   *\n   * @param emitOptions A option for the transport data\n   * @param request A request data\n   *\n   * @returns Return a response for the request.\n   */\n  public async emit<K extends keyof T['emit']>(\n    options: EmitOptions<K>,\n    ...request: Request<T['emit'][K]>\n  ): Promise<Response<T['emit'][K]>> {\n    const params =\n      typeof options === 'object' ? options : ({} as EmitParameter<K>);\n    const hasRespond = params.respond ?? DEFAULT_RESPOND;\n    const isSilent = params.silent ?? DEFAULT_SILENT;\n    const timeout = params.timeout ?? this[timeoutKey];\n    const name = params.name ?? options;\n    const transportId = generateId();\n    if (__DEV__ && (!name || typeof name !== 'string')) {\n      throw new Error(`The event name should be a string, and it's required.`);\n    }\n    const action = getAction(this[prefixKey]!, name as string);\n    const rawRequestData: IRequest = {\n      ...(params._extra ? { _extra: params._extra } : {}),\n      type: transportType.request,\n      action,\n      request: (typeof request !== 'undefined' && this[serializerKey]?.stringify\n        ? this[serializerKey]!.stringify!(request)\n        : request) as unknown[],\n      hasRespond,\n      [transportKey]: transportId,\n      requestId: this.id,\n    };\n    if (this[verboseKey]) {\n      if (typeof this[logKey] === 'function') {\n        this[logKey]!(rawRequestData);\n      } else {\n        console.info('DataTransport Send: ', rawRequestData);\n      }\n    }\n    if (!hasRespond) {\n      if (this[beforeEmitKey] && !params.skipBeforeEmit) {\n        await this[beforeEmitKey];\n      }\n      this[senderKey](rawRequestData);\n      return Promise.resolve(undefined as Response<T['emit'][K]>);\n    }\n    let timeoutId: NodeJS.Timeout | number;\n    const promise = Promise.race<any>([\n      new Promise(async (resolve) => {\n        if (this[beforeEmitKey] && !params.skipBeforeEmit) {\n          await this[beforeEmitKey];\n        }\n        this[requestsMapKey].set(transportId, resolve);\n        this[senderKey](rawRequestData);\n      }),\n      new Promise((_, reject) => {\n        timeoutId = setTimeout(() => {\n          reject();\n        }, timeout);\n      }),\n    ]);\n    return promise\n      .then((response) => {\n        // support Safari 10-11.1\n        clearTimeout(timeoutId as NodeJS.Timeout);\n        this[requestsMapKey].delete(transportId);\n        return response;\n      })\n      .catch((error) => {\n        clearTimeout(timeoutId as NodeJS.Timeout);\n        this[requestsMapKey].delete(transportId);\n        if (typeof error === 'undefined') {\n          if (isSilent) return;\n          console.warn(\n            `The event '${action}' timed out for ${timeout} seconds...`,\n            rawRequestData\n          );\n        } else {\n          if (__DEV__) {\n            throw error;\n          }\n        }\n      });\n  }\n}\n","import { beforeEmitKey, beforeEmitResolveKey } from '../constant';\nimport type {\n  BaseInteraction,\n  ListenerOptions,\n  TransportOptions,\n} from '../interface';\nimport { Transport } from '../transport';\n\nexport interface IFrameTransportInternalOptions\n  extends Partial<TransportOptions> {\n  /**\n   * Specify what the origin of targetWindow must be for the event to be dispatched,\n   * by default, it's the literal string \"*\" (indicating no preference).\n   */\n  targetOrigin?: string;\n  /**\n   * Whether skip connection check, false by default.\n   */\n  skipConnectionCheck?: boolean;\n}\n\nexport interface IFrameMainTransportOptions extends Partial<TransportOptions> {\n  /**\n   * Pass an iframe for using data transport.\n   */\n  iframe?: HTMLIFrameElement;\n  /**\n   * Specify what the origin of targetWindow must be for the event to be dispatched,\n   * by default, it's the literal string \"*\" (indicating no preference).\n   */\n  targetOrigin?: string;\n  /**\n   * Whether skip connection check, false by default.\n   */\n  skipConnectionCheck?: boolean;\n}\n\nconst connectEventName = 'iframe-connect';\n\nexport abstract class IFrameMainTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: IFrameMainTransportOptions) {\n    const {\n      iframe = document.querySelector('iframe'),\n      targetOrigin = '*',\n      listener = (callback) => {\n        const handler = ({ data, source }: MessageEvent<ListenerOptions>) => {\n          const contentWindow = iframe!.contentWindow;\n          if (contentWindow && contentWindow === (source as any)) {\n            return callback(data);\n          }\n        };\n        window.addEventListener('message', handler);\n        return () => {\n          window.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => {\n        if (iframe) {\n          iframe.contentWindow!.postMessage(message, targetOrigin);\n        } else if (window.frames[0]) {\n          window.frames[0].postMessage(message, targetOrigin);\n        } else {\n          console.error('The current page does not have any iframe elements');\n        }\n      },\n      skipConnectionCheck,\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n    if (!skipConnectionCheck) {\n      const connect = () => {\n        this.emit({\n          // @ts-ignore\n          name: connectEventName,\n          silent: true,\n          skipBeforeEmit: true,\n        }).then((connected) => {\n          if (connected) {\n            this[beforeEmitResolveKey]!();\n          }\n        });\n      };\n      connect();\n      this[beforeEmitKey] = new Promise((resolve) => {\n        this[beforeEmitResolveKey] = resolve;\n      });\n      // @ts-ignore\n      this.listen(connectEventName, async () => {\n        this[beforeEmitResolveKey]!();\n        return true;\n      });\n      // for iframe reload\n      iframe?.addEventListener('load', () => {\n        this[beforeEmitKey] = new Promise((resolve) => {\n          this[beforeEmitResolveKey] = resolve;\n        });\n        connect();\n      });\n    }\n  }\n}\n\nexport abstract class IFrameInternalTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: IFrameTransportInternalOptions = {}) {\n    const {\n      targetOrigin = '*',\n      listener = (callback) => {\n        const handler = ({ data }: MessageEvent<ListenerOptions>) =>\n          callback(data);\n        window.addEventListener('message', handler);\n        return () => {\n          window.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => window.parent.postMessage(message, targetOrigin),\n      skipConnectionCheck,\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n    if (!skipConnectionCheck) {\n      this.emit({\n        // @ts-ignore\n        name: connectEventName,\n        silent: true,\n      }).then((connected) => {\n        if (connected) {\n          this[beforeEmitResolveKey]!();\n        }\n      });\n      this[beforeEmitKey] = new Promise((resolve) => {\n        this[beforeEmitResolveKey] = resolve;\n      });\n      // @ts-ignore\n      this.listen(connectEventName, async () => {\n        this[beforeEmitResolveKey]!();\n        return true;\n      });\n    }\n  }\n}\n\nexport const IFrameTransport = {\n  Main: IFrameMainTransport,\n  IFrame: IFrameInternalTransport,\n};\n","import type {\n  TransportOptions,\n  TransferableWorker,\n  ListenerOptions,\n  BaseInteraction,\n} from '../interface';\nimport { Transport } from '../transport';\n\n// follow issue: https://github.com/microsoft/TypeScript/issues/20595\n// workaround: `tsc --skipLibCheck`.\ndeclare var self: WorkerGlobalScope;\n\ntype ClientCallback = () => void | Promise<void>;\n\nconst connectEventName = 'worker-connect';\n\nexport interface WorkerMainTransportOptions\n  extends Partial<TransportOptions<TransferableWorker>> {\n  /**\n   * Pass web worker using data transport.\n   */\n  worker: Worker;\n}\n\nexport interface WorkerInternalTransportOptions\n  extends Partial<TransportOptions<TransferableWorker>> {}\n\nexport abstract class WorkerMainTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: WorkerMainTransportOptions) {\n    const {\n      worker,\n      listener = (callback) => {\n        const handler = ({\n          data,\n        }: MessageEvent<ListenerOptions<TransferableWorker>>) => {\n          callback(data);\n        };\n        worker.addEventListener('message', handler);\n        return () => {\n          worker.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => {\n        const transfer = message.transfer ?? [];\n        delete message.transfer;\n        worker.postMessage(message, transfer);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n\n    this.emit({\n      // @ts-ignore\n      name: connectEventName,\n      respond: true,\n      silent: true,\n    }).then(this._handleConnectCallbacks);\n\n    // @ts-ignore\n    this.listen(connectEventName, this._handleConnectCallbacks);\n  }\n\n  private _connected = false;\n\n  private _handleConnectCallbacks = async () => {\n    if (this._connected) {\n      return;\n    }\n    this._connected = true;\n    this._onConnectCallback.forEach((callback) => {\n      callback();\n    });\n    this._onConnectCallback.clear();\n  };\n\n  private _onConnectCallback = new Set<ClientCallback>();\n\n  onConnect(callback: ClientCallback) {\n    if (this._connected) {\n      return callback();\n    }\n    this._onConnectCallback.add(callback);\n    return () => {\n      this._onConnectCallback.delete(callback);\n    };\n  }\n}\n\nexport abstract class WorkerInternalTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: WorkerInternalTransportOptions = {}) {\n    const {\n      listener = (callback) => {\n        const handler = (({ data }: MessageEvent<any>) => {\n          callback(data);\n        }) as EventListenerOrEventListenerObject;\n        self.addEventListener('message', handler);\n        return () => {\n          self.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => {\n        const transfer = message.transfer ?? [];\n        delete message.transfer;\n        postMessage(message, transfer);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n\n    this.emit({\n      // @ts-ignore\n      name: connectEventName,\n      respond: true,\n      silent: true,\n    }).then(this._handleConnectCallbacks);\n\n    // @ts-ignore\n    this.listen(connectEventName, this._handleConnectCallbacks);\n  }\n\n  private _handleConnectCallbacks = async () => {\n    if (this._connected) {\n      return;\n    }\n    this._connected = true;\n    this._onConnectCallback.forEach((callback) => {\n      callback();\n    });\n    this._onConnectCallback.clear();\n  };\n\n  private _connected = false;\n\n  private _onConnectCallback = new Set<ClientCallback>();\n\n  onConnect(callback: ClientCallback) {\n    if (this._connected) {\n      return callback();\n    }\n    this._onConnectCallback.add(callback);\n    return () => {\n      this._onConnectCallback.delete(callback);\n    };\n  }\n}\n\nexport const WorkerTransport = {\n  Main: WorkerMainTransport,\n  Worker: WorkerInternalTransport,\n};\n","import { callbackKey, prefixKey } from '../constant';\nimport { listen } from '../decorators';\nimport {\n  TransportOptions,\n  TransferableWorker,\n  ListenerOptions,\n  BaseInteraction,\n} from '../interface';\nimport { getAction, Transport } from '../transport';\n\ndeclare var self: SharedWorkerGlobalScope;\ninterface SharedWorkerPort extends TransferableWorker {\n  _port?: MessagePort;\n}\n\nexport interface SharedWorkerClientTransportOptions\n  extends Partial<TransportOptions<TransferableWorker>> {\n  /**\n   * Pass a shared worker instance for data transport.\n   */\n  worker: SharedWorker;\n}\n\ntype ClientCallback = () => void | Promise<void>;\ntype WorkerCallback = (clientId: string) => void | Promise<void>;\n\nconst connectEventName = 'sharedworker-connect';\nconst disconnectEventName = 'sharedworker-disconnect';\n\nexport interface SharedWorkerInternalTransportOptions\n  extends Partial<TransportOptions<SharedWorkerPort>> {}\n\nexport abstract class SharedWorkerClientTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: SharedWorkerClientTransportOptions) {\n    const {\n      worker,\n      listener = (callback) => {\n        const handler = ({\n          data,\n        }: MessageEvent<ListenerOptions<TransferableWorker>>) => {\n          callback(data);\n        };\n        worker.port.addEventListener('message', handler);\n        worker.port.start();\n        return () => {\n          worker.port.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => {\n        const transfer = message.transfer ?? [];\n        delete message.transfer;\n        worker.port.postMessage(message, transfer);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n    // do not use `unload` event\n    // https://developer.chrome.com/docs/web-platform/deprecating-unload\n    window.addEventListener('pagehide', () => {\n      // @ts-ignore\n      this.emit({ name: disconnectEventName, respond: false }, this.id);\n    });\n    // @ts-ignore\n    this.listen(connectEventName, async () => {\n      Promise.resolve().then(() => {\n        this._handleConnect();\n      });\n      return this.id;\n    });\n    // ensure the connect event is sent when the client connect to the worker\n    // @ts-ignore\n    this.emit({ name: connectEventName, respond: false, silent: true });\n  }\n\n  private _handleConnect() {\n    if (this._connected) return;\n    this._connected = true;\n    this._onConnectCallback.forEach((callback) => {\n      callback();\n    });\n  }\n\n  private _connected = false;\n\n  private _onConnectCallback = new Set<ClientCallback>();\n\n  onConnect(callback: ClientCallback) {\n    this._onConnectCallback.add(callback);\n    return () => {\n      this._onConnectCallback.delete(callback);\n    };\n  }\n}\n\ninterface SharedWorkerTransportPort extends MessagePort {\n  _handler?: (options: MessageEvent<ListenerOptions<SharedWorkerPort>>) => void;\n}\n\nexport abstract class SharedWorkerInternalTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  protected ports = new Map<string, MessagePort>();\n  protected tempPorts = new Set<MessagePort>();\n  private [callbackKey]!: (options: ListenerOptions<SharedWorkerPort>) => void;\n\n  constructor(_options: SharedWorkerInternalTransportOptions = {}) {\n    const {\n      listener = function (this: SharedWorkerInternalTransport, callback) {\n        this[callbackKey] = callback;\n        return () => {\n          this.ports.forEach((port: SharedWorkerTransportPort) => {\n            port._handler && port.removeEventListener('message', port._handler);\n            delete port._handler;\n          });\n          self.close();\n        };\n      },\n      sender = (message) => {\n        const transfer = message.transfer ?? [];\n        delete message.transfer;\n        const port = message._extra?._port;\n        // pick a client port for sender.\n        if (port) {\n          delete message._extra!._port;\n          port.postMessage(message, transfer);\n        } else if (\n          message.type === 'response' &&\n          // @ts-ignore\n          this.ports.has(message.requestId)\n        ) {\n          // @ts-ignore\n          const port = this.ports.get(message.requestId)!;\n          port.postMessage(message, transfer);\n        } else {\n          this.ports.forEach((port) => {\n            try {\n              port.postMessage(message, transfer);\n            } catch (error) {\n              console.error(error);\n            }\n          });\n          this.tempPorts.forEach((port) => {\n            try {\n              port.postMessage(message, transfer);\n            } catch (error) {\n              console.error(error);\n            }\n          });\n        }\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n\n    const disconnectAction = getAction(this[prefixKey]!, disconnectEventName);\n    const connectEvent = getAction(this[prefixKey]!, connectEventName);\n    self.addEventListener('connect', async (e) => {\n      const port: SharedWorkerTransportPort = e.ports[0];\n      port._handler = ({\n        data,\n      }: MessageEvent<ListenerOptions<SharedWorkerPort>>) => {\n        if (data.hasRespond) {\n          data._extra = data._extra ?? {};\n          data._extra._port = port;\n        }\n        if (\n          data.action === disconnectAction &&\n          this.ports.has(data.requestId)\n        ) {\n          // clear port and clientId when the port's client is disconnected.\n          this.ports.delete(data.requestId);\n          this._onDisconnectCallback.forEach((callback) => {\n            callback(data.requestId);\n          });\n        }\n        if (data.type === 'request' && data.action === connectEvent) {\n          this.emit({\n            // @ts-ignore\n            name: connectEventName,\n            _extra: { _port: port },\n            silent: true,\n            respond: false,\n          });\n          this._handleConnect(data.requestId, port);\n        }\n        this[callbackKey](data);\n      };\n      port.addEventListener('message', port._handler);\n      port.start();\n      this.tempPorts.add(port);\n      try {\n        // because parameters is unknown\n        // @ts-ignore\n        const id: string = await this.emit({\n          // @ts-ignore\n          name: connectEventName,\n          _extra: { _port: port },\n          silent: true,\n        });\n        this._handleConnect(id, port);\n      } catch (err) {\n        this.tempPorts.delete(port);\n        console.error(err);\n      }\n    });\n  }\n\n  private _onConnectCallback = new Set<WorkerCallback>();\n\n  onConnect(callback: WorkerCallback) {\n    this._onConnectCallback.add(callback);\n    return () => {\n      this._onConnectCallback.delete(callback);\n    };\n  }\n\n  private _handleConnect(id: string, port: MessagePort) {\n    if (id && !this.ports.has(id)) {\n      this.ports.set(id, port);\n      this.tempPorts.delete(port);\n      this._onConnectCallback.forEach((callback) => {\n        callback(id);\n      });\n    }\n  }\n\n  private _onDisconnectCallback = new Set<WorkerCallback>();\n\n  onDisconnect(callback: WorkerCallback) {\n    this._onDisconnectCallback.add(callback);\n    return () => {\n      this._onDisconnectCallback.delete(callback);\n    };\n  }\n}\n\nexport const SharedWorkerTransport = {\n  Client: SharedWorkerClientTransport,\n  Worker: SharedWorkerInternalTransport,\n};\n","import {\n  TransportOptions,\n  TransferableWorker,\n  ListenerOptions,\n  BaseInteraction,\n} from '../interface';\nimport { Transport } from '../transport';\nimport { detectSafari } from '../utils';\n\n// follow issue: https://github.com/microsoft/TypeScript/issues/20595\n// workaround: `tsc --skipLibCheck`.\ndeclare var self: ServiceWorkerGlobalScope;\n\ninterface ServiceWorkerClientId extends TransferableWorker {\n  _clientId?: string;\n}\n\nexport interface ServiceWorkerClientTransportOptions\n  extends Partial<TransportOptions<TransferableWorker>> {\n  /**\n   * A service worker instance for data transport.\n   */\n  worker: ServiceWorker;\n  /**\n   * Compatibility with unstable serialization in Safari\n   */\n  useOnSafari?: boolean;\n}\n\nexport interface ServiceWorkerServiceTransportOptions\n  extends Partial<TransportOptions<ServiceWorkerClientId>> {\n  /**\n   * Compatibility with unstable serialization in Safari\n   */\n  useOnSafari?: boolean;\n}\n\nconst DEFAULT_USE_ON_SAFARI = true;\n\nconst decode = (data: any, useOnSafari: boolean) => {\n  try {\n    return useOnSafari && detectSafari() ? JSON.stringify(data) : data;\n  } catch (e) {\n    console.error(`Failed to stringify:`, data);\n    throw e;\n  }\n};\n\nconst encode = (data: any, useOnSafari: boolean) => {\n  try {\n    return typeof data === 'string' && useOnSafari && detectSafari()\n      ? JSON.parse(data as any)\n      : data;\n  } catch (e) {\n    console.error(`Failed to parse:`, data);\n  }\n  return data;\n};\n\nexport abstract class ServiceWorkerClientTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: ServiceWorkerClientTransportOptions) {\n    const {\n      worker,\n      useOnSafari = DEFAULT_USE_ON_SAFARI,\n      listener = (callback) => {\n        const handler = ({\n          data,\n        }: MessageEvent<ListenerOptions<TransferableWorker>>) => {\n          callback(encode(data, useOnSafari));\n        };\n        navigator.serviceWorker.addEventListener('message', handler);\n        return () => {\n          navigator.serviceWorker.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => {\n        const transfer = message.transfer ?? [];\n        delete message.transfer;\n        worker.postMessage(message, transfer);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nexport abstract class ServiceWorkerServiceTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: ServiceWorkerServiceTransportOptions = {}) {\n    const {\n      useOnSafari = DEFAULT_USE_ON_SAFARI,\n      listener = (callback) => {\n        const handler = ({ data, source }: ExtendableMessageEvent) => {\n          data._clientId = (source as Client).id as string;\n          callback(data);\n        };\n        self.addEventListener('message', handler);\n        return () => self.removeEventListener('message', handler);\n      },\n      sender = async (message) => {\n        const transfer = message.transfer || [];\n        delete message.transfer;\n        const data = decode(message, useOnSafari);\n        if (message._clientId) {\n          const client = await self.clients.get(message._clientId);\n          if (!client) {\n            console.warn(`The client \"${message._clientId}\" is closed.`);\n            return;\n          }\n          delete message._clientId;\n          client.postMessage(data, transfer);\n          return;\n        }\n\n        const client = message._extra?._client;\n        if (client) {\n          delete message._extra!._client;\n          client.postMessage(data, transfer);\n          return;\n        }\n        self.clients\n          .matchAll()\n          .then((all) =>\n            all.map((client) => client.postMessage(data, transfer))\n          );\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n    self.addEventListener('activate', (event) => {\n      event.waitUntil(self.clients.claim());\n    });\n  }\n}\n\nexport const ServiceWorkerTransport = {\n  Client: ServiceWorkerClientTransport,\n  Service: ServiceWorkerServiceTransport,\n};\n","import type {\n  BaseInteraction,\n  ListenerOptions,\n  TransportOptions,\n} from '../interface';\nimport { Transport } from '../transport';\n\nconst defaultChannel = '$$BroadcastChannel_Transport$$';\n\nexport interface BroadcastTransportOptions extends Partial<TransportOptions> {\n  /**\n   * Specify a broadcast channel name.\n   */\n  channel?: string;\n  /**\n   * Specify a broadcast channel instance.\n   */\n  broadcastChannel?: BroadcastChannel;\n}\n\nabstract class BroadcastTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: BroadcastTransportOptions = {}) {\n    const {\n      channel = defaultChannel,\n      broadcastChannel = new BroadcastChannel(channel),\n      listener = (callback) => {\n        const handler = ({ data }: MessageEvent<ListenerOptions>) => {\n          callback(data);\n        };\n        broadcastChannel.addEventListener('message', handler);\n        return () => {\n          broadcastChannel.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => broadcastChannel.postMessage(message),\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nexport { BroadcastTransport };\n","import type { BrowserWindow, IpcMain, IpcRenderer } from 'electron';\nimport type {\n  BaseInteraction,\n  ListenerOptions,\n  TransportOptions,\n} from '../interface';\nimport { Transport } from '../transport';\n\nconst defaultChannel = '$$Electron_Transport$$';\n\ninterface ElectronTransportOptions extends Partial<TransportOptions> {\n  /**\n   * Specify a Electron channel name.\n   */\n  channel?: string;\n}\n\nexport interface ElectronMainTransportOptions extends ElectronTransportOptions {\n  /**\n   * Specify a browser windows created by the Electron main process.\n   */\n  browserWindow: BrowserWindow;\n  /**\n   * Communicate asynchronously from the main process to renderer processes.\n   */\n  ipcMain: IpcMain;\n}\n\nexport interface ElectronRendererTransportOptions\n  extends ElectronTransportOptions {\n  /**\n   * Communicate asynchronously from a renderer process to the main process.\n   */\n  ipcRenderer: IpcRenderer;\n}\n\nexport abstract class ElectronMainTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: ElectronMainTransportOptions) {\n    const {\n      ipcMain,\n      browserWindow,\n      channel = defaultChannel,\n      listener = (callback) => {\n        const handler = (_: Electron.IpcMainEvent, data: ListenerOptions) => {\n          callback(data);\n        };\n        ipcMain.on(channel, handler);\n        return () => {\n          ipcMain.off(channel, handler);\n        };\n      },\n      sender = (message) => browserWindow.webContents.send(channel, message),\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nexport abstract class ElectronRendererTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: ElectronRendererTransportOptions) {\n    const {\n      ipcRenderer,\n      channel = defaultChannel,\n      listener = (callback) => {\n        const handler = (\n          _: Electron.IpcRendererEvent,\n          data: ListenerOptions\n        ) => {\n          callback(data);\n        };\n        ipcRenderer.on(channel, handler);\n        return () => {\n          ipcRenderer.off(channel, handler);\n        };\n      },\n      sender = (message) => ipcRenderer.send(channel, message),\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nexport const ElectronTransport = {\n  Main: ElectronMainTransport,\n  Renderer: ElectronRendererTransport,\n};\n","type GlobalThis = typeof globalThis;\n\nconst getGlobal = () => {\n  let _global: GlobalThis;\n  if (typeof window !== 'undefined') {\n    _global = window;\n  } else if (typeof global !== 'undefined') {\n    _global = global as GlobalThis;\n  } else if (typeof self !== 'undefined') {\n    _global = self;\n  } else {\n    _global = {} as GlobalThis;\n  }\n  return _global;\n};\n\nexport const global = getGlobal();\n","import { callbackKey } from '../constant';\nimport { global } from '../global';\nimport type {\n  BaseInteraction,\n  IRequest,\n  ListenerOptions,\n  SendOptions,\n  TransportOptions,\n} from '../interface';\nimport { Transport } from '../transport';\n\nconst transportName = '__DATA_TRANSPORT_BROWSER_EXTENSIONS__';\n\ntype Browser = typeof global.browser | typeof global.chrome;\n\ntype Port = browser.runtime.Port | chrome.runtime.Port;\n\ninterface SendResponse {\n  _sendResponse?: (response?: SendOptions<SendResponse>) => void;\n}\n\nexport interface BrowserExtensionsGenericTransportOptions\n  extends Partial<TransportOptions<SendResponse>> {\n  /**\n   * browser extension API.\n   */\n  browser?: Browser;\n}\n\nexport interface BrowserExtensionsMainTransportOptions\n  extends Partial<TransportOptions<BrowserExtensionsMainPort>> {\n  /**\n   * browser extension API.\n   */\n  browser?: Browser;\n}\n\nexport interface BrowserExtensionsClientTransportOptions\n  extends Partial<TransportOptions> {\n  /**\n   * browser extension API.\n   */\n  browser?: Browser;\n  /**\n   * browser extension client port.\n   */\n  port?: Port;\n}\n\ninterface BrowserExtensionsMainPort {\n  _port?: Port;\n}\n\ntype ClientCallback = () => void | Promise<void>;\ntype MainCallback = (clientId: string) => void | Promise<void>;\n\nexport abstract class BrowserExtensionsGenericTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  private [callbackKey]!: (options: ListenerOptions<SendResponse>) => void;\n\n  constructor(_options: BrowserExtensionsGenericTransportOptions = {}) {\n    const {\n      browser = global.browser ?? global.chrome,\n      listener = function (this: BrowserExtensionsGenericTransport, callback) {\n        this[callbackKey] = callback;\n        const handler = (\n          data: ListenerOptions<SendResponse>,\n          sender: browser.runtime.MessageSender | chrome.runtime.MessageSender,\n          sendResponse: (response?: SendOptions<SendResponse>) => void\n        ) => {\n          data._sendResponse = sendResponse;\n          callback(data);\n          // https://developer.chrome.com/docs/extensions/develop/concepts/messaging#simple\n          // support async callback\n          return true;\n        };\n        browser.runtime.onMessage.addListener(handler);\n        return () => {\n          browser.runtime.onMessage.removeListener(handler);\n        };\n      },\n      sender = function (this: BrowserExtensionsGenericTransport, message) {\n        if (message._sendResponse) {\n          const sendResponse = message._sendResponse;\n          delete message._sendResponse;\n          sendResponse(message);\n        } else {\n          // @ts-ignore\n          browser.runtime.sendMessage(\n            message,\n            {},\n            this[callbackKey] as (response: IRequest<SendResponse>) => void\n          );\n        }\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nconst connectEventName = 'sharedworker-connect';\n\nexport abstract class BrowserExtensionsMainTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  protected ports = new Map<string, Port>();\n\n  private [callbackKey]!: (\n    options: ListenerOptions<BrowserExtensionsMainPort>\n  ) => void;\n\n  constructor(_options: BrowserExtensionsMainTransportOptions = {}) {\n    const {\n      browser = global.browser ?? global.chrome,\n      listener = function (this: BrowserExtensionsMainTransport, callback) {\n        this[callbackKey] = callback;\n        return () => {\n          this.ports.forEach((port) => {\n            port.disconnect();\n          });\n        };\n      },\n      sender = function (this: BrowserExtensionsMainTransport, message) {\n        const port = message._extra?._port;\n        if (port) {\n          delete message._port;\n          port.postMessage(message);\n        } else if (\n          message.type === 'response' &&\n          // @ts-ignore\n          this.ports.has(message.requestId)\n        ) {\n          // @ts-ignore\n          const port = this.ports.get(message.requestId)!;\n          port.postMessage(message);\n        } else {\n          this.ports.forEach((port) => {\n            try {\n              port.postMessage(message);\n            } catch (error) {\n              console.error(error);\n            }\n          });\n        }\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n    browser.runtime.onConnect.addListener(async (port: Port) => {\n      if (port.name === transportName) {\n        const handler = (data: any) => {\n          data._extra = data._extra ?? {};\n          data._extra._port = port;\n          this[callbackKey](data as ListenerOptions<BrowserExtensionsMainPort>);\n        };\n        port.onMessage.addListener(handler);\n        port.onDisconnect.addListener(() => {\n          port.onMessage.removeListener(handler);\n          this.ports.forEach((_port, id) => {\n            if (_port === port) {\n              this.ports.delete(id);\n            }\n          });\n          this._onDisconnectCallback.forEach((callback) => {\n            callback(id);\n          });\n        });\n\n        // @ts-ignore\n        const id: string = await this.emit({\n          // @ts-ignore\n          name: connectEventName,\n          _extra: { _port: port },\n        });\n        this.ports.set(id, port);\n        this._onConnectCallback.forEach((callback) => {\n          callback(id);\n        });\n      }\n    });\n  }\n\n  private _onConnectCallback = new Set<MainCallback>();\n\n  onConnect(callback: MainCallback) {\n    this._onConnectCallback.add(callback);\n    return () => {\n      this._onConnectCallback.delete(callback);\n    };\n  }\n\n  private _onDisconnectCallback = new Set<MainCallback>();\n\n  onDisconnect(callback: MainCallback) {\n    this._onDisconnectCallback.add(callback);\n    return () => {\n      this._onDisconnectCallback.delete(callback);\n    };\n  }\n}\n\nexport abstract class BrowserExtensionsClientTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: BrowserExtensionsClientTransportOptions = {}) {\n    const {\n      browser = global.browser ?? global.chrome,\n      port = browser.runtime.connect({ name: transportName }),\n      listener = (callback) => {\n        const handler = (options: object) => {\n          callback(options as ListenerOptions<{}>);\n        };\n        port.onMessage.addListener(handler);\n        return () => {\n          port.onMessage.removeListener(handler);\n        };\n      },\n      sender = (message) => {\n        port.postMessage(message);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n    // @ts-ignore\n    this.listen(connectEventName, async () => {\n      Promise.resolve().then(() => {\n        this._onConnectCallback.forEach((callback) => {\n          callback();\n        });\n      });\n      return this.id;\n    });\n  }\n\n  private _onConnectCallback = new Set<ClientCallback>();\n\n  onConnect(callback: ClientCallback) {\n    this._onConnectCallback.add(callback);\n    return () => {\n      this._onConnectCallback.delete(callback);\n    };\n  }\n}\n\nexport const BrowserExtensionsTransport = {\n  Main: BrowserExtensionsMainTransport,\n  Client: BrowserExtensionsClientTransport,\n};\n","import type { Instance } from 'simple-peer';\nimport type {\n  BaseInteraction,\n  ListenerOptions,\n  SendOptions,\n  TransportOptions,\n} from '../interface';\nimport { Transport } from '../transport';\n\nconst MAX_CHUNK_SIZE = 1024 * 60;\n\nconst BUFFER_FULL_THRESHOLD = 1024 * 64;\n\nconst EXPIRED_TIME = 1000 * 60;\n\nexport interface WebRTCTransportOptions extends Partial<TransportOptions> {\n  peer: Instance;\n}\n\ninterface WebRTCTransportSendOptions extends SendOptions<{}> {\n  chunkId?: number;\n  length?: number;\n}\n\nabstract class WebRTCTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  private receiveBuffer = new Map<string, { data: any[]; timestamp: number }>();\n\n  constructor(_options: WebRTCTransportOptions) {\n    const {\n      peer,\n      listener = (callback) => {\n        const handler = (data: string) => {\n          const message: WebRTCTransportSendOptions = JSON.parse(data);\n          const key = Object.prototype.hasOwnProperty.call(message, 'request')\n            ? 'request'\n            : 'response';\n          const buffer = this.receiveBuffer.get(\n            message.__DATA_TRANSPORT_UUID__\n          ) ?? {\n            data: [],\n            timestamp: Date.now(),\n          };\n          this.receiveBuffer.set(message.__DATA_TRANSPORT_UUID__, buffer);\n          buffer.data[message.chunkId!] = message[key];\n          buffer.data.length = message.length!;\n          buffer.timestamp = Date.now();\n          const isComplete =\n            buffer.data.filter((item) => item).length === message.length;\n          if (isComplete) {\n            const data = JSON.parse(buffer.data.join(''));\n            message[key] = key === 'request' ? data : data[0];\n            delete message.length;\n            callback(message as ListenerOptions);\n            this.receiveBuffer.delete(message.__DATA_TRANSPORT_UUID__);\n            for (const [id, item] of this.receiveBuffer) {\n              if (Date.now() - item.timestamp > EXPIRED_TIME) {\n                this.receiveBuffer.delete(id);\n              }\n            }\n          }\n        };\n        peer.on('data', handler);\n        return () => {\n          peer.off('data', handler);\n        };\n      },\n      sender = (message: WebRTCTransportSendOptions) => {\n        const key = Object.prototype.hasOwnProperty.call(message, 'request')\n          ? 'request'\n          : 'response';\n        message[key] = JSON.stringify(\n          key === 'request'\n            ? message.request\n            : typeof message.response !== 'undefined'\n            ? [message.response]\n            : []\n        );\n        let chunkId = 0;\n        const allChunksSize = Math.ceil(\n          (message[key] as string).length / MAX_CHUNK_SIZE\n        );\n        while ((message[key] as string).length > 0) {\n          const data = {\n            ...message,\n            [key]: (message[key] as string).slice(0, MAX_CHUNK_SIZE),\n            chunkId,\n            length: allChunksSize,\n          };\n          peer.send(JSON.stringify(data));\n          message[key] = (message[key] as string).slice(MAX_CHUNK_SIZE);\n          chunkId += 1;\n        }\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n    if (peer) {\n      let webRTCPaused = false;\n      const webRTCMessageQueue: any[] = [];\n      const peerSend = peer.send.bind(peer);\n      const sendMessageQueued = () => {\n        webRTCPaused = false;\n        let message = webRTCMessageQueue.shift();\n        while (message) {\n          if (\n            (peer as any)._channel.bufferedAmount &&\n            (peer as any)._channel.bufferedAmount > BUFFER_FULL_THRESHOLD\n          ) {\n            webRTCPaused = true;\n            webRTCMessageQueue.unshift(message);\n            const listener = () => {\n              (peer as any)._channel.removeEventListener(\n                'bufferedamountlow',\n                listener\n              );\n              sendMessageQueued();\n            };\n            (peer as any)._channel.addEventListener(\n              'bufferedamountlow',\n              listener\n            );\n            return;\n          }\n          try {\n            peerSend(message);\n            message = webRTCMessageQueue.shift();\n          } catch (error: any) {\n            throw new Error(`Error send message to peer: ${error.message}`);\n          }\n        }\n      };\n      peer.send = function (chunk: any) {\n        webRTCMessageQueue.push(chunk);\n        if (webRTCPaused) {\n          return;\n        }\n        sendMessageQueued();\n      };\n    }\n  }\n}\n\nexport { WebRTCTransport };\n","import type {\n  BaseInteraction,\n  ListenerOptions,\n  TransportOptions,\n} from '../interface';\nimport { Transport } from '../transport';\n\nexport interface MessageTransportOptions extends Partial<TransportOptions> {\n  /**\n   * Specify what the origin of targetWindow must be for the event to be dispatched,\n   * by default, it's the literal string \"*\" (indicating no preference).\n   */\n  targetOrigin?: string;\n}\n\nabstract class MessageTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: MessageTransportOptions) {\n    const {\n      targetOrigin = '*',\n      listener = (callback) => {\n        const handler = ({ data }: MessageEvent<ListenerOptions>) =>\n          callback(data);\n        window.addEventListener('message', handler);\n        return () => {\n          window.removeEventListener('message', handler);\n        };\n      },\n      sender = (message) => {\n        window.postMessage(message, targetOrigin);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nexport { MessageTransport };\n","import type { ChildProcess } from 'child_process';\nimport type {\n  BaseInteraction,\n  ListenerOptions,\n  TransportOptions,\n} from '../interface';\nimport { Transport } from '../transport';\n\nexport interface MainProcessTransportOptions extends Partial<TransportOptions> {\n  child: ChildProcess;\n}\n\nexport class MainProcessTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: MainProcessTransportOptions) {\n    const {\n      child,\n      listener = (callback) => {\n        const handler = (data: ListenerOptions) => {\n          callback(data);\n        };\n        child.on('message', handler);\n        return () => {\n          child.off('message', handler);\n        };\n      },\n      sender = (message) => {\n        child.send(message);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nexport interface ChildProcessTransportOptions\n  extends Partial<TransportOptions> {\n  //\n}\n\nexport class ChildProcessTransport<\n  T extends BaseInteraction = any\n> extends Transport<T> {\n  constructor(_options: ChildProcessTransportOptions = {}) {\n    const {\n      listener = (callback) => {\n        const handler = (data: ListenerOptions) => {\n          callback(data);\n        };\n        process.on('message', handler);\n        return () => {\n          process.off('message', handler);\n        };\n      },\n      sender = (message) => {\n        // @ts-ignore\n        process.send(message);\n      },\n      ...options\n    } = _options;\n    super({\n      ...options,\n      listener,\n      sender,\n    });\n  }\n}\n\nexport const ProcessTransport = {\n  Main: MainProcessTransport,\n  Child: ChildProcessTransport,\n};\n","import {\n  IFrameTransport,\n  IFrameMainTransportOptions,\n  IFrameTransportInternalOptions,\n  ElectronTransport,\n  ElectronMainTransportOptions,\n  ElectronRendererTransportOptions,\n  ServiceWorkerTransport,\n  ServiceWorkerClientTransportOptions,\n  ServiceWorkerServiceTransportOptions,\n  WorkerTransport,\n  WorkerMainTransportOptions,\n  WorkerInternalTransportOptions,\n  WebRTCTransport,\n  WebRTCTransportOptions,\n  BroadcastTransport,\n  BroadcastTransportOptions,\n  BrowserExtensionsTransport,\n  BrowserExtensionsMainTransport,\n  BrowserExtensionsMainTransportOptions,\n  BrowserExtensionsClientTransport,\n  BrowserExtensionsClientTransportOptions,\n  BrowserExtensionsGenericTransport,\n  BrowserExtensionsGenericTransportOptions,\n  SharedWorkerTransport,\n  SharedWorkerInternalTransportOptions,\n  SharedWorkerClientTransportOptions,\n  MessageTransport,\n  MessageTransportOptions,\n  IFrameMainTransport,\n  IFrameInternalTransport,\n  ElectronMainTransport,\n  ElectronRendererTransport,\n  ServiceWorkerClientTransport,\n  ServiceWorkerServiceTransport,\n  WorkerInternalTransport,\n  WorkerMainTransport,\n  SharedWorkerClientTransport,\n  SharedWorkerInternalTransport,\n  ProcessTransport,\n  MainProcessTransport,\n  ChildProcessTransport,\n  MainProcessTransportOptions,\n  ChildProcessTransportOptions,\n} from './transports';\nimport { Transport } from './transport';\nimport type { TransportOptions } from './interface';\n\nexport interface TransportOptionsMap {\n  IFrameMain: IFrameMainTransportOptions;\n  IFrameInternal: IFrameTransportInternalOptions;\n  BrowserExtensions: BrowserExtensionsGenericTransportOptions;\n  BrowserExtensionsMain: BrowserExtensionsMainTransportOptions;\n  BrowserExtensionsClient: BrowserExtensionsClientTransportOptions;\n  ElectronMain: ElectronMainTransportOptions;\n  ElectronRenderer: ElectronRendererTransportOptions;\n  ServiceWorkerClient: ServiceWorkerClientTransportOptions;\n  ServiceWorkerService: ServiceWorkerServiceTransportOptions;\n  WebWorkerClient: WorkerMainTransportOptions;\n  WebWorkerInternal: WorkerInternalTransportOptions;\n  WebRTC: WebRTCTransportOptions;\n  Broadcast: BroadcastTransportOptions;\n  SharedWorkerClient: SharedWorkerClientTransportOptions;\n  SharedWorkerInternal: SharedWorkerInternalTransportOptions;\n  Base: TransportOptions;\n  MessageTransport: MessageTransportOptions;\n  MainProcess: MainProcessTransportOptions;\n  ChildProcess: ChildProcessTransportOptions;\n}\n\nexport interface Transports {\n  Base: Transport;\n  MessageTransport: MessageTransport;\n  IFrameMain: IFrameMainTransport;\n  IFrameInternal: IFrameInternalTransport;\n  SharedWorkerClient: SharedWorkerClientTransport;\n  SharedWorkerInternal: SharedWorkerInternalTransport;\n  ServiceWorkerClient: ServiceWorkerClientTransport;\n  ServiceWorkerService: ServiceWorkerServiceTransport;\n  WebWorkerClient: WorkerMainTransport;\n  WebWorkerInternal: WorkerInternalTransport;\n  BrowserExtensions: BrowserExtensionsGenericTransport;\n  BrowserExtensionsMain: BrowserExtensionsMainTransport;\n  BrowserExtensionsClient: BrowserExtensionsClientTransport;\n  ElectronMain: ElectronMainTransport;\n  ElectronRenderer: ElectronRendererTransport;\n  WebRTC: WebRTCTransport;\n  Broadcast: BroadcastTransport;\n  MainProcess: MainProcessTransport;\n  ChildProcess: ChildProcessTransport;\n}\n\nexport const TransportMap = {\n  Base: Transport,\n  MessageTransport: MessageTransport,\n  IFrameMain: IFrameTransport.Main,\n  IFrameInternal: IFrameTransport.IFrame,\n  BrowserExtensions: BrowserExtensionsGenericTransport,\n  BrowserExtensionsMain: BrowserExtensionsTransport.Main,\n  BrowserExtensionsClient: BrowserExtensionsTransport.Client,\n  ElectronMain: ElectronTransport.Main,\n  ElectronRenderer: ElectronTransport.Renderer,\n  ServiceWorkerClient: ServiceWorkerTransport.Client,\n  ServiceWorkerService: ServiceWorkerTransport.Service,\n  WebWorkerClient: WorkerTransport.Main,\n  WebWorkerInternal: WorkerTransport.Worker,\n  WebRTC: WebRTCTransport,\n  Broadcast: BroadcastTransport,\n  SharedWorkerClient: SharedWorkerTransport.Client,\n  SharedWorkerInternal: SharedWorkerTransport.Worker,\n  MainProcess: ProcessTransport.Main,\n  ChildProcess: ProcessTransport.Child,\n};\n\n/**\n * Create a transport instance.\n *\n * @param name transport type name\n * @param options transport options\n *\n * @returns Return a transport instance.\n */\nexport const createTransport = <T extends keyof typeof TransportMap>(\n  name: T,\n  options: TransportOptionsMap[T]\n): Transports[T] => {\n  return new (TransportMap[name] as any)(options);\n};\n","import { originalListensMapKey } from '../constant';\nimport { Transport } from '../transport';\n\nexport const listen = (\n  target: Transport,\n  key: string,\n  descriptor: TypedPropertyDescriptor<(...args: any) => Promise<any>>\n) => {\n  const fn = descriptor.value;\n  if (__DEV__) {\n    if (typeof fn !== 'function') {\n      console.warn(\n        `The decorator '@listen' can only decorate methods, '${key}' is NOT a methods.`\n      );\n      return descriptor;\n    }\n  }\n  target[originalListensMapKey] = target[originalListensMapKey] ?? new Map();\n  target[originalListensMapKey].set(key, fn!);\n  return {\n    ...descriptor,\n    value(this: Transport) {\n      if (__DEV__) {\n        throw new Error(\n          `The method '${key}' is a listen function that can NOT be actively called.`\n        );\n      }\n      return Promise.resolve();\n    },\n  };\n};\n","import { listenerKey, senderKey } from './constant';\nimport { createTransport } from './createTransport';\nimport type { ListenerOptions } from './interface';\nimport { Transport } from './transport';\n\n/**\n * Merge multiple transports into one transport\n */\nexport const merge = (\n  first: Transport,\n  seconds: Transport,\n  ..._args: Transport[]\n) => {\n  const args = [first, seconds, ..._args] as Transport[];\n  if (typeof first === 'undefined' || typeof seconds === 'undefined') {\n    throw new Error(`Only more than one transports can be merged.`);\n  }\n  return createTransport('Base', {\n    listener: (callback) => {\n      const handler = (data: ListenerOptions) => {\n        callback(data);\n      };\n      const disposers = args.map((transport) =>\n        transport[listenerKey](handler)\n      );\n      return () => {\n        disposers.forEach((dispose) => dispose && dispose());\n      };\n    },\n    sender: (message) => {\n      args.forEach((transport) => {\n        transport[senderKey](message);\n      });\n    },\n  });\n};\n","import type { ListenCallback, SendOptions } from './interface';\n\n/**\n * Mock ports for testing\n */\nexport const mockPorts = () => {\n  let emitter = new Set<(data: any) => void>();\n  let mainCallback: null | ListenCallback = null;\n  return {\n    main: {\n      listener: (callback: ListenCallback) => {\n        mainCallback = callback;\n        return () => {\n          mainCallback = null;\n        };\n      },\n      sender: (message: SendOptions) => {\n        for (const emit of emitter) {\n          emit(JSON.parse(JSON.stringify(message)));\n        }\n      },\n    },\n    create: () => ({\n      listener: (callback: ListenCallback) => {\n        emitter.add(callback);\n        return () => {\n          emitter.delete(callback);\n        };\n      },\n      sender: (message: SendOptions) => {\n        mainCallback?.(JSON.parse(JSON.stringify(message)));\n      },\n    }),\n  };\n};\n","\n'use strict'\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./index.cjs.production.min.js')\n} else {\n  module.exports = require('./index.cjs.development.js')\n}\n","import { IFrameTransport, listen } from 'data-transport';\nimport {\n  ClientToStorage,\n  IChangeData,\n  IOriginStorageClient,\n  OriginStorageClientOptions,\n  StorageError,\n  StorageToClient,\n} from './interface';\n\ntype OnChangeCallback = (data: IChangeData) => void;\n\nexport class OriginStorageClient\n  extends IFrameTransport.Main<{ emit: ClientToStorage }>\n  implements StorageToClient, IOriginStorageClient\n{\n  protected _onConnectCallbacks: Set<() => void> = new Set();\n  protected _onChangeCallbacks: Set<OnChangeCallback> = new Set();\n  protected _isConnect: boolean;\n  protected _storageOptions?: LocalForageOptions;\n  protected _uri: string;\n\n  constructor({ storageOptions, uri, ...options }: OriginStorageClientOptions) {\n    const iframe = document.createElement('iframe');\n    iframe.setAttribute('style', 'display:none');\n    iframe.src = uri;\n    document.body.appendChild(iframe);\n    super({\n      iframe,\n      ...options,\n    });\n    this._uri = uri;\n    this._isConnect = false;\n    this._storageOptions = storageOptions;\n    this._connectPromise = new Promise<void>((resolve) => {\n      this._connectResolve = resolve;\n    });\n  }\n\n  private _connectPromise: Promise<void>;\n\n  private _connectResolve?: () => void;\n\n  private _connect() {\n    this._onConnectCallbacks.forEach((callback) => callback());\n  }\n\n  /**\n   * The callback will be called when the iframe is connected.\n   */\n  onConnect(callback: () => void) {\n    this._onConnectCallbacks.add(callback);\n    if (this._isConnect) {\n      callback();\n    }\n    return () => {\n      this._onConnectCallbacks.delete(callback);\n    };\n  }\n\n  /**\n   * The callback will be called when the storage is changed.\n   */\n  async onChange(callback: OnChangeCallback) {\n    this._onChangeCallbacks.add(callback);\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('broadcastChanges');\n    if (!result.broadcastChanges) {\n      if (__DEV__) {\n        console.error(\n          `The 'broadcastChanges' in 'OriginStorage' has not been enabled, Please check ${this._uri}.`\n        );\n      }\n    }\n    return {\n      ...result,\n      off: () => {\n        this._onChangeCallbacks.delete(callback);\n      },\n    };\n  }\n\n  private _change(data: IChangeData) {\n    this._onChangeCallbacks.forEach((callback) => {\n      try {\n        callback(data);\n      } catch (e) {\n        console.error(e);\n      }\n    });\n  }\n\n  @listen\n  async change(options: { key: string | null }) {\n    this._change({\n      ...options,\n      ...(typeof options.key === 'string'\n        ? { value: await this.getItem(options.key) }\n        : {}),\n    });\n  }\n\n  @listen\n  async getConfig() {\n    return this._storageOptions!;\n  }\n\n  @listen\n  async connect() {\n    if (typeof this._connect !== 'function') {\n      if (__DEV__) {\n        throw new Error(`'onConnect' has not been called.`);\n      }\n    }\n    this._isConnect = true;\n    this._connectResolve?.();\n    this._connect?.();\n  }\n\n  /**\n   * Get the value of the specified key.\n   */\n  async getItem(key: string) {\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('getItem', { key });\n    if ((result as StorageError)?.error) {\n      throw new Error(`'getItem' error: ${(result as StorageError).error}`);\n    }\n    const { value } = result as { value: unknown };\n    return value;\n  }\n\n  /**\n   * Set the value of the specified key.\n   */\n  async setItem<T>(key: string, value: unknown) {\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('setItem', { key, value });\n    if ((result as StorageError)?.error) {\n      throw new Error(`'setItem' error: ${(result as StorageError).error}`);\n    }\n    return result as Exclude<typeof result, StorageError>;\n  }\n\n  /**\n   * Remove the value of the specified key.\n   */\n  async removeItem(key: string) {\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('removeItem', { key });\n    if ((result as StorageError)?.error) {\n      throw new Error(`'removeItem' error: ${(result as StorageError).error}`);\n    }\n    return result as Exclude<typeof result, StorageError>;\n  }\n\n  /**\n   * Clear all key/value pairs in the storage.\n   */\n  async clear() {\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('clear');\n    if ((result as StorageError)?.error) {\n      throw new Error(`'clear' error: ${(result as StorageError).error}`);\n    }\n    return result as Exclude<typeof result, StorageError>;\n  }\n\n  /**\n   * Get the number of key/value pairs in the storage.\n   */\n  async length() {\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('length');\n    if ((result as StorageError)?.error) {\n      throw new Error(`'length' error: ${(result as StorageError).error}`);\n    }\n    return (result as Exclude<typeof result, StorageError | void>)?.length;\n  }\n\n  /**\n   * Get the name of the nth key in the storage.\n   */\n  async key(index: number) {\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('key', { index });\n    if ((result as StorageError)?.error) {\n      throw new Error(`'key' error: ${(result as StorageError).error}`);\n    }\n    return (result as Exclude<typeof result, StorageError | void>)?.key;\n  }\n\n  /**\n   * Get all keys in the storage.\n   */\n  async keys() {\n    if (!this._isConnect) {\n      await this._connectPromise;\n    }\n    const result = await this.emit('keys');\n    if ((result as StorageError)?.error) {\n      throw new Error(`'keys' error: ${(result as StorageError).error}`);\n    }\n    return (result as Exclude<typeof result, StorageError | void>)?.keys;\n  }\n}\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PROMISE_RESOLVED_VOID = exports.PROMISE_RESOLVED_TRUE = exports.PROMISE_RESOLVED_FALSE = void 0;\nexports.isPromise = isPromise;\nexports.microSeconds = microSeconds;\nexports.randomInt = randomInt;\nexports.randomToken = randomToken;\nexports.sleep = sleep;\nexports.supportsWebLockAPI = supportsWebLockAPI;\n/**\n * returns true if the given object is a promise\n */\nfunction isPromise(obj) {\n  return obj && typeof obj.then === 'function';\n}\nvar PROMISE_RESOLVED_FALSE = exports.PROMISE_RESOLVED_FALSE = Promise.resolve(false);\nvar PROMISE_RESOLVED_TRUE = exports.PROMISE_RESOLVED_TRUE = Promise.resolve(true);\nvar PROMISE_RESOLVED_VOID = exports.PROMISE_RESOLVED_VOID = Promise.resolve();\nfunction sleep(time, resolveWith) {\n  if (!time) time = 0;\n  return new Promise(function (res) {\n    return setTimeout(function () {\n      return res(resolveWith);\n    }, time);\n  });\n}\nfunction randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1) + min);\n}\n\n/**\n * https://stackoverflow.com/a/8084248\n */\nfunction randomToken() {\n  return Math.random().toString(36).substring(2);\n}\nvar lastMs = 0;\nvar additional = 0;\n\n/**\n * returns the current time in micro-seconds,\n * WARNING: This is a pseudo-function\n * Performance.now is not reliable in webworkers, so we just make sure to never return the same time.\n * This is enough in browsers, and this function will not be used in nodejs.\n * The main reason for this hack is to ensure that BroadcastChannel behaves equal to production when it is used in fast-running unit tests.\n */\nfunction microSeconds() {\n  var ms = Date.now();\n  if (ms === lastMs) {\n    additional++;\n    return ms * 1000 + additional;\n  } else {\n    lastMs = ms;\n    additional = 0;\n    return ms * 1000;\n  }\n}\n\n/**\n * Check if WebLock API is supported.\n * @link https://developer.mozilla.org/en-US/docs/Web/API/Web_Locks_API\n */\nfunction supportsWebLockAPI() {\n  if (typeof navigator !== 'undefined' && typeof navigator.locks !== 'undefined' && typeof navigator.locks.request === 'function') {\n    return true;\n  } else {\n    return false;\n  }\n}","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NativeMethod = void 0;\nexports.averageResponseTime = averageResponseTime;\nexports.canBeUsed = canBeUsed;\nexports.close = close;\nexports.create = create;\nexports.microSeconds = void 0;\nexports.onMessage = onMessage;\nexports.postMessage = postMessage;\nexports.type = void 0;\nvar _util = require(\"../util.js\");\nvar microSeconds = exports.microSeconds = _util.microSeconds;\nvar type = exports.type = 'native';\nfunction create(channelName) {\n  var state = {\n    messagesCallback: null,\n    bc: new BroadcastChannel(channelName),\n    subFns: [] // subscriberFunctions\n  };\n\n  state.bc.onmessage = function (msg) {\n    if (state.messagesCallback) {\n      state.messagesCallback(msg.data);\n    }\n  };\n  return state;\n}\nfunction close(channelState) {\n  channelState.bc.close();\n  channelState.subFns = [];\n}\nfunction postMessage(channelState, messageJson) {\n  try {\n    channelState.bc.postMessage(messageJson, false);\n    return _util.PROMISE_RESOLVED_VOID;\n  } catch (err) {\n    return Promise.reject(err);\n  }\n}\nfunction onMessage(channelState, fn) {\n  channelState.messagesCallback = fn;\n}\nfunction canBeUsed() {\n  if ((typeof window !== 'undefined' || typeof self !== 'undefined') && typeof BroadcastChannel === 'function') {\n    if (BroadcastChannel._pubkey) {\n      throw new Error('BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill');\n    }\n    return true;\n  } else {\n    return false;\n  }\n}\nfunction averageResponseTime() {\n  return 150;\n}\nvar NativeMethod = exports.NativeMethod = {\n  create: create,\n  close: close,\n  onMessage: onMessage,\n  postMessage: postMessage,\n  canBeUsed: canBeUsed,\n  type: type,\n  averageResponseTime: averageResponseTime,\n  microSeconds: microSeconds\n};","\n/**\n * this is a set which automatically forgets\n * a given entry when a new entry is set and the ttl\n * of the old one is over\n */\nexport class ObliviousSet<T = any> {\n    public readonly map = new Map();\n\n    /**\n     * Creating calls to setTimeout() is expensive,\n     * so we only do that if there is not timeout already open.\n     */\n    public _to: boolean = false;\n    constructor(\n        public readonly ttl: number\n    ) { }\n\n    has(value: T): boolean {\n        return this.map.has(value);\n    }\n\n    add(value: T): void {\n        this.map.set(value, now());\n\n        /**\n         * When a new value is added,\n         * start the cleanup at the next tick\n         * to not block the cpu for more important stuff\n         * that might happen.\n         */\n        if (!this._to) {\n            this._to = true;\n            setTimeout(() => {\n                this._to = false;\n                removeTooOldValues(this);\n            }, 0);\n        }\n    }\n\n    clear() {\n        this.map.clear();\n    }\n}\n\n\n/**\n * Removes all entries from the set\n * where the TTL has expired\n */\nexport function removeTooOldValues(\n    obliviousSet: ObliviousSet\n) {\n    const olderThen = now() - obliviousSet.ttl;\n    const iterator = obliviousSet.map[Symbol.iterator]();\n\n    /**\n     * Because we can assume the new values are added at the bottom,\n     * we start from the top and stop as soon as we reach a non-too-old value.\n     */\n    while (true) {\n\n        const next = iterator.next().value;\n\n        if (!next) {\n            return; // no more elements\n        }\n        const value = next[0];\n        const time = next[1];\n        if (time < olderThen) {\n            obliviousSet.map.delete(value);\n        } else {\n            // We reached a value that is not old enough\n            return;\n        }\n    }\n}\n\nexport function now(): number {\n    return new Date().getTime();\n}\n\n\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.fillOptionsWithDefaults = fillOptionsWithDefaults;\nfunction fillOptionsWithDefaults() {\n  var originalOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var options = JSON.parse(JSON.stringify(originalOptions));\n\n  // main\n  if (typeof options.webWorkerSupport === 'undefined') options.webWorkerSupport = true;\n\n  // indexed-db\n  if (!options.idb) options.idb = {};\n  //  after this time the messages get deleted\n  if (!options.idb.ttl) options.idb.ttl = 1000 * 45;\n  if (!options.idb.fallbackInterval) options.idb.fallbackInterval = 150;\n  //  handles abrupt db onclose events.\n  if (originalOptions.idb && typeof originalOptions.idb.onclose === 'function') options.idb.onclose = originalOptions.idb.onclose;\n\n  // localstorage\n  if (!options.localstorage) options.localstorage = {};\n  if (!options.localstorage.removeTimeout) options.localstorage.removeTimeout = 1000 * 60;\n\n  // custom methods\n  if (originalOptions.methods) options.methods = originalOptions.methods;\n\n  // node\n  if (!options.node) options.node = {};\n  if (!options.node.ttl) options.node.ttl = 1000 * 60 * 2; // 2 minutes;\n  /**\n   * On linux use 'ulimit -Hn' to get the limit of open files.\n   * On ubuntu this was 4096 for me, so we use half of that as maxParallelWrites default.\n   */\n  if (!options.node.maxParallelWrites) options.node.maxParallelWrites = 2048;\n  if (typeof options.node.useFastPath === 'undefined') options.node.useFastPath = true;\n  return options;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TRANSACTION_SETTINGS = exports.IndexedDBMethod = void 0;\nexports.averageResponseTime = averageResponseTime;\nexports.canBeUsed = canBeUsed;\nexports.cleanOldMessages = cleanOldMessages;\nexports.close = close;\nexports.commitIndexedDBTransaction = commitIndexedDBTransaction;\nexports.create = create;\nexports.createDatabase = createDatabase;\nexports.getAllMessages = getAllMessages;\nexports.getIdb = getIdb;\nexports.getMessagesHigherThan = getMessagesHigherThan;\nexports.getOldMessages = getOldMessages;\nexports.microSeconds = void 0;\nexports.onMessage = onMessage;\nexports.postMessage = postMessage;\nexports.removeMessagesById = removeMessagesById;\nexports.type = void 0;\nexports.writeMessage = writeMessage;\nvar _util = require(\"../util.js\");\nvar _obliviousSet = require(\"oblivious-set\");\nvar _options = require(\"../options.js\");\n/**\n * this method uses indexeddb to store the messages\n * There is currently no observerAPI for idb\n * @link https://github.com/w3c/IndexedDB/issues/51\n * \n * When working on this, ensure to use these performance optimizations:\n * @link https://rxdb.info/slow-indexeddb.html\n */\n\nvar microSeconds = exports.microSeconds = _util.microSeconds;\nvar DB_PREFIX = 'pubkey.broadcast-channel-0-';\nvar OBJECT_STORE_ID = 'messages';\n\n/**\n * Use relaxed durability for faster performance on all transactions.\n * @link https://nolanlawson.com/2021/08/22/speeding-up-indexeddb-reads-and-writes/\n */\nvar TRANSACTION_SETTINGS = exports.TRANSACTION_SETTINGS = {\n  durability: 'relaxed'\n};\nvar type = exports.type = 'idb';\nfunction getIdb() {\n  if (typeof indexedDB !== 'undefined') return indexedDB;\n  if (typeof window !== 'undefined') {\n    if (typeof window.mozIndexedDB !== 'undefined') return window.mozIndexedDB;\n    if (typeof window.webkitIndexedDB !== 'undefined') return window.webkitIndexedDB;\n    if (typeof window.msIndexedDB !== 'undefined') return window.msIndexedDB;\n  }\n  return false;\n}\n\n/**\n * If possible, we should explicitly commit IndexedDB transactions\n * for better performance.\n * @link https://nolanlawson.com/2021/08/22/speeding-up-indexeddb-reads-and-writes/\n */\nfunction commitIndexedDBTransaction(tx) {\n  if (tx.commit) {\n    tx.commit();\n  }\n}\nfunction createDatabase(channelName) {\n  var IndexedDB = getIdb();\n\n  // create table\n  var dbName = DB_PREFIX + channelName;\n\n  /**\n   * All IndexedDB databases are opened without version\n   * because it is a bit faster, especially on firefox\n   * @link http://nparashuram.com/IndexedDB/perf/#Open%20Database%20with%20version\n   */\n  var openRequest = IndexedDB.open(dbName);\n  openRequest.onupgradeneeded = function (ev) {\n    var db = ev.target.result;\n    db.createObjectStore(OBJECT_STORE_ID, {\n      keyPath: 'id',\n      autoIncrement: true\n    });\n  };\n  return new Promise(function (res, rej) {\n    openRequest.onerror = function (ev) {\n      return rej(ev);\n    };\n    openRequest.onsuccess = function () {\n      res(openRequest.result);\n    };\n  });\n}\n\n/**\n * writes the new message to the database\n * so other readers can find it\n */\nfunction writeMessage(db, readerUuid, messageJson) {\n  var time = Date.now();\n  var writeObject = {\n    uuid: readerUuid,\n    time: time,\n    data: messageJson\n  };\n  var tx = db.transaction([OBJECT_STORE_ID], 'readwrite', TRANSACTION_SETTINGS);\n  return new Promise(function (res, rej) {\n    tx.oncomplete = function () {\n      return res();\n    };\n    tx.onerror = function (ev) {\n      return rej(ev);\n    };\n    var objectStore = tx.objectStore(OBJECT_STORE_ID);\n    objectStore.add(writeObject);\n    commitIndexedDBTransaction(tx);\n  });\n}\nfunction getAllMessages(db) {\n  var tx = db.transaction(OBJECT_STORE_ID, 'readonly', TRANSACTION_SETTINGS);\n  var objectStore = tx.objectStore(OBJECT_STORE_ID);\n  var ret = [];\n  return new Promise(function (res) {\n    objectStore.openCursor().onsuccess = function (ev) {\n      var cursor = ev.target.result;\n      if (cursor) {\n        ret.push(cursor.value);\n        //alert(\"Name for SSN \" + cursor.key + \" is \" + cursor.value.name);\n        cursor[\"continue\"]();\n      } else {\n        commitIndexedDBTransaction(tx);\n        res(ret);\n      }\n    };\n  });\n}\nfunction getMessagesHigherThan(db, lastCursorId) {\n  var tx = db.transaction(OBJECT_STORE_ID, 'readonly', TRANSACTION_SETTINGS);\n  var objectStore = tx.objectStore(OBJECT_STORE_ID);\n  var ret = [];\n  var keyRangeValue = IDBKeyRange.bound(lastCursorId + 1, Infinity);\n\n  /**\n   * Optimization shortcut,\n   * if getAll() can be used, do not use a cursor.\n   * @link https://rxdb.info/slow-indexeddb.html\n   */\n  if (objectStore.getAll) {\n    var getAllRequest = objectStore.getAll(keyRangeValue);\n    return new Promise(function (res, rej) {\n      getAllRequest.onerror = function (err) {\n        return rej(err);\n      };\n      getAllRequest.onsuccess = function (e) {\n        res(e.target.result);\n      };\n    });\n  }\n  function openCursor() {\n    // Occasionally Safari will fail on IDBKeyRange.bound, this\n    // catches that error, having it open the cursor to the first\n    // item. When it gets data it will advance to the desired key.\n    try {\n      keyRangeValue = IDBKeyRange.bound(lastCursorId + 1, Infinity);\n      return objectStore.openCursor(keyRangeValue);\n    } catch (e) {\n      return objectStore.openCursor();\n    }\n  }\n  return new Promise(function (res, rej) {\n    var openCursorRequest = openCursor();\n    openCursorRequest.onerror = function (err) {\n      return rej(err);\n    };\n    openCursorRequest.onsuccess = function (ev) {\n      var cursor = ev.target.result;\n      if (cursor) {\n        if (cursor.value.id < lastCursorId + 1) {\n          cursor[\"continue\"](lastCursorId + 1);\n        } else {\n          ret.push(cursor.value);\n          cursor[\"continue\"]();\n        }\n      } else {\n        commitIndexedDBTransaction(tx);\n        res(ret);\n      }\n    };\n  });\n}\nfunction removeMessagesById(channelState, ids) {\n  if (channelState.closed) {\n    return Promise.resolve([]);\n  }\n  var tx = channelState.db.transaction(OBJECT_STORE_ID, 'readwrite', TRANSACTION_SETTINGS);\n  var objectStore = tx.objectStore(OBJECT_STORE_ID);\n  return Promise.all(ids.map(function (id) {\n    var deleteRequest = objectStore[\"delete\"](id);\n    return new Promise(function (res) {\n      deleteRequest.onsuccess = function () {\n        return res();\n      };\n    });\n  }));\n}\nfunction getOldMessages(db, ttl) {\n  var olderThen = Date.now() - ttl;\n  var tx = db.transaction(OBJECT_STORE_ID, 'readonly', TRANSACTION_SETTINGS);\n  var objectStore = tx.objectStore(OBJECT_STORE_ID);\n  var ret = [];\n  return new Promise(function (res) {\n    objectStore.openCursor().onsuccess = function (ev) {\n      var cursor = ev.target.result;\n      if (cursor) {\n        var msgObk = cursor.value;\n        if (msgObk.time < olderThen) {\n          ret.push(msgObk);\n          //alert(\"Name for SSN \" + cursor.key + \" is \" + cursor.value.name);\n          cursor[\"continue\"]();\n        } else {\n          // no more old messages,\n          commitIndexedDBTransaction(tx);\n          res(ret);\n        }\n      } else {\n        res(ret);\n      }\n    };\n  });\n}\nfunction cleanOldMessages(channelState) {\n  return getOldMessages(channelState.db, channelState.options.idb.ttl).then(function (tooOld) {\n    return removeMessagesById(channelState, tooOld.map(function (msg) {\n      return msg.id;\n    }));\n  });\n}\nfunction create(channelName, options) {\n  options = (0, _options.fillOptionsWithDefaults)(options);\n  return createDatabase(channelName).then(function (db) {\n    var state = {\n      closed: false,\n      lastCursorId: 0,\n      channelName: channelName,\n      options: options,\n      uuid: (0, _util.randomToken)(),\n      /**\n       * emittedMessagesIds\n       * contains all messages that have been emitted before\n       * @type {ObliviousSet}\n       */\n      eMIs: new _obliviousSet.ObliviousSet(options.idb.ttl * 2),\n      // ensures we do not read messages in parallel\n      writeBlockPromise: _util.PROMISE_RESOLVED_VOID,\n      messagesCallback: null,\n      readQueuePromises: [],\n      db: db\n    };\n\n    /**\n     * Handle abrupt closes that do not originate from db.close().\n     * This could happen, for example, if the underlying storage is\n     * removed or if the user clears the database in the browser's\n     * history preferences.\n     */\n    db.onclose = function () {\n      state.closed = true;\n      if (options.idb.onclose) options.idb.onclose();\n    };\n\n    /**\n     * if service-workers are used,\n     * we have no 'storage'-event if they post a message,\n     * therefore we also have to set an interval\n     */\n    _readLoop(state);\n    return state;\n  });\n}\nfunction _readLoop(state) {\n  if (state.closed) return;\n  readNewMessages(state).then(function () {\n    return (0, _util.sleep)(state.options.idb.fallbackInterval);\n  }).then(function () {\n    return _readLoop(state);\n  });\n}\nfunction _filterMessage(msgObj, state) {\n  if (msgObj.uuid === state.uuid) return false; // send by own\n  if (state.eMIs.has(msgObj.id)) return false; // already emitted\n  if (msgObj.data.time < state.messagesCallbackTime) return false; // older then onMessageCallback\n  return true;\n}\n\n/**\n * reads all new messages from the database and emits them\n */\nfunction readNewMessages(state) {\n  // channel already closed\n  if (state.closed) return _util.PROMISE_RESOLVED_VOID;\n\n  // if no one is listening, we do not need to scan for new messages\n  if (!state.messagesCallback) return _util.PROMISE_RESOLVED_VOID;\n  return getMessagesHigherThan(state.db, state.lastCursorId).then(function (newerMessages) {\n    var useMessages = newerMessages\n    /**\n     * there is a bug in iOS where the msgObj can be undefined sometimes\n     * so we filter them out\n     * @link https://github.com/pubkey/broadcast-channel/issues/19\n     */.filter(function (msgObj) {\n      return !!msgObj;\n    }).map(function (msgObj) {\n      if (msgObj.id > state.lastCursorId) {\n        state.lastCursorId = msgObj.id;\n      }\n      return msgObj;\n    }).filter(function (msgObj) {\n      return _filterMessage(msgObj, state);\n    }).sort(function (msgObjA, msgObjB) {\n      return msgObjA.time - msgObjB.time;\n    }); // sort by time\n    useMessages.forEach(function (msgObj) {\n      if (state.messagesCallback) {\n        state.eMIs.add(msgObj.id);\n        state.messagesCallback(msgObj.data);\n      }\n    });\n    return _util.PROMISE_RESOLVED_VOID;\n  });\n}\nfunction close(channelState) {\n  channelState.closed = true;\n  channelState.db.close();\n}\nfunction postMessage(channelState, messageJson) {\n  channelState.writeBlockPromise = channelState.writeBlockPromise.then(function () {\n    return writeMessage(channelState.db, channelState.uuid, messageJson);\n  }).then(function () {\n    if ((0, _util.randomInt)(0, 10) === 0) {\n      /* await (do not await) */\n      cleanOldMessages(channelState);\n    }\n  });\n  return channelState.writeBlockPromise;\n}\nfunction onMessage(channelState, fn, time) {\n  channelState.messagesCallbackTime = time;\n  channelState.messagesCallback = fn;\n  readNewMessages(channelState);\n}\nfunction canBeUsed() {\n  return !!getIdb();\n}\nfunction averageResponseTime(options) {\n  return options.idb.fallbackInterval * 2;\n}\nvar IndexedDBMethod = exports.IndexedDBMethod = {\n  create: create,\n  close: close,\n  onMessage: onMessage,\n  postMessage: postMessage,\n  canBeUsed: canBeUsed,\n  type: type,\n  averageResponseTime: averageResponseTime,\n  microSeconds: microSeconds\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LocalstorageMethod = void 0;\nexports.addStorageEventListener = addStorageEventListener;\nexports.averageResponseTime = averageResponseTime;\nexports.canBeUsed = canBeUsed;\nexports.close = close;\nexports.create = create;\nexports.getLocalStorage = getLocalStorage;\nexports.microSeconds = void 0;\nexports.onMessage = onMessage;\nexports.postMessage = postMessage;\nexports.removeStorageEventListener = removeStorageEventListener;\nexports.storageKey = storageKey;\nexports.type = void 0;\nvar _obliviousSet = require(\"oblivious-set\");\nvar _options = require(\"../options.js\");\nvar _util = require(\"../util.js\");\n/**\n * A localStorage-only method which uses localstorage and its 'storage'-event\n * This does not work inside webworkers because they have no access to localstorage\n * This is basically implemented to support IE9 or your grandmother's toaster.\n * @link https://caniuse.com/#feat=namevalue-storage\n * @link https://caniuse.com/#feat=indexeddb\n */\n\nvar microSeconds = exports.microSeconds = _util.microSeconds;\nvar KEY_PREFIX = 'pubkey.broadcastChannel-';\nvar type = exports.type = 'localstorage';\n\n/**\n * copied from crosstab\n * @link https://github.com/tejacques/crosstab/blob/master/src/crosstab.js#L32\n */\nfunction getLocalStorage() {\n  var localStorage;\n  if (typeof window === 'undefined') return null;\n  try {\n    localStorage = window.localStorage;\n    localStorage = window['ie8-eventlistener/storage'] || window.localStorage;\n  } catch (e) {\n    // New versions of Firefox throw a Security exception\n    // if cookies are disabled. See\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1028153\n  }\n  return localStorage;\n}\nfunction storageKey(channelName) {\n  return KEY_PREFIX + channelName;\n}\n\n/**\n* writes the new message to the storage\n* and fires the storage-event so other readers can find it\n*/\nfunction postMessage(channelState, messageJson) {\n  return new Promise(function (res) {\n    (0, _util.sleep)().then(function () {\n      var key = storageKey(channelState.channelName);\n      var writeObj = {\n        token: (0, _util.randomToken)(),\n        time: Date.now(),\n        data: messageJson,\n        uuid: channelState.uuid\n      };\n      var value = JSON.stringify(writeObj);\n      getLocalStorage().setItem(key, value);\n\n      /**\n       * StorageEvent does not fire the 'storage' event\n       * in the window that changes the state of the local storage.\n       * So we fire it manually\n       */\n      var ev = document.createEvent('Event');\n      ev.initEvent('storage', true, true);\n      ev.key = key;\n      ev.newValue = value;\n      window.dispatchEvent(ev);\n      res();\n    });\n  });\n}\nfunction addStorageEventListener(channelName, fn) {\n  var key = storageKey(channelName);\n  var listener = function listener(ev) {\n    if (ev.key === key) {\n      fn(JSON.parse(ev.newValue));\n    }\n  };\n  window.addEventListener('storage', listener);\n  return listener;\n}\nfunction removeStorageEventListener(listener) {\n  window.removeEventListener('storage', listener);\n}\nfunction create(channelName, options) {\n  options = (0, _options.fillOptionsWithDefaults)(options);\n  if (!canBeUsed()) {\n    throw new Error('BroadcastChannel: localstorage cannot be used');\n  }\n  var uuid = (0, _util.randomToken)();\n\n  /**\n   * eMIs\n   * contains all messages that have been emitted before\n   * @type {ObliviousSet}\n   */\n  var eMIs = new _obliviousSet.ObliviousSet(options.localstorage.removeTimeout);\n  var state = {\n    channelName: channelName,\n    uuid: uuid,\n    eMIs: eMIs // emittedMessagesIds\n  };\n\n  state.listener = addStorageEventListener(channelName, function (msgObj) {\n    if (!state.messagesCallback) return; // no listener\n    if (msgObj.uuid === uuid) return; // own message\n    if (!msgObj.token || eMIs.has(msgObj.token)) return; // already emitted\n    if (msgObj.data.time && msgObj.data.time < state.messagesCallbackTime) return; // too old\n\n    eMIs.add(msgObj.token);\n    state.messagesCallback(msgObj.data);\n  });\n  return state;\n}\nfunction close(channelState) {\n  removeStorageEventListener(channelState.listener);\n}\nfunction onMessage(channelState, fn, time) {\n  channelState.messagesCallbackTime = time;\n  channelState.messagesCallback = fn;\n}\nfunction canBeUsed() {\n  var ls = getLocalStorage();\n  if (!ls) return false;\n  try {\n    var key = '__broadcastchannel_check';\n    ls.setItem(key, 'works');\n    ls.removeItem(key);\n  } catch (e) {\n    // Safari 10 in private mode will not allow write access to local\n    // storage and fail with a QuotaExceededError. See\n    // https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API#Private_Browsing_Incognito_modes\n    return false;\n  }\n  return true;\n}\nfunction averageResponseTime() {\n  var defaultTime = 120;\n  var userAgent = navigator.userAgent.toLowerCase();\n  if (userAgent.includes('safari') && !userAgent.includes('chrome')) {\n    // safari is much slower so this time is higher\n    return defaultTime * 2;\n  }\n  return defaultTime;\n}\nvar LocalstorageMethod = exports.LocalstorageMethod = {\n  create: create,\n  close: close,\n  onMessage: onMessage,\n  postMessage: postMessage,\n  canBeUsed: canBeUsed,\n  type: type,\n  averageResponseTime: averageResponseTime,\n  microSeconds: microSeconds\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SimulateMethod = void 0;\nexports.averageResponseTime = averageResponseTime;\nexports.canBeUsed = canBeUsed;\nexports.close = close;\nexports.create = create;\nexports.microSeconds = void 0;\nexports.onMessage = onMessage;\nexports.postMessage = postMessage;\nexports.type = void 0;\nvar _util = require(\"../util.js\");\nvar microSeconds = exports.microSeconds = _util.microSeconds;\nvar type = exports.type = 'simulate';\nvar SIMULATE_CHANNELS = new Set();\nfunction create(channelName) {\n  var state = {\n    name: channelName,\n    messagesCallback: null\n  };\n  SIMULATE_CHANNELS.add(state);\n  return state;\n}\nfunction close(channelState) {\n  SIMULATE_CHANNELS[\"delete\"](channelState);\n}\nfunction postMessage(channelState, messageJson) {\n  return new Promise(function (res) {\n    return setTimeout(function () {\n      var channelArray = Array.from(SIMULATE_CHANNELS);\n      channelArray.filter(function (channel) {\n        return channel.name === channelState.name;\n      }).filter(function (channel) {\n        return channel !== channelState;\n      }).filter(function (channel) {\n        return !!channel.messagesCallback;\n      }).forEach(function (channel) {\n        return channel.messagesCallback(messageJson);\n      });\n      res();\n    }, 5);\n  });\n}\nfunction onMessage(channelState, fn) {\n  channelState.messagesCallback = fn;\n}\nfunction canBeUsed() {\n  return true;\n}\nfunction averageResponseTime() {\n  return 5;\n}\nvar SimulateMethod = exports.SimulateMethod = {\n  create: create,\n  close: close,\n  onMessage: onMessage,\n  postMessage: postMessage,\n  canBeUsed: canBeUsed,\n  type: type,\n  averageResponseTime: averageResponseTime,\n  microSeconds: microSeconds\n};","\"use strict\";\n\nvar _typeof = require(\"@babel/runtime/helpers/typeof\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.chooseMethod = chooseMethod;\nvar _native = require(\"./methods/native.js\");\nvar _indexedDb = require(\"./methods/indexed-db.js\");\nvar _localstorage = require(\"./methods/localstorage.js\");\nvar _simulate = require(\"./methods/simulate.js\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != _typeof(e) && \"function\" != typeof e) return { \"default\": e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n[\"default\"] = e, t && t.set(e, n), n; }\n// the line below will be removed from es5/browser builds\n\n// order is important\nvar METHODS = [_native.NativeMethod,\n// fastest\n_indexedDb.IndexedDBMethod, _localstorage.LocalstorageMethod];\nfunction chooseMethod(options) {\n  var chooseMethods = [].concat(options.methods, METHODS).filter(Boolean);\n\n  // the line below will be removed from es5/browser builds\n\n  // directly chosen\n  if (options.type) {\n    if (options.type === 'simulate') {\n      // only use simulate-method if directly chosen\n      return _simulate.SimulateMethod;\n    }\n    var ret = chooseMethods.find(function (m) {\n      return m.type === options.type;\n    });\n    if (!ret) throw new Error('method-type ' + options.type + ' not found');else return ret;\n  }\n\n  /**\n   * if no webworker support is needed,\n   * remove idb from the list so that localstorage will be chosen\n   */\n  if (!options.webWorkerSupport) {\n    chooseMethods = chooseMethods.filter(function (m) {\n      return m.type !== 'idb';\n    });\n  }\n  var useMethod = chooseMethods.find(function (method) {\n    return method.canBeUsed();\n  });\n  if (!useMethod) {\n    throw new Error(\"No usable method found in \" + JSON.stringify(METHODS.map(function (m) {\n      return m.type;\n    })));\n  } else {\n    return useMethod;\n  }\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.OPEN_BROADCAST_CHANNELS = exports.BroadcastChannel = void 0;\nexports.clearNodeFolder = clearNodeFolder;\nexports.enforceOptions = enforceOptions;\nvar _util = require(\"./util.js\");\nvar _methodChooser = require(\"./method-chooser.js\");\nvar _options = require(\"./options.js\");\n/**\n * Contains all open channels,\n * used in tests to ensure everything is closed.\n */\nvar OPEN_BROADCAST_CHANNELS = exports.OPEN_BROADCAST_CHANNELS = new Set();\nvar lastId = 0;\nvar BroadcastChannel = exports.BroadcastChannel = function BroadcastChannel(name, options) {\n  // identifier of the channel to debug stuff\n  this.id = lastId++;\n  OPEN_BROADCAST_CHANNELS.add(this);\n  this.name = name;\n  if (ENFORCED_OPTIONS) {\n    options = ENFORCED_OPTIONS;\n  }\n  this.options = (0, _options.fillOptionsWithDefaults)(options);\n  this.method = (0, _methodChooser.chooseMethod)(this.options);\n\n  // isListening\n  this._iL = false;\n\n  /**\n   * _onMessageListener\n   * setting onmessage twice,\n   * will overwrite the first listener\n   */\n  this._onML = null;\n\n  /**\n   * _addEventListeners\n   */\n  this._addEL = {\n    message: [],\n    internal: []\n  };\n\n  /**\n   * Unsent message promises\n   * where the sending is still in progress\n   * @type {Set<Promise>}\n   */\n  this._uMP = new Set();\n\n  /**\n   * _beforeClose\n   * array of promises that will be awaited\n   * before the channel is closed\n   */\n  this._befC = [];\n\n  /**\n   * _preparePromise\n   */\n  this._prepP = null;\n  _prepareChannel(this);\n};\n\n// STATICS\n\n/**\n * used to identify if someone overwrites\n * window.BroadcastChannel with this\n * See methods/native.js\n */\nBroadcastChannel._pubkey = true;\n\n/**\n * clears the tmp-folder if is node\n * @return {Promise<boolean>} true if has run, false if not node\n */\nfunction clearNodeFolder(options) {\n  options = (0, _options.fillOptionsWithDefaults)(options);\n  var method = (0, _methodChooser.chooseMethod)(options);\n  if (method.type === 'node') {\n    return method.clearNodeFolder().then(function () {\n      return true;\n    });\n  } else {\n    return _util.PROMISE_RESOLVED_FALSE;\n  }\n}\n\n/**\n * if set, this method is enforced,\n * no mather what the options are\n */\nvar ENFORCED_OPTIONS;\nfunction enforceOptions(options) {\n  ENFORCED_OPTIONS = options;\n}\n\n// PROTOTYPE\nBroadcastChannel.prototype = {\n  postMessage: function postMessage(msg) {\n    if (this.closed) {\n      throw new Error('BroadcastChannel.postMessage(): ' + 'Cannot post message after channel has closed ' +\n      /**\n       * In the past when this error appeared, it was really hard to debug.\n       * So now we log the msg together with the error so it at least\n       * gives some clue about where in your application this happens.\n       */\n      JSON.stringify(msg));\n    }\n    return _post(this, 'message', msg);\n  },\n  postInternal: function postInternal(msg) {\n    return _post(this, 'internal', msg);\n  },\n  set onmessage(fn) {\n    var time = this.method.microSeconds();\n    var listenObj = {\n      time: time,\n      fn: fn\n    };\n    _removeListenerObject(this, 'message', this._onML);\n    if (fn && typeof fn === 'function') {\n      this._onML = listenObj;\n      _addListenerObject(this, 'message', listenObj);\n    } else {\n      this._onML = null;\n    }\n  },\n  addEventListener: function addEventListener(type, fn) {\n    var time = this.method.microSeconds();\n    var listenObj = {\n      time: time,\n      fn: fn\n    };\n    _addListenerObject(this, type, listenObj);\n  },\n  removeEventListener: function removeEventListener(type, fn) {\n    var obj = this._addEL[type].find(function (obj) {\n      return obj.fn === fn;\n    });\n    _removeListenerObject(this, type, obj);\n  },\n  close: function close() {\n    var _this = this;\n    if (this.closed) {\n      return;\n    }\n    OPEN_BROADCAST_CHANNELS[\"delete\"](this);\n    this.closed = true;\n    var awaitPrepare = this._prepP ? this._prepP : _util.PROMISE_RESOLVED_VOID;\n    this._onML = null;\n    this._addEL.message = [];\n    return awaitPrepare\n    // wait until all current sending are processed\n    .then(function () {\n      return Promise.all(Array.from(_this._uMP));\n    })\n    // run before-close hooks\n    .then(function () {\n      return Promise.all(_this._befC.map(function (fn) {\n        return fn();\n      }));\n    })\n    // close the channel\n    .then(function () {\n      return _this.method.close(_this._state);\n    });\n  },\n  get type() {\n    return this.method.type;\n  },\n  get isClosed() {\n    return this.closed;\n  }\n};\n\n/**\n * Post a message over the channel\n * @returns {Promise} that resolved when the message sending is done\n */\nfunction _post(broadcastChannel, type, msg) {\n  var time = broadcastChannel.method.microSeconds();\n  var msgObj = {\n    time: time,\n    type: type,\n    data: msg\n  };\n  var awaitPrepare = broadcastChannel._prepP ? broadcastChannel._prepP : _util.PROMISE_RESOLVED_VOID;\n  return awaitPrepare.then(function () {\n    var sendPromise = broadcastChannel.method.postMessage(broadcastChannel._state, msgObj);\n\n    // add/remove to unsent messages list\n    broadcastChannel._uMP.add(sendPromise);\n    sendPromise[\"catch\"]().then(function () {\n      return broadcastChannel._uMP[\"delete\"](sendPromise);\n    });\n    return sendPromise;\n  });\n}\nfunction _prepareChannel(channel) {\n  var maybePromise = channel.method.create(channel.name, channel.options);\n  if ((0, _util.isPromise)(maybePromise)) {\n    channel._prepP = maybePromise;\n    maybePromise.then(function (s) {\n      // used in tests to simulate slow runtime\n      /*if (channel.options.prepareDelay) {\n           await new Promise(res => setTimeout(res, this.options.prepareDelay));\n      }*/\n      channel._state = s;\n    });\n  } else {\n    channel._state = maybePromise;\n  }\n}\nfunction _hasMessageListeners(channel) {\n  if (channel._addEL.message.length > 0) return true;\n  if (channel._addEL.internal.length > 0) return true;\n  return false;\n}\nfunction _addListenerObject(channel, type, obj) {\n  channel._addEL[type].push(obj);\n  _startListening(channel);\n}\nfunction _removeListenerObject(channel, type, obj) {\n  channel._addEL[type] = channel._addEL[type].filter(function (o) {\n    return o !== obj;\n  });\n  _stopListening(channel);\n}\nfunction _startListening(channel) {\n  if (!channel._iL && _hasMessageListeners(channel)) {\n    // someone is listening, start subscribing\n\n    var listenerFn = function listenerFn(msgObj) {\n      channel._addEL[msgObj.type].forEach(function (listenerObject) {\n        /**\n         * Getting the current time in JavaScript has no good precision.\n         * So instead of only listening to events that happened 'after' the listener\n         * was added, we also listen to events that happened 100ms before it.\n         * This ensures that when another process, like a WebWorker, sends events\n         * we do not miss them out because their timestamp is a bit off compared to the main process.\n         * Not doing this would make messages missing when we send data directly after subscribing and awaiting a response.\n         * @link https://johnresig.com/blog/accuracy-of-javascript-time/\n         */\n        var hundredMsInMicro = 100 * 1000;\n        var minMessageTime = listenerObject.time - hundredMsInMicro;\n        if (msgObj.time >= minMessageTime) {\n          listenerObject.fn(msgObj.data);\n        }\n      });\n    };\n    var time = channel.method.microSeconds();\n    if (channel._prepP) {\n      channel._prepP.then(function () {\n        channel._iL = true;\n        channel.method.onMessage(channel._state, listenerFn, time);\n      });\n    } else {\n      channel._iL = true;\n      channel.method.onMessage(channel._state, listenerFn, time);\n    }\n  }\n}\nfunction _stopListening(channel) {\n  if (channel._iL && !_hasMessageListeners(channel)) {\n    // no one is listening, stop subscribing\n    channel._iL = false;\n    var time = channel.method.microSeconds();\n    channel.method.onMessage(channel._state, null, time);\n  }\n}","/* global WorkerGlobalScope */\n\nexport function addBrowser(fn) {\n  if (typeof WorkerGlobalScope === 'function' && self instanceof WorkerGlobalScope) {\n    /**\n     * Because killing a worker does directly stop the excution\n     * of the code, our only chance is to overwrite the close function\n     * which could work some times.\n     * @link https://stackoverflow.com/q/72903255/3443137\n     */\n    var oldClose = self.close.bind(self);\n    self.close = function () {\n      fn();\n      return oldClose();\n    };\n  } else {\n    /**\n     * if we are on react-native, there is no window.addEventListener\n     * @link https://github.com/pubkey/unload/issues/6\n     */\n    if (typeof window.addEventListener !== 'function') {\n      return;\n    }\n\n    /**\n     * for normal browser-windows, we use the beforeunload-event\n     */\n    window.addEventListener('beforeunload', function () {\n      fn();\n    }, true);\n\n    /**\n     * for iframes, we have to use the unload-event\n     * @link https://stackoverflow.com/q/47533670/3443137\n     */\n    window.addEventListener('unload', function () {\n      fn();\n    }, true);\n  }\n\n  /**\n   * TODO add fallback for safari-mobile\n   * @link https://stackoverflow.com/a/26193516/3443137\n   */\n}","export function addNode(fn) {\n  process.on('exit', function () {\n    return fn();\n  });\n\n  /**\n   * on the following events,\n   * the process will not end if there are\n   * event-handlers attached,\n   * therefore we have to call process.exit()\n   */\n  process.on('beforeExit', function () {\n    return fn().then(function () {\n      return process.exit();\n    });\n  });\n  // catches ctrl+c event\n  process.on('SIGINT', function () {\n    return fn().then(function () {\n      return process.exit();\n    });\n  });\n  // catches uncaught exceptions\n  process.on('uncaughtException', function (err) {\n    return fn().then(function () {\n      console.trace(err);\n      process.exit(101);\n    });\n  });\n}","import { addBrowser } from './browser.js';\nimport { addNode } from './node.js';\n\n/**\n * Use the code directly to prevent import problems\n * with the detect-node package.\n * @link https://github.com/iliakan/detect-node/blob/master/index.js\n */\nvar isNode = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\nvar USE_METHOD = isNode ? addNode : addBrowser;\nvar LISTENERS = new Set();\nvar startedListening = false;\nfunction startListening() {\n  if (startedListening) {\n    return;\n  }\n  startedListening = true;\n  USE_METHOD(runAll);\n}\nexport function add(fn) {\n  startListening();\n  if (typeof fn !== 'function') {\n    throw new Error('Listener is no function');\n  }\n  LISTENERS.add(fn);\n  var addReturn = {\n    remove: function remove() {\n      return LISTENERS[\"delete\"](fn);\n    },\n    run: function run() {\n      LISTENERS[\"delete\"](fn);\n      return fn();\n    }\n  };\n  return addReturn;\n}\nexport function runAll() {\n  var promises = [];\n  LISTENERS.forEach(function (fn) {\n    promises.push(fn());\n    LISTENERS[\"delete\"](fn);\n  });\n  return Promise.all(promises);\n}\nexport function removeAll() {\n  LISTENERS.clear();\n}\nexport function getSize() {\n  return LISTENERS.size;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.beLeader = beLeader;\nexports.sendLeaderMessage = sendLeaderMessage;\nvar _unload = require(\"unload\");\n/**\n * sends and internal message over the broadcast-channel\n */\nfunction sendLeaderMessage(leaderElector, action) {\n  var msgJson = {\n    context: 'leader',\n    action: action,\n    token: leaderElector.token\n  };\n  return leaderElector.broadcastChannel.postInternal(msgJson);\n}\nfunction beLeader(leaderElector) {\n  leaderElector.isLeader = true;\n  leaderElector._hasLeader = true;\n  var unloadFn = (0, _unload.add)(function () {\n    return leaderElector.die();\n  });\n  leaderElector._unl.push(unloadFn);\n  var isLeaderListener = function isLeaderListener(msg) {\n    if (msg.context === 'leader' && msg.action === 'apply') {\n      sendLeaderMessage(leaderElector, 'tell');\n    }\n    if (msg.context === 'leader' && msg.action === 'tell' && !leaderElector._dpLC) {\n      /**\n       * another instance is also leader!\n       * This can happen on rare events\n       * like when the CPU is at 100% for long time\n       * or the tabs are open very long and the browser throttles them.\n       * @link https://github.com/pubkey/broadcast-channel/issues/414\n       * @link https://github.com/pubkey/broadcast-channel/issues/385\n       */\n      leaderElector._dpLC = true;\n      leaderElector._dpL(); // message the lib user so the app can handle the problem\n      sendLeaderMessage(leaderElector, 'tell'); // ensure other leader also knows the problem\n    }\n  };\n\n  leaderElector.broadcastChannel.addEventListener('internal', isLeaderListener);\n  leaderElector._lstns.push(isLeaderListener);\n  return sendLeaderMessage(leaderElector, 'tell');\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LeaderElectionWebLock = void 0;\nvar _util = require(\"./util.js\");\nvar _leaderElectionUtil = require(\"./leader-election-util.js\");\n/**\n * A faster version of the leader elector that uses the WebLock API\n * @link https://developer.mozilla.org/en-US/docs/Web/API/Web_Locks_API\n */\nvar LeaderElectionWebLock = exports.LeaderElectionWebLock = function LeaderElectionWebLock(broadcastChannel, options) {\n  var _this = this;\n  this.broadcastChannel = broadcastChannel;\n  broadcastChannel._befC.push(function () {\n    return _this.die();\n  });\n  this._options = options;\n  this.isLeader = false;\n  this.isDead = false;\n  this.token = (0, _util.randomToken)();\n  this._lstns = [];\n  this._unl = [];\n  this._dpL = function () {}; // onduplicate listener\n  this._dpLC = false; // true when onduplicate called\n\n  this._wKMC = {}; // stuff for cleanup\n\n  // lock name\n  this.lN = 'pubkey-bc||' + broadcastChannel.method.type + '||' + broadcastChannel.name;\n};\nLeaderElectionWebLock.prototype = {\n  hasLeader: function hasLeader() {\n    var _this2 = this;\n    return navigator.locks.query().then(function (locks) {\n      var relevantLocks = locks.held ? locks.held.filter(function (lock) {\n        return lock.name === _this2.lN;\n      }) : [];\n      if (relevantLocks && relevantLocks.length > 0) {\n        return true;\n      } else {\n        return false;\n      }\n    });\n  },\n  awaitLeadership: function awaitLeadership() {\n    var _this3 = this;\n    if (!this._wLMP) {\n      this._wKMC.c = new AbortController();\n      var returnPromise = new Promise(function (res, rej) {\n        _this3._wKMC.res = res;\n        _this3._wKMC.rej = rej;\n      });\n      this._wLMP = new Promise(function (res) {\n        navigator.locks.request(_this3.lN, {\n          signal: _this3._wKMC.c.signal\n        }, function () {\n          // if the lock resolved, we can drop the abort controller\n          _this3._wKMC.c = undefined;\n          (0, _leaderElectionUtil.beLeader)(_this3);\n          res();\n          return returnPromise;\n        })[\"catch\"](function () {});\n      });\n    }\n    return this._wLMP;\n  },\n  set onduplicate(_fn) {\n    // Do nothing because there are no duplicates in the WebLock version\n  },\n  die: function die() {\n    var _this4 = this;\n    this._lstns.forEach(function (listener) {\n      return _this4.broadcastChannel.removeEventListener('internal', listener);\n    });\n    this._lstns = [];\n    this._unl.forEach(function (uFn) {\n      return uFn.remove();\n    });\n    this._unl = [];\n    if (this.isLeader) {\n      this.isLeader = false;\n    }\n    this.isDead = true;\n    if (this._wKMC.res) {\n      this._wKMC.res();\n    }\n    if (this._wKMC.c) {\n      this._wKMC.c.abort('LeaderElectionWebLock.die() called');\n    }\n    return (0, _leaderElectionUtil.sendLeaderMessage)(this, 'death');\n  }\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createLeaderElection = createLeaderElection;\nvar _util = require(\"./util.js\");\nvar _leaderElectionUtil = require(\"./leader-election-util.js\");\nvar _leaderElectionWebLock = require(\"./leader-election-web-lock.js\");\nvar LeaderElection = function LeaderElection(broadcastChannel, options) {\n  var _this = this;\n  this.broadcastChannel = broadcastChannel;\n  this._options = options;\n  this.isLeader = false;\n  this._hasLeader = false;\n  this.isDead = false;\n  this.token = (0, _util.randomToken)();\n\n  /**\n   * Apply Queue,\n   * used to ensure we do not run applyOnce()\n   * in parallel.\n   */\n  this._aplQ = _util.PROMISE_RESOLVED_VOID;\n  // amount of unfinished applyOnce() calls\n  this._aplQC = 0;\n\n  // things to clean up\n  this._unl = []; // _unloads\n  this._lstns = []; // _listeners\n  this._dpL = function () {}; // onduplicate listener\n  this._dpLC = false; // true when onduplicate called\n\n  /**\n   * Even when the own instance is not applying,\n   * we still listen to messages to ensure the hasLeader flag\n   * is set correctly.\n   */\n  var hasLeaderListener = function hasLeaderListener(msg) {\n    if (msg.context === 'leader') {\n      if (msg.action === 'death') {\n        _this._hasLeader = false;\n      }\n      if (msg.action === 'tell') {\n        _this._hasLeader = true;\n      }\n    }\n  };\n  this.broadcastChannel.addEventListener('internal', hasLeaderListener);\n  this._lstns.push(hasLeaderListener);\n};\nLeaderElection.prototype = {\n  hasLeader: function hasLeader() {\n    return Promise.resolve(this._hasLeader);\n  },\n  /**\n   * Returns true if the instance is leader,\n   * false if not.\n   * @async\n   */\n  applyOnce: function applyOnce(\n  // true if the applyOnce() call came from the fallbackInterval cycle\n  isFromFallbackInterval) {\n    var _this2 = this;\n    if (this.isLeader) {\n      return (0, _util.sleep)(0, true);\n    }\n    if (this.isDead) {\n      return (0, _util.sleep)(0, false);\n    }\n\n    /**\n     * Already applying more than once,\n     * -> wait for the apply queue to be finished.\n     */\n    if (this._aplQC > 1) {\n      return this._aplQ;\n    }\n\n    /**\n     * Add a new apply-run\n     */\n    var applyRun = function applyRun() {\n      /**\n       * Optimization shortcuts.\n       * Directly return if a previous run\n       * has already elected a leader.\n       */\n      if (_this2.isLeader) {\n        return _util.PROMISE_RESOLVED_TRUE;\n      }\n      var stopCriteria = false;\n      var stopCriteriaPromiseResolve;\n      /**\n       * Resolves when a stop criteria is reached.\n       * Uses as a performance shortcut so we do not\n       * have to await the responseTime when it is already clear\n       * that the election failed.\n       */\n      var stopCriteriaPromise = new Promise(function (res) {\n        stopCriteriaPromiseResolve = function stopCriteriaPromiseResolve() {\n          stopCriteria = true;\n          res();\n        };\n      });\n      var handleMessage = function handleMessage(msg) {\n        if (msg.context === 'leader' && msg.token != _this2.token) {\n          if (msg.action === 'apply') {\n            // other is applying\n            if (msg.token > _this2.token) {\n              /**\n               * other has higher token\n               * -> stop applying and let other become leader.\n               */\n              stopCriteriaPromiseResolve();\n            }\n          }\n          if (msg.action === 'tell') {\n            // other is already leader\n            stopCriteriaPromiseResolve();\n            _this2._hasLeader = true;\n          }\n        }\n      };\n      _this2.broadcastChannel.addEventListener('internal', handleMessage);\n\n      /**\n       * If the applyOnce() call came from the fallbackInterval,\n       * we can assume that the election runs in the background and\n       * not critical process is waiting for it.\n       * When this is true, we give the other instances\n       * more time to answer to messages in the election cycle.\n       * This makes it less likely to elect duplicate leaders.\n       * But also it takes longer which is not a problem because we anyway\n       * run in the background.\n       */\n      var waitForAnswerTime = isFromFallbackInterval ? _this2._options.responseTime * 4 : _this2._options.responseTime;\n      return (0, _leaderElectionUtil.sendLeaderMessage)(_this2, 'apply') // send out that this one is applying\n      .then(function () {\n        return Promise.race([(0, _util.sleep)(waitForAnswerTime), stopCriteriaPromise.then(function () {\n          return Promise.reject(new Error());\n        })]);\n      })\n      // send again in case another instance was just created\n      .then(function () {\n        return (0, _leaderElectionUtil.sendLeaderMessage)(_this2, 'apply');\n      })\n      // let others time to respond\n      .then(function () {\n        return Promise.race([(0, _util.sleep)(waitForAnswerTime), stopCriteriaPromise.then(function () {\n          return Promise.reject(new Error());\n        })]);\n      })[\"catch\"](function () {}).then(function () {\n        _this2.broadcastChannel.removeEventListener('internal', handleMessage);\n        if (!stopCriteria) {\n          // no stop criteria -> own is leader\n          return (0, _leaderElectionUtil.beLeader)(_this2).then(function () {\n            return true;\n          });\n        } else {\n          // other is leader\n          return false;\n        }\n      });\n    };\n    this._aplQC = this._aplQC + 1;\n    this._aplQ = this._aplQ.then(function () {\n      return applyRun();\n    }).then(function () {\n      _this2._aplQC = _this2._aplQC - 1;\n    });\n    return this._aplQ.then(function () {\n      return _this2.isLeader;\n    });\n  },\n  awaitLeadership: function awaitLeadership() {\n    if ( /* _awaitLeadershipPromise */\n    !this._aLP) {\n      this._aLP = _awaitLeadershipOnce(this);\n    }\n    return this._aLP;\n  },\n  set onduplicate(fn) {\n    this._dpL = fn;\n  },\n  die: function die() {\n    var _this3 = this;\n    this._lstns.forEach(function (listener) {\n      return _this3.broadcastChannel.removeEventListener('internal', listener);\n    });\n    this._lstns = [];\n    this._unl.forEach(function (uFn) {\n      return uFn.remove();\n    });\n    this._unl = [];\n    if (this.isLeader) {\n      this._hasLeader = false;\n      this.isLeader = false;\n    }\n    this.isDead = true;\n    return (0, _leaderElectionUtil.sendLeaderMessage)(this, 'death');\n  }\n};\n\n/**\n * @param leaderElector {LeaderElector}\n */\nfunction _awaitLeadershipOnce(leaderElector) {\n  if (leaderElector.isLeader) {\n    return _util.PROMISE_RESOLVED_VOID;\n  }\n  return new Promise(function (res) {\n    var resolved = false;\n    function finish() {\n      if (resolved) {\n        return;\n      }\n      resolved = true;\n      leaderElector.broadcastChannel.removeEventListener('internal', whenDeathListener);\n      res(true);\n    }\n\n    // try once now\n    leaderElector.applyOnce().then(function () {\n      if (leaderElector.isLeader) {\n        finish();\n      }\n    });\n\n    /**\n     * Try on fallbackInterval\n     * @recursive\n     */\n    var tryOnFallBack = function tryOnFallBack() {\n      return (0, _util.sleep)(leaderElector._options.fallbackInterval).then(function () {\n        if (leaderElector.isDead || resolved) {\n          return;\n        }\n        if (leaderElector.isLeader) {\n          finish();\n        } else {\n          return leaderElector.applyOnce(true).then(function () {\n            if (leaderElector.isLeader) {\n              finish();\n            } else {\n              tryOnFallBack();\n            }\n          });\n        }\n      });\n    };\n    tryOnFallBack();\n\n    // try when other leader dies\n    var whenDeathListener = function whenDeathListener(msg) {\n      if (msg.context === 'leader' && msg.action === 'death') {\n        leaderElector._hasLeader = false;\n        leaderElector.applyOnce().then(function () {\n          if (leaderElector.isLeader) {\n            finish();\n          }\n        });\n      }\n    };\n    leaderElector.broadcastChannel.addEventListener('internal', whenDeathListener);\n    leaderElector._lstns.push(whenDeathListener);\n  });\n}\nfunction fillOptionsWithDefaults(options, channel) {\n  if (!options) options = {};\n  options = JSON.parse(JSON.stringify(options));\n  if (!options.fallbackInterval) {\n    options.fallbackInterval = 3000;\n  }\n  if (!options.responseTime) {\n    options.responseTime = channel.method.averageResponseTime(channel.options);\n  }\n  return options;\n}\nfunction createLeaderElection(channel, options) {\n  if (channel._leaderElector) {\n    throw new Error('BroadcastChannel already has a leader-elector');\n  }\n  options = fillOptionsWithDefaults(options, channel);\n  var elector = (0, _util.supportsWebLockAPI)() ? new _leaderElectionWebLock.LeaderElectionWebLock(channel, options) : new LeaderElection(channel, options);\n  channel._befC.push(function () {\n    return elector.die();\n  });\n  channel._leaderElector = elector;\n  return elector;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"BroadcastChannel\", {\n  enumerable: true,\n  get: function get() {\n    return _broadcastChannel.BroadcastChannel;\n  }\n});\nObject.defineProperty(exports, \"OPEN_BROADCAST_CHANNELS\", {\n  enumerable: true,\n  get: function get() {\n    return _broadcastChannel.OPEN_BROADCAST_CHANNELS;\n  }\n});\nObject.defineProperty(exports, \"beLeader\", {\n  enumerable: true,\n  get: function get() {\n    return _leaderElectionUtil.beLeader;\n  }\n});\nObject.defineProperty(exports, \"clearNodeFolder\", {\n  enumerable: true,\n  get: function get() {\n    return _broadcastChannel.clearNodeFolder;\n  }\n});\nObject.defineProperty(exports, \"createLeaderElection\", {\n  enumerable: true,\n  get: function get() {\n    return _leaderElection.createLeaderElection;\n  }\n});\nObject.defineProperty(exports, \"enforceOptions\", {\n  enumerable: true,\n  get: function get() {\n    return _broadcastChannel.enforceOptions;\n  }\n});\nvar _broadcastChannel = require(\"./broadcast-channel.js\");\nvar _leaderElection = require(\"./leader-election.js\");\nvar _leaderElectionUtil = require(\"./leader-election-util.js\");","\"use strict\";\n\nvar _index = require(\"./index.js\");\n/**\n * because babel can only export on default-attribute,\n * we use this for the non-module-build\n * this ensures that users do not have to use\n * var BroadcastChannel = require('broadcast-channel').default;\n * but\n * var BroadcastChannel = require('broadcast-channel');\n */\n\nmodule.exports = {\n  BroadcastChannel: _index.BroadcastChannel,\n  createLeaderElection: _index.createLeaderElection,\n  clearNodeFolder: _index.clearNodeFolder,\n  enforceOptions: _index.enforceOptions,\n  beLeader: _index.beLeader\n};","export const NoAccessError =\n  'The OriginStorage does not have any read/write access.';\nexport const NoReadAccessError =\n  'The OriginStorage does not have any read access.';\nexport const NoWriteAccessError =\n  'The OriginStorage does not have any write access.';\nexport const DefaultBroadcastChannelName = 'origin-storage-broadcast-channel';\n","import { IFrameTransport, listen } from 'data-transport';\nimport { BroadcastChannel } from 'broadcast-channel';\nimport localforage from 'localforage';\nimport {\n  DefaultBroadcastChannelName,\n  NoAccessError,\n  NoReadAccessError,\n  NoWriteAccessError,\n} from './constant';\nimport {\n  ClientToStorage,\n  IChangeData,\n  OriginStorageOptions,\n  StorageToClient,\n} from './interface';\n\nexport class OriginStorage\n  extends IFrameTransport.IFrame<{ emit: StorageToClient }>\n  implements ClientToStorage\n{\n  protected _localforage!: ReturnType<typeof localforage.createInstance>;\n  protected _read: boolean;\n  protected _write: boolean;\n  protected _broadcastChanges: boolean;\n  protected _broadcastChannel?: BroadcastChannel;\n\n  constructor({\n    read = true,\n    write = true,\n    broadcastChanges = false,\n    broadcastChannelName = DefaultBroadcastChannelName,\n    ...options\n  }: OriginStorageOptions = {}) {\n    super(options);\n    this._read = read;\n    this._write = write;\n    this._broadcastChanges = broadcastChanges;\n    if (this._broadcastChanges) {\n      this._broadcastChannel = new BroadcastChannel(broadcastChannelName);\n      this._broadcastChannel.onmessage = (message) => {\n        this.emit({ name: 'change', respond: false }, message);\n      };\n    }\n    this.connect();\n  }\n\n  async connect() {\n    if (!this._read && !this._write) {\n      throw new Error(NoAccessError);\n    }\n    const config = await this.emit('getConfig');\n    this._localforage = localforage.createInstance(config);\n    await this.emit('connect');\n  }\n\n  @listen\n  async broadcastChanges() {\n    return { broadcastChanges: this._broadcastChanges };\n  }\n\n  @listen\n  async getItem(options: { key: string }) {\n    if (!this._read) {\n      if (__DEV__) {\n        console.error(NoReadAccessError);\n      }\n      return { error: NoReadAccessError };\n    }\n    try {\n      const value = (await this._localforage.getItem(options.key)) as unknown;\n      return { value };\n    } catch (e: any) {\n      if (typeof e?.toString === 'function') {\n        return { error: e.toString() };\n      }\n      if (__DEV__) {\n        throw e;\n      }\n    }\n  }\n\n  @listen\n  async setItem(options: { key: string; value: unknown }) {\n    if (!this._write) {\n      if (__DEV__) {\n        console.error(NoWriteAccessError);\n      }\n      return { error: NoWriteAccessError };\n    }\n    try {\n      await this._localforage.setItem(options.key, options.value);\n      this._broadcastChannel?.postMessage({\n        key: options.key,\n      } as IChangeData);\n    } catch (e: any) {\n      if (typeof e?.toString === 'function') {\n        return { error: e.toString() };\n      }\n      if (__DEV__) {\n        throw e;\n      }\n    }\n  }\n\n  @listen\n  async removeItem(options: { key: string }) {\n    if (!this._write) {\n      if (__DEV__) {\n        console.error(NoWriteAccessError);\n      }\n      return { error: NoWriteAccessError };\n    }\n    try {\n      await this._localforage.removeItem(options.key);\n      this._broadcastChannel?.postMessage({\n        key: options.key,\n      } as IChangeData);\n    } catch (e: any) {\n      if (typeof e?.toString === 'function') {\n        return { error: e.toString() };\n      }\n      if (__DEV__) {\n        throw e;\n      }\n    }\n  }\n\n  @listen\n  async clear() {\n    if (!this._write) {\n      if (__DEV__) {\n        console.error(NoWriteAccessError);\n      }\n      return { error: NoWriteAccessError };\n    }\n    try {\n      await this._localforage.clear();\n      this._broadcastChannel?.postMessage({\n        key: null,\n      } as IChangeData);\n    } catch (e: any) {\n      if (typeof e?.toString === 'function') {\n        return { error: e.toString() };\n      }\n      if (__DEV__) {\n        throw e;\n      }\n    }\n  }\n\n  @listen\n  async length() {\n    if (!this._read) {\n      if (__DEV__) {\n        console.error(NoReadAccessError);\n      }\n      return { error: NoReadAccessError };\n    }\n    try {\n      const length = await this._localforage.length();\n      return { length };\n    } catch (e: any) {\n      if (typeof e?.toString === 'function') {\n        return { error: e.toString() };\n      }\n      if (__DEV__) {\n        throw e;\n      }\n    }\n  }\n\n  @listen\n  async key(options: { index: number }) {\n    if (!this._read) {\n      if (__DEV__) {\n        console.error(NoReadAccessError);\n      }\n      return { error: NoReadAccessError };\n    }\n    try {\n      const key = await this._localforage.key(options.index);\n      return { key };\n    } catch (e: any) {\n      if (typeof e?.toString === 'function') {\n        return { error: e.toString() };\n      }\n      if (__DEV__) {\n        throw e;\n      }\n    }\n  }\n\n  @listen\n  async keys() {\n    if (!this._read) {\n      if (__DEV__) {\n        console.error(NoReadAccessError);\n      }\n      return { error: NoReadAccessError };\n    }\n    try {\n      const keys = await this._localforage.keys();\n      return { keys };\n    } catch (e: any) {\n      if (typeof e?.toString === 'function') {\n        return { error: e.toString() };\n      }\n      if (__DEV__) {\n        throw e;\n      }\n    }\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJmYWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2ludGVyZmFjZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgSUZyYW1lTWFpblRyYW5zcG9ydE9wdGlvbnMsXG4gIElGcmFtZVRyYW5zcG9ydEludGVybmFsT3B0aW9ucyxcbn0gZnJvbSAnZGF0YS10cmFuc3BvcnQnO1xuaW1wb3J0IGxvY2FsZm9yYWdlIGZyb20gJ2xvY2FsZm9yYWdlJztcblxuZXhwb3J0IHR5cGUgTG9jYWxGb3JhZ2VPcHRpb25zID0gUGFyYW1ldGVyczxcbiAgdHlwZW9mIGxvY2FsZm9yYWdlLmNyZWF0ZUluc3RhbmNlXG4+WzBdO1xuXG5leHBvcnQgaW50ZXJmYWNlIE9yaWdpblN0b3JhZ2VDbGllbnRPcHRpb25zIGV4dGVuZHMgSUZyYW1lTWFpblRyYW5zcG9ydE9wdGlvbnMge1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIFNwZWNpZnkgdGhlIHVyaSBvZiBhbiBPcmlnaW5TdG9yYWdlIGNvbnRhaW5lci5cbiAgICovXG4gIHVyaTogc3RyaW5nO1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIFNldCBzdG9yYWdlIG9wdGlvbnMgZm9yIGxvY2FsZm9yYWdlLlxuICAgKi9cbiAgc3RvcmFnZU9wdGlvbnM/OiBMb2NhbEZvcmFnZU9wdGlvbnM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3JpZ2luU3RvcmFnZU9wdGlvbnMgZXh0ZW5kcyBJRnJhbWVUcmFuc3BvcnRJbnRlcm5hbE9wdGlvbnMge1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIEVuYWJsZSByZWFkIGFjY2VzcyB0byBPcmlnaW5TdG9yYWdlLlxuICAgKi9cbiAgcmVhZD86IGJvb2xlYW47XG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICpcbiAgICogRW5hYmxlIHdyaXRlIGFjY2VzcyB0byBPcmlnaW5TdG9yYWdlLlxuICAgKi9cbiAgd3JpdGU/OiBib29sZWFuO1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqXG4gICAqIEVuYWJsZSBicm9hZGNhc3QgZGF0YSBjaGFuZ2VzIG9uIE9yaWdpblN0b3JhZ2UuXG4gICAqL1xuICBicm9hZGNhc3RDaGFuZ2VzPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKlxuICAgKiBTcGVjaWZ5IGJyb2FkY2FzdENoYW5uZWwgbmFtZS5cbiAgICovXG4gIGJyb2FkY2FzdENoYW5uZWxOYW1lPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElDaGFuZ2VEYXRhIHtcbiAga2V5OiBzdHJpbmcgfCBudWxsO1xuICB2YWx1ZT86IGFueTtcbn1cblxuZXhwb3J0IHR5cGUgU3RvcmFnZVRvQ2xpZW50ID0ge1xuICBjb25uZWN0KCk6IFByb21pc2U8dm9pZD47XG4gIGdldENvbmZpZygpOiBQcm9taXNlPExvY2FsRm9yYWdlT3B0aW9ucz47XG4gIGNoYW5nZShvcHRpb25zOiB7IGtleTogc3RyaW5nIHwgbnVsbCB9KTogUHJvbWlzZTx2b2lkPjtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RvcmFnZUVycm9yIHtcbiAgZXJyb3I6IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgQ2xpZW50VG9TdG9yYWdlID0ge1xuICBicm9hZGNhc3RDaGFuZ2VzKCk6IFByb21pc2U8eyBicm9hZGNhc3RDaGFuZ2VzOiBib29sZWFuIH0+O1xuICBnZXRJdGVtKG9wdGlvbnM6IHtcbiAgICBrZXk6IHN0cmluZztcbiAgfSk6IFByb21pc2U8eyB2YWx1ZTogdW5rbm93biB9IHwgU3RvcmFnZUVycm9yIHwgdm9pZD47XG4gIHNldEl0ZW0ob3B0aW9uczoge1xuICAgIGtleTogc3RyaW5nO1xuICAgIHZhbHVlOiB1bmtub3duO1xuICB9KTogUHJvbWlzZTxTdG9yYWdlRXJyb3IgfCB2b2lkPjtcbiAgcmVtb3ZlSXRlbShvcHRpb25zOiB7IGtleTogc3RyaW5nIH0pOiBQcm9taXNlPFN0b3JhZ2VFcnJvciB8IHZvaWQ+O1xuICBjbGVhcigpOiBQcm9taXNlPFN0b3JhZ2VFcnJvciB8IHZvaWQ+O1xuICBsZW5ndGgoKTogUHJvbWlzZTx7IGxlbmd0aDogbnVtYmVyIH0gfCBTdG9yYWdlRXJyb3IgfCB2b2lkPjtcbiAga2V5KG9wdGlvbnM6IHtcbiAgICBpbmRleDogbnVtYmVyO1xuICB9KTogUHJvbWlzZTx7IGtleTogc3RyaW5nIH0gfCBTdG9yYWdlRXJyb3IgfCB2b2lkPjtcbiAga2V5cygpOiBQcm9taXNlPHsga2V5czogc3RyaW5nW10gfSB8IFN0b3JhZ2VFcnJvciB8IHZvaWQ+O1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBJT3JpZ2luU3RvcmFnZUNsaWVudCB7XG4gIGdldEl0ZW0oa2V5OiBzdHJpbmcpOiBQcm9taXNlPGFueT47XG4gIHNldEl0ZW0oa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnkpOiBQcm9taXNlPHZvaWQ+O1xuICByZW1vdmVJdGVtKGtleTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPjtcbiAgY2xlYXIoKTogUHJvbWlzZTx2b2lkPjtcbiAgbGVuZ3RoKCk6IFByb21pc2U8bnVtYmVyPjtcbiAga2V5KGluZGV4OiBudW1iZXIpOiBQcm9taXNlPHN0cmluZz47XG4gIGtleXMoKTogUHJvbWlzZTxzdHJpbmdbXT47XG59XG4iXX0=","import Localforage from 'localforage';\n\nexport const localforage = Localforage;\nexport * from './src/originStorageClient';\nexport * from './src/originStorage';\nexport * from './src/interface';\n\n","import { OriginStorageClient } from '@agentlink/core';\nimport type { IOriginStorageClient, IChangeData } from '@agentlink/core';\n\nexport interface AgentLinkClientOptions {\n  /**\n   *  URL\n   * : 'https://storage.example.com/storage'\n   */\n  serverUrl: string;\n  /**\n   * localforage \n   */\n  storageOptions?: Parameters<typeof import('localforage').createInstance>[0];\n}\n\nexport interface WhitelistInfo {\n  domain: string;\n  description?: string | null;\n}\n\nexport interface WhitelistResponse {\n  whitelist: WhitelistInfo | WhitelistInfo[] | null;\n  origin: string | null;\n}\n\n/**\n * AgentLink  SDK\n * \n */\nexport class AgentLinkClient implements IOriginStorageClient {\n  private client: OriginStorageClient;\n  private serverUrl: string;\n\n  constructor(options: AgentLinkClientOptions) {\n    this.serverUrl = options.serverUrl;\n    \n    //  URL  /storage \n    const storageUrl = options.serverUrl.endsWith('/storage')\n      ? options.serverUrl\n      : `${options.serverUrl.replace(/\\/$/, '')}/storage`;\n\n    this.client = new OriginStorageClient({\n      uri: storageUrl,\n      storageOptions: options.storageOptions,\n    });\n  }\n\n  /**\n   * \n   */\n  onConnect(callback: () => void): () => void {\n    return this.client.onConnect(callback);\n  }\n\n  /**\n   * \n   */\n  async onChange(callback: (data: IChangeData) => void): Promise<{ off: () => void; broadcastChanges: boolean }> {\n    return this.client.onChange(callback);\n  }\n\n  /**\n   *  key \n   */\n  async getItem(key: string): Promise<any> {\n    return this.client.getItem(key);\n  }\n\n  /**\n   *  key \n   */\n  async setItem(key: string, value: any): Promise<void> {\n    return this.client.setItem(key, value);\n  }\n\n  /**\n   *  key\n   */\n  async removeItem(key: string): Promise<void> {\n    return this.client.removeItem(key);\n  }\n\n  /**\n   * \n   */\n  async clear(): Promise<void> {\n    return this.client.clear();\n  }\n\n  /**\n   * \n   */\n  async length(): Promise<number> {\n    return this.client.length();\n  }\n\n  /**\n   *  key \n   */\n  async key(index: number): Promise<string> {\n    return this.client.key(index);\n  }\n\n  /**\n   *  key \n   */\n  async keys(): Promise<string[]> {\n    return this.client.keys();\n  }\n\n  /**\n   * \n   * @param includeAll truefalse\n   */\n  async getWhitelistInfo(includeAll: boolean = false): Promise<WhitelistResponse> {\n    const baseUrl = this.serverUrl.replace('/storage', '');\n    const url = `${baseUrl}/api/whitelist/info${includeAll ? '?includeAll=true' : ''}`;\n\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Origin': typeof window !== 'undefined' ? window.location.origin : '',\n      },\n    });\n\n    if (!response.ok) {\n      if (response.status === 403) {\n        const data = await response.json();\n        throw new Error(data.error || '');\n      }\n      throw new Error(`: ${response.statusText}`);\n    }\n\n    return await response.json();\n  }\n}\n\n","export * from './client';\n//  OriginStorage storage-client.js \nexport { OriginStorage } from '@agentlink/core';\n\n"],"mappings":"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","names":["v","d","b","__assign","o","define","module","exports","o","e","n","global","Promise","self","i","key","length","idb","forage","value","err","keys","db","t","error","resolve","reject","sameValue","includes","LocalForage","configureMissingMethods","methodNotImplementedFactory","promise","setDriverSupport","supportedDrivers","listenerKey","Symbol","listenKey","senderKey","requestsMapKey","listensMapKey","serializerKey","logKey","verboseKey","originalListensMapKey","callbackKey","timeoutKey","prefixKey","produceKey","beforeEmitKey","beforeEmitResolveKey","transportKey","transportType","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","f","y","_","label","sent","trys","ops","g","Iterator","verb","iterator","v","op","pop","push","__values","o","m","__read","r","ar","error","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","Error","byteToHex","toString","slice","native","randomUUID","v4","options","buf","offset","rnds","random","arr","toLowerCase","detectSafari","test","navigator","userAgent","generateId","uuid","randomNumbers","Math","getAction","prefix","name","concat","Transport","_b","listener","sender","_c","timeout","_d","verbose","_e","_f","listenKeys","S","checkListen","T","M","serializer","logger","_this","_a","Map","id","_h","_j","Set","forEach","key","fn","set","console","info","listenName","action","replace","RegExp","type","get","response","parse","respond","request","transportId","hasRespond","dispose","clear","c","l","u","args","a","data","stringify","responseId","listen","delete","emit","_i","params","isSilent","silent","rawRequestData","_extra","_g","requestId","skipBeforeEmit","undefined","promise","race","timeoutId","setTimeout","clearTimeout","catch","warn","connectEventName","IFrameMainTransport","_super","_options","iframe","document","querySelector","targetOrigin","callback","handler","source","contentWindow","window","addEventListener","removeEventListener","message","postMessage","frames","skipConnectionCheck","connect_1","connected","IFrameInternalTransport","parent","IFrameTransport","Main","IFrame","WorkerMainTransport","worker","transfer","_connected","_handleConnectCallbacks","_onConnectCallback","onConnect","add","WorkerInternalTransport","self","WorkerTransport","Worker","disconnectEventName","SharedWorkerClientTransport","port","start","_handleConnect","SharedWorkerInternalTransport","ports","_handler","close","_port","has","tempPorts","_onDisconnectCallback","disconnectAction","connectEvent","err_1","onDisconnect","SharedWorkerTransport","Client","DEFAULT_USE_ON_SAFARI","ServiceWorkerClientTransport","useOnSafari","JSON","serviceWorker","ServiceWorkerServiceTransport","_clientId","clients","client_1","client","_client","matchAll","all","map","event","waitUntil","claim","ServiceWorkerTransport","Service","BroadcastTransport","channel","broadcastChannel","BroadcastChannel","defaultChannel","ElectronMainTransport","ipcMain","browserWindow","on","off","webContents","send","ElectronRendererTransport","ipcRenderer","ElectronTransport","Renderer","global","transportName","BrowserExtensionsGenericTransport","browser","chrome","sendResponse","_sendResponse","runtime","onMessage","addListener","removeListener","sendMessage","BrowserExtensionsMainTransport","disconnect","handler_1","id_1","BrowserExtensionsClientTransport","connect","BrowserExtensionsTransport","MAX_CHUNK_SIZE","WebRTCTransport","peer","buffer","receiveBuffer","__DATA_TRANSPORT_UUID__","timestamp","Date","now","chunkId","isComplete","filter","item","data_1","join","allChunksSize","ceil","webRTCPaused_1","webRTCMessageQueue_1","peerSend_1","sendMessageQueued_1","shift","_channel","bufferedAmount","unshift","listener_1","chunk","MessageTransport","MainProcessTransport","child","ChildProcessTransport","process","ProcessTransport","Child","TransportMap","Base","IFrameMain","IFrameInternal","BrowserExtensions","BrowserExtensionsMain","BrowserExtensionsClient","ElectronMain","ElectronRenderer","ServiceWorkerClient","ServiceWorkerService","WebWorkerClient","WebWorkerInternal","WebRTC","Broadcast","SharedWorkerClient","SharedWorkerInternal","MainProcess","ChildProcess","createTransport","target","descriptor","first","seconds","_args","to","from","pack","disposers","transport","emitter","mainCallback","main","emitter_1","emitter_1_1","OriginStorageClient","o","postMessage","ObliviousSet","postMessage","postMessage","localStorage","listener","postMessage","BroadcastChannel","postMessage","obj","listenerFn","es_exports","init_es","isLeaderListener","LeaderElectionWebLock","LeaderElection","hasLeaderListener","applyRun","stopCriteriaPromiseResolve","handleMessage","tryOnFallBack","whenDeathListener","OriginStorage","import_core"]}